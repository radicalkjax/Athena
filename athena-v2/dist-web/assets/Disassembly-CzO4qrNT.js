import{c as p,o as ye,u as Se,t as c,i as e,m as Y,a as f,S as le,F as R,b as W,s as O,l as pe,d as _e,q as Ce,e as $e}from"./vendor-solid-ZF9XUUOY.js";import{i as xe,S as be,A as we}from"./index-C4Q2lgHl.js";var ke=c("<div class=disassembly-viewer>"),Fe=c("<div style=color:var(--warning-color);margin-top:15px;max-width:600px>Disassembly is taking longer than expected. This is normal for large binaries (>10MB) or complex executables with many functions."),Pe=c('<div class=loading><div class=spinner style="margin:0 auto 20px"></div><div>'),Ae=c('<div class=error-message><button style="margin-top:15px;padding:10px 20px;background:var(--barbie-pink);color:white;border:none;border-radius:4px;cursor:pointer">Retry'),Le=c("<div class=functions-panel><h4>Functions (<!>)</h4><div class=function-list>"),Me=c("<div class=strings-panel><h4>Strings (<!>)</h4><div class=string-list>"),Te=c('<div class=disassembly-content><div class=disassembly-header><div class=file-info><h3>Disassembly View</h3><div class=architecture>Architecture: </div></div><div class=search-bar><input type=text placeholder="Search instructions..."></div><div class=view-toggles><label><input type=checkbox>Functions</label><label><input type=checkbox>Strings</label></div></div><div class=disassembly-layout><div class=sidebar></div><div class=instructions-panel><div class=instructions-header><span class=col-address>Address</span><span class=col-bytes>Bytes</span><span class=col-mnemonic>Instruction</span><span class=col-operands>Operands</span><span class=col-comments>Comments</span></div><div class=instructions-list></div></div><div class=sections-panel><h4>Sections</h4><div class=sections-list>'),Ee=c("<div class=entry-point>Entry Point: <button class=jump-btn>Jump"),Ie=c("<div class=function-item><div class=function-name></div><div class=function-details><span></span><span> instructions"),ze=c("<div class=string-item><div class=string-address></div><div class=string-value>"),Be=c("<div class=instruction-row><span class=col-address></span><span class=col-bytes></span><span class=col-mnemonic></span><span class=col-operands></span><span class=col-comments>"),je=c("<button class=inline-jump-btn>â†’"),De=c("<div class=section-item><div class=section-name></div><div class=section-info><span></span><span>Size: 0x</span></div><div class=section-flags>Flags: ");function Ge(D){const[d,q]=p(null),[Q,ee]=p(null),[re,K]=p(!1),[te,A]=p(""),[G,se]=p(""),[ne,J]=p(!0),[U,ae]=p(!0),[oe,de]=p(new Map),[ce,u]=p(!1),[S,_]=p("Initializing disassembler..."),y=async()=>{if(!D.filePath){A("No file path provided. Please select a file to disassemble.");return}K(!0),A(""),u(!1),_("Initializing disassembler...");const t=setTimeout(()=>{u(!0),_("Still disassembling... Large binaries may take several minutes.")},6e4);try{_("Reading binary file...");const s=await xe("disassemble_file",{filePath:D.filePath});if(clearTimeout(t),_("Processing instructions..."),!s.instructions||s.instructions.length===0){A("No instructions found. The file may not be a valid executable or may be packed/obfuscated.");return}q(s),_("Building address map...");const n=new Map;if(s.instructions.forEach((a,r)=>{n.set(a.address,r)}),de(n),s.functions.length>0){const a=s.functions[0];a&&ee(a)}}catch(s){clearTimeout(t);const n=s instanceof Error?s.message:"Unknown error";A(`Failed to disassemble file: ${n}

Possible causes:
- File is not a valid executable
- File is corrupted or encrypted
- Unsupported binary format
- Insufficient memory for large binary`)}finally{K(!1),u(!1)}};ye(()=>{y()});const C=t=>`0x${t.toString(16).padStart(8,"0")}`,o=t=>t.is_call?"#ff6b9d":t.is_jump?"#c77dff":t.mnemonic==="ret"||t.mnemonic==="retn"?"#7209b7":t.mnemonic.startsWith("push")||t.mnemonic.startsWith("pop")?"#f72585":t.mnemonic.startsWith("mov")?"#4cc9f0":"#e0e0e0",b=Se(()=>{const t=d();if(!t)return[];const s=G().toLowerCase();return s?t.instructions.filter(n=>n.mnemonic.toLowerCase().includes(s)||n.operands.toLowerCase().includes(s)||C(n.address).includes(s)):t.instructions}),v=t=>{const n=oe().get(t);if(n!==void 0){const a=document.getElementById(`inst-${n}`);a==null||a.scrollIntoView({behavior:"smooth",block:"center"}),a==null||a.classList.add("highlight"),setTimeout(()=>a==null?void 0:a.classList.remove("highlight"),2e3)}},h=t=>{ee(t),v(t.address)};return(()=>{var t=ke();return e(t,(()=>{var s=Y(()=>!!re());return()=>s()&&(()=>{var n=Pe(),a=n.firstChild,r=a.nextSibling;return e(r,S),e(n,f(le,{get when(){return ce()},get children(){return Fe()}}),null),n})()})(),null),e(t,(()=>{var s=Y(()=>!!te());return()=>s()&&(()=>{var n=Ae(),a=n.firstChild;return e(n,te,a),a.$$click=()=>{A(""),y()},n})()})(),null),e(t,(()=>{var s=Y(()=>!!d());return()=>s()&&(()=>{var n=Te(),a=n.firstChild,r=a.firstChild,L=r.firstChild,V=L.nextSibling;V.firstChild;var M=r.nextSibling,g=M.firstChild,x=M.nextSibling,w=x.firstChild,z=w.firstChild,B=w.nextSibling,H=B.firstChild,ue=a.nextSibling,m=ue.firstChild,l=m.nextSibling,j=l.firstChild,k=j.nextSibling,X=l.nextSibling,he=X.firstChild,fe=he.nextSibling;return e(V,()=>d().architecture,null),e(r,(()=>{var i=Y(()=>d().entry_point!==null);return()=>i()&&(()=>{var $=Ee(),T=$.firstChild,E=T.nextSibling;return e($,()=>C(d().entry_point),E),E.$$click=()=>{const N=d().entry_point;N!==null&&v(N)},$})()})(),null),g.$$input=i=>se(i.currentTarget.value),z.addEventListener("change",i=>ae(i.currentTarget.checked)),H.addEventListener("change",i=>J(i.currentTarget.checked)),e(m,f(le,{get when(){return U()},get children(){var i=Le(),$=i.firstChild,T=$.firstChild,E=T.nextSibling;E.nextSibling;var N=$.nextSibling;return e($,()=>d().functions.length,E),e(N,f(R,{get each(){return d().functions},children:F=>(()=>{var I=Ie(),ie=I.firstChild,P=ie.nextSibling,Z=P.firstChild,ge=Z.nextSibling,me=ge.firstChild;return I.$$click=()=>h(F),e(ie,()=>F.name),e(Z,()=>C(F.address)),e(ge,()=>F.instructions_count,me),W(()=>{var ve;return I.classList.toggle("selected",((ve=Q())==null?void 0:ve.address)===F.address)}),I})()})),i}}),null),e(m,f(le,{get when(){return ne()},get children(){var i=Me(),$=i.firstChild,T=$.firstChild,E=T.nextSibling;E.nextSibling;var N=$.nextSibling;return e($,()=>d().strings.length,E),e(N,f(R,{get each(){return d().strings.slice(0,100)},children:F=>(()=>{var I=ze(),ie=I.firstChild,P=ie.nextSibling;return e(ie,()=>C(F.address)),e(P,()=>F.value),I})()})),i}}),null),e(k,f(R,{get each(){return b()},children:(i,$)=>(()=>{var T=Be(),E=T.firstChild,N=E.nextSibling,F=N.nextSibling,I=F.nextSibling,ie=I.nextSibling;return e(E,()=>C(i.address)),e(N,()=>i.bytes),e(F,()=>i.mnemonic),e(I,()=>i.operands,null),e(I,(()=>{var P=Y(()=>!!i.jump_target);return()=>P()&&(()=>{var Z=je();return Z.$$click=()=>v(i.jump_target),W(()=>O(Z,"title",`Jump to ${C(i.jump_target)}`)),Z})()})(),null),e(ie,()=>i.is_call&&"Function call",null),e(ie,()=>i.is_jump&&!i.is_call&&"Jump",null),W(P=>{var Z=`inst-${$()}`,ge=!!i.is_jump,me=!!i.is_call,ve=o(i);return Z!==P.e&&O(T,"id",P.e=Z),ge!==P.t&&T.classList.toggle("is-jump",P.t=ge),me!==P.a&&T.classList.toggle("is-call",P.a=me),ve!==P.o&&pe(F,"color",P.o=ve),P},{e:void 0,t:void 0,a:void 0,o:void 0}),T})()})),e(fe,f(R,{get each(){return d().sections},children:i=>(()=>{var $=De(),T=$.firstChild,E=T.nextSibling,N=E.firstChild,F=N.nextSibling;F.firstChild;var I=E.nextSibling;return I.firstChild,e(T,()=>i.name),e(N,()=>C(i.address)),e(F,()=>i.size.toString(16),null),e(I,()=>i.flags,null),$})()})),W(()=>g.value=G()),W(()=>z.checked=U()),W(()=>H.checked=ne()),n})()})(),null),t})()}_e(["click","input"]);var Ne=c("<div class=cfg-viewer>"),Oe=c("<div class=loading>Generating control flow graph..."),We=c("<div class=error-message>"),He=c("<div class=block-details><h4>Block Details: </h4><div class=block-info><div>Instructions: </div><div>Predecessors: </div><div>Successors: </div></div><div class=block-instructions>"),Xe=c('<div class=cfg-content><div class=cfg-controls><button>Reset Zoom</button><span>Zoom: <!>%</span><button>+</button><button>-</button></div><svg class=cfg-canvas width=100% height=100%><g></g><defs><marker id=arrowhead markerWidth=10 markerHeight=7 refX=10 refY=3.5 orient=auto><polygon points="0 0, 10 3.5, 0 7"fill=#c77dff>'),Ke=c("<svg><path fill=none stroke-width=2 marker-end=url(#arrowhead) class=cfg-edge></svg>",!1,!0,!1),Ve=c('<svg><g class=cfg-block><rect fill=#2a2a2a stroke-width=2 rx=4></rect><text y=20 text-anchor=middle fill=#ff6b9d font-weight=bold></text><text y=35 text-anchor=middle fill=#888 font-size=12> - </text><g transform="translate(10, 50)"></svg>',!1,!0,!1),Ye=c("<svg><text fill=#e0e0e0 font-family=monospace font-size=12> </svg>",!1,!0,!1),Re=c("<svg><text y=100 fill=#888 font-size=12>... +<!> more</svg>",!1,!0,!1),Je=c("<div class=cfg-instruction><span class=addr></span><span class=mnemonic></span><span class=operands>");function Ue(D){const[d,q]=p(null),[Q,ee]=p(!1),[re,K]=p(""),[te,A]=p(new Map),[G,se]=p(null),[ne,J]=p(1),U=300,ae=100,oe=100,de=80,ce=20,u=async()=>{if(!(!D.filePath||!D.functionAddress)){ee(!0),K("");try{const o=await xe("get_control_flow_graph",{filePath:D.filePath,functionAddress:D.functionAddress});q(o),S(o)}catch(o){K(`Failed to generate CFG: ${o}`)}finally{ee(!1)}}},S=o=>{const b=new Map,v=new Set,h=new Map,t=[[o.entry_block,0]];let s=0;for(;t.length>0;){const[r,L]=t.shift();if(v.has(r))continue;v.add(r),h.set(r,L),s=Math.max(s,L);const V=o.blocks.find(M=>M.id===r);if(V)for(const M of V.successors)v.has(M)||t.push([M,L+1])}const n=new Map;for(let r=0;r<=s;r++)n.set(r,0);h.forEach(r=>{n.set(r,(n.get(r)||0)+1)});const a=new Map;for(let r=0;r<=s;r++)a.set(r,0);o.blocks.forEach(r=>{const L=h.get(r.id)||0,V=a.get(L)||0,M=n.get(L)||1,g=Math.max(ae,40+r.instructions.length*ce),w=-(M*U+(M-1)*oe)/2;b.set(r.id,{x:w+V*(U+oe)+U/2,y:L*(ae+de),width:U,height:g}),a.set(L,V+1)}),A(b)};Ce(()=>{u()});const _=o=>`0x${o.toString(16).padStart(8,"0")}`,y=(o,b)=>{const v=te(),h=v.get(o),t=v.get(b);if(!h||!t)return"";const s=h.x,n=h.y+h.height,a=t.x,r=t.y,L=(n+r)/2;return`M ${s} ${n} Q ${s} ${L}, ${a} ${r}`},C=o=>{o.preventDefault();const b=o.deltaY>0?.9:1.1;J(v=>Math.max(.1,Math.min(3,v*b)))};return(()=>{var o=Ne();return o.addEventListener("wheel",C),e(o,(()=>{var b=Y(()=>!!Q());return()=>b()&&Oe()})(),null),e(o,(()=>{var b=Y(()=>!!re());return()=>b()&&(()=>{var v=We();return e(v,re),v})()})(),null),e(o,(()=>{var b=Y(()=>!!d());return()=>b()&&(()=>{var v=Xe(),h=v.firstChild,t=h.firstChild,s=t.nextSibling,n=s.firstChild,a=n.nextSibling;a.nextSibling;var r=s.nextSibling,L=r.nextSibling,V=h.nextSibling,M=V.firstChild;return t.$$click=()=>J(1),e(s,()=>(ne()*100).toFixed(0),a),r.$$click=()=>J(g=>Math.min(3,g*1.1)),L.$$click=()=>J(g=>Math.max(.1,g*.9)),e(M,f(R,{get each(){return d().blocks},children:g=>f(R,{get each(){return g.successors},children:x=>{const w=te(),z=w.get(x).y<=w.get(g.id).y;return(()=>{var B=Ke();return O(B,"stroke",z?"#ff6b9d":"#c77dff"),W(()=>O(B,"d",y(g.id,x))),B})()}})}),null),e(M,f(R,{get each(){return d().blocks},children:g=>{const x=te().get(g.id);return x?(()=>{var w=Ve(),z=w.firstChild,B=z.nextSibling,H=B.nextSibling,ue=H.firstChild,m=H.nextSibling;return w.$$click=()=>se(g.id),e(B,()=>g.id),e(H,()=>_(g.start_address),ue),e(H,()=>_(g.end_address),null),e(m,f(R,{get each(){return g.instructions.slice(0,5)},children:(l,j)=>(()=>{var k=Ye(),X=k.firstChild;return e(k,()=>l.mnemonic,X),e(k,()=>l.operands,null),W(()=>O(k,"y",j()*ce)),k})()}),null),e(m,(()=>{var l=Y(()=>g.instructions.length>5);return()=>l()&&(()=>{var j=Re(),k=j.firstChild,X=k.nextSibling;return X.nextSibling,e(j,()=>g.instructions.length-5,X),j})()})(),null),W(l=>{var j=`translate(${x.x-x.width/2}, ${x.y})`,k=G()===g.id,X=x.width,he=x.height,fe=g.id===d().entry_block?"#ff6b9d":"#444",i=x.width/2,$=x.width/2;return j!==l.e&&O(w,"transform",l.e=j),k!==l.t&&w.classList.toggle("selected",l.t=k),X!==l.a&&O(z,"width",l.a=X),he!==l.o&&O(z,"height",l.o=he),fe!==l.i&&O(z,"stroke",l.i=fe),i!==l.n&&O(B,"x",l.n=i),$!==l.s&&O(H,"x",l.s=$),l},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),w})():null}}),null),e(v,f(le,{get when(){return G()},get children(){var g=He(),x=g.firstChild;x.firstChild;var w=x.nextSibling,z=w.firstChild;z.firstChild;var B=z.nextSibling;B.firstChild;var H=B.nextSibling;H.firstChild;var ue=w.nextSibling;return e(x,G,null),e(z,()=>{var m;return(m=d().blocks.find(l=>l.id===G()))==null?void 0:m.instructions.length},null),e(B,()=>{var m;return((m=d().blocks.find(l=>l.id===G()))==null?void 0:m.predecessors.join(", "))||"None"},null),e(H,()=>{var m;return((m=d().blocks.find(l=>l.id===G()))==null?void 0:m.successors.join(", "))||"None"},null),e(ue,f(R,{get each(){var m;return(m=d().blocks.find(l=>l.id===G()))==null?void 0:m.instructions},children:m=>(()=>{var l=Je(),j=l.firstChild,k=j.nextSibling,X=k.nextSibling;return e(j,()=>_(m.address)),e(k,()=>m.mnemonic),e(X,()=>m.operands),l})()})),g}}),null),W(()=>O(M,"transform",`scale(${ne()}) translate(400, 50)`)),v})()})(),null),o})()}_e(["click"]);var Ze=c('<div style="text-align:center;padding:60px 20px;background:var(--panel-bg);border-radius:12px;border:2px dotted var(--barbie-pink)"><div style=font-size:3rem;margin-bottom:20px>ğŸ”</div><p style=font-size:1.2rem;margin-bottom:10px>No file selected for analysis</p><p style=color:var(--text-secondary)>Upload a binary file to begin disassembly'),qe=c("<div style=background:var(--bg-secondary);border-radius:8px;padding:15px;min-height:500px>"),Qe=c('<div><div style="background:rgba(255, 182, 193, 0.1);padding:10px;border-radius:8px;margin-bottom:15px"><p style=margin:0>Control Flow Graph for function at <code style=color:var(--barbie-pink)></code></p></div><div style=background:var(--bg-secondary);border-radius:8px;padding:15px;min-height:450px>'),et=c(`<div class=analysis-grid><div class=analysis-main></div><div class=ensemble-results><h3 style=color:var(--barbie-pink);margin-bottom:15px>ğŸ¯ Function Analysis</h3><div style=background:var(--panel-bg);padding:15px;border-radius:8px;margin-bottom:20px><h4 style=margin-bottom:10px>ğŸ“¦ Key Functions</h4><div style="font-family:'JetBrains Mono', monospace;font-size:0.85rem"></div></div><div class=artifacts-grid><button class="btn btn-primary">ğŸ” Find Cryptor</button><button class="btn btn-primary">ğŸ›¡ï¸ Anti-Debug</button><button class="btn btn-secondary">ğŸ“Š Strings</button><button class="btn btn-secondary">ğŸ“ Export ASM`),tt=c('<div class=content-panel><h2 style=color:var(--barbie-pink);margin-bottom:20px>ğŸ”¬ Binary Disassembly & Analysis</h2><div style="display:grid;grid-template-columns:repeat(4, 1fr);gap:15px;margin-bottom:30px">'),st=c("<div class=view-toggle><button>ğŸ“‹ Disassembly</button><button>ğŸŒ CFG"),nt=c('<div style="padding:10px;margin-bottom:8px;background:var(--bg-secondary);border-radius:6px;cursor:pointer;transition:all 0.2s"><div style=display:flex;justify-content:space-between;margin-bottom:5px><span style=color:var(--barbie-pink);font-weight:600></span><span style=color:var(--text-secondary)></span></div><div style=display:flex;justify-content:space-between;font-size:0.8rem><span></span><span style=border-radius:4px>');function rt(D){const[d,q]=p("disassembly"),[Q,ee]=p(null),re=A=>{ee(A),q("cfg")},[K]=p({functions:"147",instructions:"12.4K",imports:"89",strings:"234"}),[te]=p([{name:"main",address:"0x401000",size:"0x324",type:"entry"},{name:"decrypt_payload",address:"0x401324",size:"0x156",type:"suspicious"},{name:"check_debugger",address:"0x40147A",size:"0x87",type:"anti-debug"},{name:"network_connect",address:"0x401501",size:"0x1A2",type:"network"}]);return(()=>{var A=tt(),G=A.firstChild,se=G.nextSibling;return e(se,f(be,{label:"Functions",get value(){return K().functions}}),null),e(se,f(be,{label:"Instructions",get value(){return K().instructions}}),null),e(se,f(be,{label:"Imports",get value(){return K().imports}}),null),e(se,f(be,{label:"Strings",get value(){return K().strings}}),null),e(A,f(le,{get when(){return!D.filePath},get children(){return Ze()}}),null),e(A,f(le,{get when(){return D.filePath},get children(){var ne=et(),J=ne.firstChild,U=J.nextSibling,ae=U.firstChild,oe=ae.nextSibling,de=oe.firstChild,ce=de.nextSibling;return e(J,f(we,{get title(){return d()==="disassembly"?"Assembly View":"Control Flow Graph"},get icon(){return d()==="disassembly"?"ğŸ“‹":"ğŸŒ"},get actions(){return(()=>{var u=st(),S=u.firstChild,_=S.nextSibling;return S.$$click=()=>q("disassembly"),_.$$click=()=>q("cfg"),W(y=>{var C=`view-btn ${d()==="disassembly"?"active":""}`,o=`view-btn ${d()==="cfg"?"active":""}`,b=!Q();return C!==y.e&&$e(S,y.e=C),o!==y.t&&$e(_,y.t=o),b!==y.a&&(_.disabled=y.a=b),y},{e:void 0,t:void 0,a:void 0}),u})()},get children(){return[f(le,{get when(){return d()==="disassembly"},get children(){var u=qe();return e(u,f(Ge,{get filePath(){return D.filePath},onAddressClick:re})),u}}),f(le,{get when(){return Y(()=>d()==="cfg")()&&Q()},get children(){var u=Qe(),S=u.firstChild,_=S.firstChild,y=_.firstChild,C=y.nextSibling,o=S.nextSibling;return e(C,()=>`0x${Q().toString(16)}`),e(o,f(Ue,{get filePath(){return D.filePath},get functionAddress(){return Q()}})),u}})]}})),e(ce,f(R,{get each(){return te()},children:u=>(()=>{var S=nt(),_=S.firstChild,y=_.firstChild,C=y.nextSibling,o=_.nextSibling,b=o.firstChild,v=b.nextSibling;return S.addEventListener("mouseleave",h=>h.currentTarget.style.transform="translateX(0)"),S.addEventListener("mouseenter",h=>h.currentTarget.style.transform="translateX(5px)"),S.$$click=()=>{ee(parseInt(u.address,16)),q("cfg")},e(y,()=>u.name),e(C,()=>u.size),e(b,()=>u.address),pe(v,"padding","2px 8px"),e(v,()=>u.type),W(h=>{var t=`tag tag-${u.type}`,s=u.type==="suspicious"?"rgba(255, 107, 107, 0.2)":u.type==="anti-debug"?"rgba(255, 221, 61, 0.2)":u.type==="network"?"rgba(78, 205, 196, 0.2)":"rgba(167, 139, 250, 0.2)",n=u.type==="suspicious"?"var(--danger-color)":u.type==="anti-debug"?"var(--warning-color)":u.type==="network"?"var(--success-color)":"var(--accent-color)";return t!==h.e&&$e(v,h.e=t),s!==h.t&&pe(v,"background",h.t=s),n!==h.a&&pe(v,"color",h.a=n),h},{e:void 0,t:void 0,a:void 0}),S})()})),ne}}),null),A})()}_e(["click"]);export{rt as default};
