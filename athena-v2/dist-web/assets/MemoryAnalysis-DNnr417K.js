import{c as _,o as me,q as ve,t as o,i as t,a as r,b as G,e as L,S as $,m as S,F as C,l as Z,d as fe}from"./vendor-solid-ZF9XUUOY.js";import{a as J,A as Q,S as k,i as N}from"./index-C4Q2lgHl.js";var he=o("<div class=view-tabs style=display:flex;gap:10px;margin-bottom:15px><button style=font-size:0.9rem>ğŸ”„ Processes</button><button style=font-size:0.9rem>ğŸ“ Strings</button><button style=font-size:0.9rem>ğŸ—ºï¸ Regions</button><button style=font-size:0.9rem>ğŸ¯ Artifacts"),xe=o('<div style=text-align:center;padding:20px;color:var(--text-secondary)><p>No memory dump loaded</p><button class="btn btn-primary"style=margin-top:15px>Start Memory Analysis'),$e=o("<div style=text-align:center;padding:20px><div class=spinner></div><p style=color:var(--text-secondary);margin-top:15px>Analyzing memory dump..."),_e=o("<div class=code-editor><div class=code-content><strong style=color:var(--barbie-pink)>PROCESS MEMORY MAP</strong><br><br>"),Se=o("<div class=code-editor><div class=code-content><strong style=color:var(--barbie-pink)>EXTRACTED STRINGS</strong><br><br>"),we=o('<div class=code-editor><div class=code-content><strong style=color:var(--barbie-pink)>MEMORY REGIONS</strong><br><br><div style="display:grid;grid-template-columns:auto auto auto auto auto;gap:10px;font-size:0.85rem"><strong style=color:var(--info-color)>Address</strong><strong style=color:var(--info-color)>Size</strong><strong style=color:var(--info-color)>Protection</strong><strong style=color:var(--info-color)>Type</strong><strong style=color:var(--info-color)>Entropy'),Ce=o("<div class=code-editor><div class=code-content><strong style=color:var(--barbie-pink)>EXTRACTED ARTIFACTS</strong><br><br><strong style=color:var(--warning-color)>ğŸŒ Network Indicators:</strong><br><br><strong style=color:var(--warning-color)>ğŸ” System Artifacts:</strong><br><br><strong style=color:var(--warning-color)>ğŸ“ File System:</strong><br>"),ke=o("<div class=code-editor><div class=code-content><strong style=color:var(--barbie-pink)>SUSPICIOUS STRINGS FOUND</strong><br><br><strong style=color:var(--danger-color)>ğŸŒ Network Indicators:</strong><br><span style=color:var(--warning-color)>â€¢ http://malicious-c2.com/beacon</span><br><span style=color:var(--warning-color)>â€¢ https://evil-payload.net/download</span><br><span style=color:var(--warning-color)>â€¢ ftp://anonymous@badserver.com</span><br><br><strong style=color:var(--danger-color)>ğŸ”‘ Encryption Keys:</strong><br><span style=color:var(--info-color)>â€¢ AES Key: 4d794b657948657265</span><br><span style=color:var(--info-color)>â€¢ RC4 Key: 53656372657450617373</span><br><br><strong style=color:var(--danger-color)>ğŸ“‚ File Paths:</strong><br><span style=color:var(--success-color)>â€¢ C:\\\\Windows\\\\Temp\\\\payload.exe</span><br><span style=color:var(--success-color)>â€¢ C:\\\\Users\\\\Public\\\\malware.dll</span><br><span style=color:var(--success-color)>â€¢ %APPDATA%\\\\svchost.exe</span><br><br><strong style=color:var(--danger-color)>âš¡ Commands:</strong><br><span style=color:var(--text-secondary)>â€¢ cmd.exe /c powershell -enc</span><br><span style=color:var(--text-secondary)>â€¢ rundll32.exe shell32.dll</span><br><span style=color:var(--text-secondary)>â€¢ reg add HKLM\\\\Software\\\\"),Ae=o('<h3 style="color:var(--barbie-pink);margin:15px 0">ğŸ§  Analysis Statistics'),Me=o("<div class=stats-overview>"),Ie=o('<div class=content-panel><h2 style=color:var(--barbie-pink);margin-bottom:20px>ğŸ§  Memory Analysis - Deep Forensics</h2><div class=analysis-grid><div class=analysis-main></div><div class=ensemble-results><h3 style=color:var(--barbie-pink);margin-bottom:15px>ğŸ“Š System Statistics</h3><div class=stats-overview></div><h3 style=color:var(--barbie-pink);margin-bottom:15px>ğŸ› ï¸ Memory Tools</h3><div style=display:flex;flex-direction:column;gap:8px><button class="btn btn-primary">ğŸ”¬ Volatility Analysis</button><button class="btn btn-secondary">ğŸŒ³ Process Tree</button><button class="btn btn-secondary">ğŸŒ Network Connections</button><button class="btn btn-secondary">ğŸ” Crypto Analysis</button><button class="btn btn-secondary">ğŸ“¤ Extract Artifacts'),ze=o('<div><button class="btn btn-secondary">ğŸ“‚ Load Dump</button><button class="btn btn-primary">ğŸ” Analyze'),Pe=o('<span style="background:var(--danger-color);color:white;padding:2px 8px;border-radius:4px;font-size:0.8rem">Injected'),Ee=o('<span style="background:var(--warning-color);color:black;padding:2px 8px;border-radius:4px;font-size:0.8rem">Hidden'),Te=o('<span style="background:var(--barbie-pink);color:white;padding:2px 8px;border-radius:4px;font-size:0.8rem">Suspicious'),Re=o('<div style="margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid rgba(255, 107, 157, 0.2)"><div style=display:flex;justify-content:space-between;align-items:center;margin-bottom:10px><strong style=color:var(--warning-color)> <!> (PID: <!>)</strong><span style=color:var(--text-secondary)>Memory: </span></div><div style=color:var(--text-secondary);font-size:0.85rem;margin-bottom:10px></div><div style=display:flex;gap:10px;flex-wrap:wrap></div><div style=margin-top:10px;font-size:0.85rem><span style=color:var(--info-color)>Threads: </span> | <span style=color:var(--info-color)>Handles: </span> | <span style=color:var(--info-color)>Virtual: '),Fe=o("<div style=margin-bottom:15px><span style=color:var(--info-color)>0x</span><span style=color:var(--text-secondary)>(<!>)</span> - <span style=color:var(--success-color)></span><br><span style=color:var(--warning-color)>â†’ "),De=o("<span style=color:var(--text-secondary);font-family:monospace>"),ee=o("<span style=color:var(--text-secondary)>"),te=o("<span>"),Ue=o("<span style=color:var(--danger-color)>URL:"),E=o("<br>"),Le=o("<span style=color:var(--danger-color)>IP:"),Ne=o("<span style=color:var(--info-color)>Mutex:"),Ke=o("<span style=color:var(--info-color)>Registry:"),je=o("<span style=color:var(--success-color)>File:");const He=()=>{const[A,M]=_(!1),[i,I]=_(null),[w,T]=_("processes"),[re]=_(!1),[R]=_(""),[W,ne]=_(null),[H,le]=_(null),[F,se]=_(null),[oe,ie]=_(null);me(async()=>{await O();const e=setInterval(O,2e3);return ie(e),()=>{const n=oe();n!==null&&clearInterval(n)}});const O=async()=>{try{const[e,n,p]=await Promise.all([N("get_system_status"),N("get_cpu_info"),N("get_memory_info")]);ne(e),le(n),se(p)}catch(e){console.error("Failed to fetch system status:",e)}};ve(()=>{const e=J.files();if(e.length>0){const n=e[e.length-1];n&&n.analysisResult&&q(n.analysisResult)}});const V=()=>{I({timestamp:Date.now()/1e3,processes:[{pid:1234,name:"malware.exe",path:"C:\\Windows\\Temp\\malware.exe",parentPid:567,threads:8,handles:145,virtualSize:2097152,workingSet:1048576,injected:!0,hidden:!1,suspicious:!0},{pid:567,name:"explorer.exe",path:"C:\\Windows\\explorer.exe",parentPid:1,threads:42,handles:1287,virtualSize:134217728,workingSet:67108864,injected:!0,hidden:!1,suspicious:!0},{pid:2345,name:"svchost.exe",path:"C:\\Windows\\System32\\svchost.exe",parentPid:456,threads:12,handles:234,virtualSize:16777216,workingSet:8388608,injected:!1,hidden:!1,suspicious:!1}],strings:[{offset:4198400,value:"http://malicious-c2.com/beacon",encoding:"ASCII",context:"Network communication"},{offset:4203328,value:"SELECT * FROM credit_cards",encoding:"UTF-16",context:"Database query"},{offset:4208784,value:"cmd.exe /c powershell -enc",encoding:"ASCII",context:"Command execution"}],regions:[{address:"0x00400000",size:65536,protection:"RWX",type:"Private",suspicious:!0,entropy:7.85},{address:"0x7FFE0000",size:4096,protection:"R--",type:"Image",suspicious:!1,entropy:3.24}],artifacts:{urls:["http://malicious-c2.com/beacon","https://evil-payload.net/download","ftp://anonymous@badserver.com"],ips:["192.168.1.100","10.0.0.50","172.16.0.100"],mutexes:["Global\\MalwareMutex123","Local\\SystemUpdate_2024"],registryKeys:["HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Update","HKCU\\Software\\Classes\\malware"],files:["C:\\Windows\\Temp\\payload.exe","C:\\Users\\Public\\malware.dll","C:\\ProgramData\\update.bat"]}})},X=async()=>{M(!0);try{V();const e=J.currentFile;if(e!=null&&e.path){const n=await N("analyze_file_with_wasm",{filePath:e.path});q(n)}}catch(e){console.error("Memory analysis failed:",e)}finally{M(!1)}},q=e=>{if(e.strings){const n=e.strings.suspicious||[];I(p=>p&&{...p,strings:n.slice(0,20).map((x,D)=>({offset:4194304+D*4096,value:x,encoding:"UTF-8",context:ae(x)}))})}},ae=e=>e.match(/https?:\/\//i)?"Network communication":e.match(/SELECT|INSERT|UPDATE|DELETE/i)?"Database query":e.match(/cmd\.exe|powershell|bash/i)?"Command execution":e.match(/[A-Z]:\\|\\\\|\//)?"File path":e.match(/HKLM|HKCU|Software/)?"Registry key":"Data",K=e=>{const n=["B","KB","MB","GB"];let p=e,x=0;for(;p>=1024&&x<n.length-1;)p/=1024,x++;return`${p.toFixed(2)} ${n[x]}`},ce=()=>{if(!i())return[];let e=i().processes;if(re()&&(e=e.filter(n=>n.suspicious||n.injected||n.hidden)),R()){const n=R().toLowerCase();e=e.filter(p=>p.name.toLowerCase().includes(n)||p.path.toLowerCase().includes(n))}return e},de=()=>{if(!i())return[];let e=i().strings;if(R()){const n=R().toLowerCase();e=e.filter(p=>p.value.toLowerCase().includes(n)||p.context.toLowerCase().includes(n))}return e};return(()=>{var e=Ie(),n=e.firstChild,p=n.nextSibling,x=p.firstChild,D=x.nextSibling,ue=D.firstChild,z=ue.nextSibling,pe=z.nextSibling;return t(x,r(Q,{title:"Memory Dump Analysis",icon:"ğŸ§ ",className:"scrollable-panel",get actions(){return(()=>{var s=ze(),l=s.firstChild,b=l.nextSibling;return l.$$click=()=>V(),b.$$click=X,s})()},get children(){return[(()=>{var s=he(),l=s.firstChild,b=l.nextSibling,f=b.nextSibling,c=f.nextSibling;return l.$$click=()=>T("processes"),b.$$click=()=>T("strings"),f.$$click=()=>T("regions"),c.$$click=()=>T("artifacts"),G(d=>{var m=`btn ${w()==="processes"?"btn-primary":"btn-secondary"}`,u=`btn ${w()==="strings"?"btn-primary":"btn-secondary"}`,h=`btn ${w()==="regions"?"btn-primary":"btn-secondary"}`,v=`btn ${w()==="artifacts"?"btn-primary":"btn-secondary"}`;return m!==d.e&&L(l,d.e=m),u!==d.t&&L(b,d.t=u),h!==d.a&&L(f,d.a=h),v!==d.o&&L(c,d.o=v),d},{e:void 0,t:void 0,a:void 0,o:void 0}),s})(),r($,{get when(){return S(()=>!i())()&&!A()},get children(){var s=xe(),l=s.firstChild,b=l.nextSibling;return b.$$click=X,s}}),r($,{get when(){return A()},get children(){return $e()}}),r($,{get when(){return S(()=>!!i())()&&w()==="processes"},get children(){var s=_e(),l=s.firstChild,b=l.firstChild,f=b.nextSibling;return f.nextSibling,t(l,r(C,{get each(){return ce()},children:c=>(()=>{var d=Re(),m=d.firstChild,u=m.firstChild,h=u.firstChild,v=h.nextSibling,y=v.nextSibling,a=y.nextSibling;a.nextSibling;var g=u.nextSibling;g.firstChild;var P=m.nextSibling,U=P.nextSibling,ge=U.nextSibling,j=ge.firstChild;j.firstChild;var be=j.nextSibling,B=be.nextSibling;B.firstChild;var ye=B.nextSibling,Y=ye.nextSibling;return Y.firstChild,t(u,()=>c.suspicious?"âš ï¸":"ğŸ“‹",h),t(u,()=>c.name,v),t(u,()=>c.pid,a),t(g,()=>K(c.workingSet),null),t(P,()=>c.path),t(U,r($,{get when(){return c.injected},get children(){return Pe()}}),null),t(U,r($,{get when(){return c.hidden},get children(){return Ee()}}),null),t(U,r($,{get when(){return c.suspicious},get children(){return Te()}}),null),t(j,()=>c.threads,null),t(B,()=>c.handles,null),t(Y,()=>K(c.virtualSize),null),d})()}),null),s}}),r($,{get when(){return S(()=>!!i())()&&w()==="strings"},get children(){var s=Se(),l=s.firstChild,b=l.firstChild,f=b.nextSibling;return f.nextSibling,t(l,r(C,{get each(){return de()},children:c=>(()=>{var d=Fe(),m=d.firstChild;m.firstChild;var u=m.nextSibling,h=u.firstChild,v=h.nextSibling;v.nextSibling;var y=u.nextSibling,a=y.nextSibling,g=a.nextSibling,P=g.nextSibling;return P.firstChild,t(m,()=>c.offset.toString(16).padStart(8,"0"),null),t(u,()=>c.encoding,v),t(a,()=>c.context),t(P,()=>c.value,null),d})()}),null),s}}),r($,{get when(){return S(()=>!!i())()&&w()==="regions"},get children(){var s=we(),l=s.firstChild,b=l.firstChild,f=b.nextSibling,c=f.nextSibling,d=c.nextSibling,m=d.firstChild,u=m.nextSibling,h=u.nextSibling,v=h.nextSibling;return v.nextSibling,t(d,r(C,{get each(){return i().regions},children:y=>[(()=>{var a=De();return t(a,()=>y.address),a})(),(()=>{var a=ee();return t(a,()=>K(y.size)),a})(),(()=>{var a=te();return t(a,()=>y.protection),G(g=>Z(a,"color",y.protection==="RWX"?"var(--danger-color)":"var(--success-color)")),a})(),(()=>{var a=ee();return t(a,()=>y.type),a})(),(()=>{var a=te();return t(a,()=>y.entropy.toFixed(2)),G(g=>Z(a,"color",y.entropy>7?"var(--warning-color)":"var(--text-secondary)")),a})()]}),null),s}}),r($,{get when(){return S(()=>!!i())()&&w()==="artifacts"},get children(){var s=Ce(),l=s.firstChild,b=l.firstChild,f=b.nextSibling,c=f.nextSibling,d=c.nextSibling,m=d.nextSibling,u=m.nextSibling,h=u.nextSibling,v=h.nextSibling,y=v.nextSibling,a=y.nextSibling;return a.nextSibling,t(l,r(C,{get each(){return i().artifacts.urls},children:g=>[Ue()," ",g,E()]}),u),t(l,r(C,{get each(){return i().artifacts.ips},children:g=>[Le()," ",g,E()]}),u),t(l,r(C,{get each(){return i().artifacts.mutexes},children:g=>[Ne()," ",g,E()]}),y),t(l,r(C,{get each(){return i().artifacts.registryKeys},children:g=>[Ke()," ",g,E()]}),y),t(l,r(C,{get each(){return i().artifacts.files},children:g=>[je()," ",g,E()]}),null),s}})]}}),null),t(x,r(Q,{title:"String Analysis",icon:"ğŸ“",className:"scrollable-panel",get children(){return ke()}}),null),t(z,r(k,{label:"Total Memory",get value(){return S(()=>!!F())()?`${(F().total/1024/1024/1024).toFixed(1)} GB`:"0 GB"}}),null),t(z,r(k,{label:"Used Memory",get value(){return S(()=>!!F())()?`${(F().used/1024/1024/1024).toFixed(1)} GB`:"0 GB"}}),null),t(z,r(k,{label:"CPU Usage",get value(){return S(()=>!!H())()?`${H().usage.toFixed(1)}%`:"0%"}}),null),t(z,r(k,{label:"System Uptime",get value(){return S(()=>!!W())()?Be(W().uptime):"0s"}}),null),t(D,r($,{get when(){return i()},get children(){return[Ae(),(()=>{var s=Me();return t(s,r(k,{label:"Processes",get value(){return i().processes.length.toString()}}),null),t(s,r(k,{label:"Injected",get value(){return i().processes.filter(l=>l.injected).length.toString()}}),null),t(s,r(k,{label:"Suspicious",get value(){return i().processes.filter(l=>l.suspicious).length.toString()}}),null),t(s,r(k,{label:"Artifacts",get value(){return(i().artifacts.urls.length+i().artifacts.files.length).toString()}}),null),s})()]}}),pe),e})()},Be=A=>{const M=Math.floor(A/86400),i=Math.floor(A%86400/3600),I=Math.floor(A%3600/60);return M>0?`${M}d ${i}h`:i>0?`${i}h ${I}m`:`${I}m`};fe(["click"]);export{He as default};
