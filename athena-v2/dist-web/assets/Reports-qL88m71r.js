const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BatchExport-PqdMdWDE.js","assets/vendor-solid-ZF9XUUOY.js","assets/vendor-B78zZivC.js","assets/index-C4Q2lgHl.js","assets/index-BfGmqGty.css","assets/BatchExport-CLchT5JE.css"])))=>i.map(i=>d[i]);
import{a as se,i as Re,_ as we}from"./index-C4Q2lgHl.js";import{f as ne,c as I,o as Ie,t as h,i as l,a as d,b as g,F as B,e as ke,S as k,p as Te,d as Ee}from"./vendor-solid-ZF9XUUOY.js";var Ae=h("<div class=sections-list>"),Oe=h("<div class=generator-section><div class=section-header><h3>3. Customize Sections</h3><button class=customize-button>"),je=h("<div class=reports-container><div class=reports-header><h2>Report Generation</h2><div class=report-stats><span>ğŸ“„ <!> reports generated</span><button class=batch-export-button>ğŸ“¦ Batch Export</button></div></div><div class=report-generator><div class=generator-section><h3>1. Select File</h3><select class=file-selector><option value>Choose a file...</option></select></div><div class=generator-section><h3>2. Choose Template</h3><div class=template-grid></div></div><div class=generator-section><h3>4. Export Format</h3><div class=format-options><label class=format-option><input type=radio name=format value=pdf><span>ğŸ“‘ PDF</span></label><label class=format-option><input type=radio name=format value=html><span>ğŸŒ HTML</span></label><label class=format-option><input type=radio name=format value=json><span>ğŸ“Š JSON</span></label></div></div><button class=generate-button></button></div><div class=generated-reports><h3>Generated Reports</h3><div class=reports-list>"),De=h("<option>"),Fe=h("<div><h4></h4><p></p><span class=section-count> sections"),Le=h("<div class=section-item><input type=checkbox><span class=section-title></span><input type=number min=1 max=10 class=order-input>"),Ne=h("<button class=download-button>â¬‡ï¸ Download"),ze=h("<span class=generating>Generating..."),Ge=h("<span class=error>Failed"),Ue=h("<div class=report-item><div class=report-info><h4></h4><div class=report-meta><span></span><span>â€¢</span><span></span><span>â€¢</span><span></span></div></div><div class=report-status>");const Be=Te(()=>we(()=>import("./BatchExport-PqdMdWDE.js"),__vite__mapDeps([0,1,2,3,4,5]))),Me=[{id:"executive",name:"Executive Summary",description:"High-level overview for management",sections:[{id:"overview",title:"Overview",enabled:!0,order:1},{id:"risk-assessment",title:"Risk Assessment",enabled:!0,order:2},{id:"recommendations",title:"Recommendations",enabled:!0,order:3},{id:"mitre-mapping",title:"MITRE ATT&CK",enabled:!0,order:4}]},{id:"technical",name:"Technical Deep Dive",description:"Detailed technical analysis",sections:[{id:"static-analysis",title:"Static Analysis",enabled:!0,order:1},{id:"dynamic-analysis",title:"Dynamic Analysis",enabled:!0,order:2},{id:"network-analysis",title:"Network Analysis",enabled:!0,order:3},{id:"ai-insights",title:"AI Insights",enabled:!0,order:4},{id:"ioc-extraction",title:"IoC Extraction",enabled:!0,order:5},{id:"code-analysis",title:"Code Analysis",enabled:!0,order:6}]},{id:"incident",name:"Incident Response",description:"Actionable incident response report",sections:[{id:"timeline",title:"Attack Timeline",enabled:!0,order:1},{id:"indicators",title:"Indicators of Compromise",enabled:!0,order:2},{id:"affected-systems",title:"Affected Systems",enabled:!0,order:3},{id:"containment",title:"Containment Steps",enabled:!0,order:4},{id:"remediation",title:"Remediation",enabled:!0,order:5}]}],Pe=()=>{const[K,ie]=ne(Me),[S,ae]=I(null),[M,re]=I(null),[T,H]=ne([]),[V,Q]=I(!1),[x,q]=I("pdf"),[P,le]=I(!1),[oe,W]=I(!1);Ie(()=>{ce()});const ce=()=>{const e=localStorage.getItem("athena-reports");e&&H(JSON.parse(e))},de=()=>{localStorage.setItem("athena-reports",JSON.stringify(T))},ue=async()=>{const e=S(),n=M(),t=se.state.files.find(a=>a.id===n);if(!e||!t)return;Q(!0);const s={id:crypto.randomUUID(),fileId:t.id,fileName:t.name,template:e.name,createdAt:new Date,format:x(),status:"generating"};H([...T,s]);try{const a=await me(t,e);if(x()==="json")s.content=a,s.status="completed";else{const o=await Re("generate_report",{content:a,format:x(),fileName:`${t.name}_report_${Date.now()}`});s.url=o.url,s.status="completed"}}catch(a){console.error("Failed to generate report:",a),s.status="error"}const i=T.findIndex(a=>a.id===s.id);i>=0&&H(i,s),de(),Q(!1)},me=async(e,n)=>{const t={metadata:{fileName:e.name,fileHash:e.hash,fileSize:e.size,analysisDate:new Date().toISOString(),template:n.name},sections:{}},s=n.sections.filter(i=>i.enabled).sort((i,a)=>i.order-a.order);for(const i of s)t.sections[i.id]=await pe(e,i.id);return t},pe=async(e,n)=>{var t,s,i,a,o,u,m,E,j,f,A,D,F,C,L,N;switch(n){case"overview":return{title:"Executive Overview",content:`File ${e.name} has been analyzed with a comprehensive security assessment.`,severity:((t=e.results)==null?void 0:t.malwareScore)>70?"critical":((s=e.results)==null?void 0:s.malwareScore)>40?"high":"medium",summary:he(e)};case"risk-assessment":return{title:"Risk Assessment",overallRisk:ge(e),categories:{malware:((i=e.results)==null?void 0:i.malwareScore)||0,vulnerabilities:45,dataExfiltration:30,persistence:60},factors:ve(e)};case"recommendations":return{title:"Recommendations",immediate:["Isolate affected systems immediately","Block identified IoCs at perimeter","Initiate incident response procedures"],shortTerm:["Conduct full network scan for similar indicators","Update security signatures and rules","Review access logs for suspicious activity"],longTerm:["Implement enhanced monitoring","Review security architecture","Conduct security awareness training"]};case"mitre-mapping":return{title:"MITRE ATT&CK Mapping",techniques:fe(e),tactics:["Initial Access","Execution","Persistence","Defense Evasion"],heatmap:be()};case"static-analysis":return{title:"Static Analysis Results",fileInfo:((a=e.analysisResult)==null?void 0:a.basic_analysis)||{},entropy:((o=e.analysisResult)==null?void 0:o.entropy)||0,strings:((u=e.analysisResult)==null?void 0:u.strings)||[],imports:((m=e.analysisResult)==null?void 0:m.imports)||[],sections:((E=e.analysisResult)==null?void 0:E.sections)||[]};case"ai-insights":return{title:"AI Analysis Insights",consensus:((j=e.results)==null?void 0:j.aiAnalysis)||{},providers:Object.entries(((f=e.results)==null?void 0:f.aiAnalysis)||{}).map(([z,R])=>({provider:z,score:R.score,summary:R.summary,confidence:R.score/100})),aggregatedInsights:ye()};case"ioc-extraction":return{title:"Indicators of Compromise",domains:O(e,"domains"),ips:O(e,"ips"),files:O(e,"files"),registry:O(e,"registry"),hashes:{md5:(D=(A=e.analysisResult)==null?void 0:A.hashes)==null?void 0:D.md5,sha1:(C=(F=e.analysisResult)==null?void 0:F.hashes)==null?void 0:C.sha1,sha256:(N=(L=e.analysisResult)==null?void 0:L.hashes)==null?void 0:N.sha256}};default:return{title:n,content:"Section content not available"}}},he=e=>{var t;const n=((t=e.results)==null?void 0:t.malwareScore)||0;return n>70?`Critical threat detected. ${e.name} exhibits multiple malicious behaviors and should be treated as high-risk malware. Immediate action required.`:n>40?`Suspicious file detected. ${e.name} shows concerning behaviors that warrant further investigation and containment.`:"File analyzed with moderate risk indicators. Continue monitoring and apply standard security procedures."},ge=e=>{var t,s,i,a,o;const n={malwareScore:((t=e.results)==null?void 0:t.malwareScore)||0,entropy:((s=e.analysisResult)==null?void 0:s.entropy)>7?80:40,suspiciousImports:((a=(i=e.analysisResult)==null?void 0:i.imports)==null?void 0:a.filter(u=>u.suspicious).length)*10||0,aiConsensus:Object.values(((o=e.results)==null?void 0:o.aiAnalysis)||{}).reduce((u,m)=>u+m.score,0)/6};return Math.min(100,Object.values(n).reduce((u,m)=>u+m)/Object.keys(n).length)},ve=e=>{var t,s,i,a,o;const n=[];return((t=e.analysisResult)==null?void 0:t.entropy)>7&&n.push("High entropy indicates packing/encryption"),((i=(s=e.results)==null?void 0:s.threats)==null?void 0:i.length)>0&&n.push(`${e.results.threats.length} threat signatures detected`),((o=(a=e.analysisResult)==null?void 0:a.anomalies)==null?void 0:o.length)>0&&n.push("Structural anomalies detected"),n},fe=e=>{var t,s,i,a;const n=[];return(s=(t=e.analysisResult)==null?void 0:t.suspicious_strings)!=null&&s.includes("CreateRemoteThread")&&n.push("T1055 - Process Injection"),(a=(i=e.analysisResult)==null?void 0:i.suspicious_strings)!=null&&a.includes("RegSetValueEx")&&n.push("T1547.001 - Registry Run Keys"),n},be=()=>({"initial-access":.3,execution:.8,persistence:.6,"privilege-escalation":.4,"defense-evasion":.7,"credential-access":.2,discovery:.5,"lateral-movement":.3,collection:.4,"command-and-control":.6,exfiltration:.3,impact:.5}),O=(e,n)=>{var s;const t=[];return Object.values(((s=e.results)==null?void 0:s.aiAnalysis)||{}).forEach(i=>{i.details&&i.details.includes(n)}),t},ye=()=>({consensusThreatLevel:"High",confidenceScore:.87,primaryThreatType:"Banking Trojan",suggestedActions:["Immediate isolation required","Full forensic analysis recommended","Check for lateral movement indicators"]}),$e=e=>{if(e.format==="json"&&e.content){const n=new Blob([JSON.stringify(e.content,null,2)],{type:"application/json"}),t=URL.createObjectURL(n),s=document.createElement("a");s.href=t,s.download=`${e.fileName}_report_${e.id}.json`,s.click(),URL.revokeObjectURL(t)}else e.url&&window.open(e.url,"_blank")},X=(e,n)=>{const t=S();if(!t)return;const s=K.findIndex(a=>a.id===t.id),i=t.sections.findIndex(a=>a.id===e);s>=0&&i>=0&&ie(s,"sections",i,n)};return(()=>{var e=je(),n=e.firstChild,t=n.firstChild,s=t.nextSibling,i=s.firstChild,a=i.firstChild,o=a.nextSibling;o.nextSibling;var u=i.nextSibling,m=n.nextSibling,E=m.firstChild,j=E.firstChild,f=j.nextSibling;f.firstChild;var A=E.nextSibling,D=A.firstChild,F=D.nextSibling,C=A.nextSibling,L=C.firstChild,N=L.nextSibling,z=N.firstChild,R=z.firstChild,Y=z.nextSibling,Z=Y.firstChild,_e=Y.nextSibling,ee=_e.firstChild,J=C.nextSibling,Se=m.nextSibling,xe=Se.firstChild,Ce=xe.nextSibling;return l(i,()=>T.length,o),u.$$click=()=>W(!0),f.addEventListener("change",r=>re(r.currentTarget.value)),l(f,d(B,{get each(){return se.state.files.filter(r=>r.status==="completed")},children:r=>(()=>{var c=De();return l(c,()=>r.name),g(()=>c.value=r.id),c})()}),null),l(F,d(B,{each:K,children:r=>(()=>{var c=Fe(),b=c.firstChild,v=b.nextSibling,y=v.nextSibling,p=y.firstChild;return c.$$click=()=>ae(r),l(b,()=>r.name),l(v,()=>r.description),l(y,()=>r.sections.length,p),g(()=>{var $;return ke(c,`template-card ${(($=S())==null?void 0:$.id)===r.id?"selected":""}`)}),c})()})),l(m,d(k,{get when(){return S()},get children(){var r=Oe(),c=r.firstChild,b=c.firstChild,v=b.nextSibling;return v.$$click=()=>le(!P()),l(v,()=>P()?"âœ“ Done":"âš™ï¸ Customize"),l(r,d(k,{get when(){return P()},get children(){var y=Ae();return l(y,d(B,{get each(){return S().sections},children:p=>(()=>{var $=Le(),w=$.firstChild,G=w.nextSibling,U=G.nextSibling;return w.addEventListener("change",_=>X(p.id,{enabled:_.currentTarget.checked})),l(G,()=>p.title),U.addEventListener("change",_=>X(p.id,{order:parseInt(_.currentTarget.value)})),g(()=>w.checked=p.enabled),g(()=>U.value=p.order),$})()})),y}}),null),r}}),C),R.addEventListener("change",()=>q("pdf")),Z.addEventListener("change",()=>q("html")),ee.addEventListener("change",()=>q("json")),J.$$click=ue,l(J,()=>V()?"â³ Generating...":"ğŸš€ Generate Report"),l(Ce,d(B,{get each(){return T.slice().reverse()},children:r=>(()=>{var c=Ue(),b=c.firstChild,v=b.firstChild,y=v.nextSibling,p=y.firstChild,$=p.nextSibling,w=$.nextSibling,G=w.nextSibling,U=G.nextSibling,_=b.nextSibling;return l(v,()=>r.fileName),l(p,()=>r.template),l(w,()=>r.format.toUpperCase()),l(U,()=>new Date(r.createdAt).toLocaleString()),l(_,d(k,{get when(){return r.status==="completed"},get children(){var te=Ne();return te.$$click=()=>$e(r),te}}),null),l(_,d(k,{get when(){return r.status==="generating"},get children(){return ze()}}),null),l(_,d(k,{get when(){return r.status==="error"},get children(){return Ge()}}),null),c})()})),l(e,d(k,{get when(){return oe()},get children(){return d(Be,{onClose:()=>W(!1)})}}),null),g(()=>J.disabled=!M()||!S()||V()),g(()=>f.value=M()||""),g(()=>R.checked=x()==="pdf"),g(()=>Z.checked=x()==="html"),g(()=>ee.checked=x()==="json"),e})()};Ee(["click"]);export{Pe as default};
