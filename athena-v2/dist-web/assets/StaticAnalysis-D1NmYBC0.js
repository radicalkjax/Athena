import{c as d,o as he,q as ue,t as _,i,a as S,m as U,S as ve,b as me,e as ge}from"./vendor-solid-B-ykKXyV.js";import{a as fe,S as E,A as W}from"./index-UCtE3PH6.js";import"./vendor-BrNNPIVf.js";var ye=_("<div class=hash-display><div class=hash-item><span class=hash-label>MD5:</span><span class=hash-value></span></div><div class=hash-item><span class=hash-label>SHA1:</span><span class=hash-value></span></div><div class=hash-item><span class=hash-label>SHA256:</span><span class=hash-value></span></div><div class=hash-item><span class=hash-label>SSDEEP:</span><span class=hash-value>"),_e=_("<div class=file-properties><div class=property-item><span class=property-label>Architecture:</span><span class=property-value></span></div><div class=property-item><span class=property-label>Entry Point:</span><span class=property-value></span></div><div class=property-item><span class=property-label>Sections:</span><span class=property-value></span></div><div class=property-item><span class=property-label>Imports:</span><span class=property-value></span></div><div class=property-item><span class=property-label>Exports:</span><span class=property-value></span></div><div class=property-item><span class=property-label>Resources:</span><span class=property-value>"),$e=_('<div><h4 style=color:var(--barbie-pink);margin-bottom:10px>Suspicious Strings:</h4><div class=strings-list></div><h4 style="color:var(--barbie-pink);margin:20px 0 10px">API Calls:</h4><div class=api-list>'),be=_('<div class=content-panel><h2 style=color:var(--barbie-pink);margin-bottom:20px>üîç Static Analysis Results</h2><div class=stats-overview style="display:grid;grid-template-columns:repeat(4, 1fr);gap:20px;margin-bottom:30px"><div class=entropy-stat-card><div class=entropy-bar><div class=entropy-fill></div><span class=entropy-label>%</span></div></div></div><div class=analysis-grid><div class=analysis-main></div><div class=ensemble-results><h3 style=color:var(--barbie-pink);margin-bottom:15px>ü§ñ AI Provider Ensemble Analysis</h3><div class=ensemble-consensus><div class=consensus-score></div><div style=color:var(--text-secondary)><strong>Consensus:</strong> </div></div><div class=agent-results>'),xe=_("<div class=string-item>"),Se=_("<div class=api-item><span class=api-name></span><span class=api-description>"),Ce=_("<div style=color:var(--text-secondary);text-align:center;padding:20px>AI analysis results will appear here when analysis is complete"),Ae=_("<div class=agent-result><div class=agent-name></div><div class=agent-prediction>");const Ee=()=>{const[w,B]=d({md5:"",sha1:"",sha256:"",ssdeep:""}),[C,G]=d({architecture:"",entryPoint:"",sections:0,imports:0,exports:0,resources:0,timestamp:""}),[K,V]=d([]),[q,J]=d([]),[F,M]=d([]),I=()=>{var $;const e=F();if(e.length===0)return{confidence:0,verdict:"Awaiting analysis"};const s=e.map(t=>t.confidence??50).filter(t=>t>0),n=s.length>0?Math.round(s.reduce((t,o)=>t+o,0)/s.length):0,r=e.map(t=>t.prediction.toLowerCase()),h=r.filter(t=>t.includes("malware")||t.includes("trojan")||t.includes("virus")||t.includes("ransomware")||t.includes("backdoor")||t.includes("stealer")).length,u=r.filter(t=>t.includes("clean")||t.includes("benign")||t.includes("safe")).length;let v="Analysis inconclusive";return h>u&&h>=e.length/2?v=(($=e.filter(o=>o.prediction.toLowerCase().includes("malware")||o.prediction.toLowerCase().includes("trojan"))[0])==null?void 0:$.prediction)||"Potential malware detected":u>h&&u>=e.length/2&&(v="File appears clean"),{confidence:n,verdict:v}},[,Q]=d(null),[R,X]=d(0),[Y,Z]=d(""),[z,ee]=d(0),[se,ie]=d("None");he(()=>{const e=s=>{const n=s,{result:r}=n.detail;N(r)};return window.addEventListener("file-analyzed",e),()=>{window.removeEventListener("file-analyzed",e)}}),ue(()=>{const e=fe.files();if(e.length>0){const s=e[e.length-1];if(!s)return;Q(s),s.analysisResult&&N(s.analysisResult)}});const N=e=>{var n,r,h,u,v,$,t,o,P;B({md5:((n=e.hashes)==null?void 0:n.md5)||"",sha1:((r=e.hashes)==null?void 0:r.sha1)||"",sha256:((h=e.hashes)==null?void 0:h.sha256)||"",ssdeep:((u=e.hashes)==null?void 0:u.ssdeep)||""});const s=e.format||{};if(G({architecture:s.architecture||"Unknown",entryPoint:s.entry_point?`0x${s.entry_point.toString(16)}`:"N/A",sections:((v=s.sections)==null?void 0:v.length)||0,imports:(($=s.imports)==null?void 0:$.length)||0,exports:((t=s.exports)==null?void 0:t.length)||0,resources:((o=s.resources)==null?void 0:o.length)||0,timestamp:new Date().toISOString()}),X(e.entropy||0),Z(s.type||"Unknown"),ee(e.size||0),ie(s.packer_info||"None detected"),(P=e.strings)!=null&&P.suspicious&&V(e.strings.suspicious.slice(0,10)),s.imports){const c=s.imports.filter(l=>te(l.name)).slice(0,10).map(l=>({name:l.name,description:ne(l.name)}));J(c)}if(e.ai_results||e.aiResults){const c=e.ai_results||e.aiResults;Array.isArray(c)?M(c.map(l=>({provider:l.provider||l.model||"Unknown",prediction:l.prediction||l.verdict||l.result||"No prediction",confidence:l.confidence??l.score??0}))):typeof c=="object"&&M([{provider:c.provider||"AI",prediction:c.prediction||c.verdict||"No prediction",confidence:c.confidence??0}])}},te=e=>["CreateRemoteThread","VirtualAllocEx","WriteProcessMemory","SetWindowsHookEx","RegCreateKeyEx","InternetConnect","CreateFile","OpenProcess","LoadLibrary","GetProcAddress"].some(n=>e.includes(n)),ne=e=>{const s={CreateRemoteThread:"Code injection",VirtualAllocEx:"Memory allocation in remote process",WriteProcessMemory:"Process manipulation",SetWindowsHookEx:"Hooking mechanism",RegCreateKeyEx:"Registry manipulation",InternetConnect:"Network activity",CreateFile:"File system access",OpenProcess:"Process access",LoadLibrary:"DLL loading",GetProcAddress:"Dynamic API resolution"};for(const[n,r]of Object.entries(s))if(e.includes(n))return r;return"System API"};return(()=>{var e=be(),s=e.firstChild,n=s.nextSibling,r=n.firstChild,h=r.firstChild,u=h.firstChild,v=u.nextSibling,$=v.firstChild,t=n.nextSibling,o=t.firstChild,P=o.nextSibling,c=P.firstChild,l=c.nextSibling,j=l.firstChild,T=j.nextSibling,le=T.firstChild;le.nextSibling;var ae=l.nextSibling;return i(n,S(E,{get value(){return Y()||"Unknown"},label:"File Type"}),r),i(n,S(E,{get value(){return U(()=>z()>0)()?`${(z()/1024/1024).toFixed(2)}MB`:"0MB"},label:"File Size"}),r),i(r,S(E,{get value(){return R().toFixed(2)},label:"Entropy Score"}),h),i(v,()=>(R()/8*100).toFixed(1),$),i(n,S(E,{get value(){return se()},label:"Packer Detected"}),null),i(o,S(W,{title:"File Hashes & Properties",icon:"üîê",get children(){return[(()=>{var a=ye(),p=a.firstChild,m=p.firstChild,b=m.nextSibling,x=p.nextSibling,f=x.firstChild,g=f.nextSibling,y=x.nextSibling,A=y.firstChild,L=A.nextSibling,k=y.nextSibling,D=k.firstChild,H=D.nextSibling;return i(b,()=>w().md5),i(g,()=>w().sha1),i(L,()=>w().sha256),i(H,()=>w().ssdeep),a})(),(()=>{var a=_e(),p=a.firstChild,m=p.firstChild,b=m.nextSibling,x=p.nextSibling,f=x.firstChild,g=f.nextSibling,y=x.nextSibling,A=y.firstChild,L=A.nextSibling,k=y.nextSibling,D=k.firstChild,H=D.nextSibling,O=k.nextSibling,re=O.firstChild,oe=re.nextSibling,ce=O.nextSibling,pe=ce.firstChild,de=pe.nextSibling;return i(b,()=>C().architecture),i(g,()=>C().entryPoint),i(L,()=>C().sections),i(H,()=>C().imports),i(oe,()=>C().exports),i(de,()=>C().resources),a})()]}}),null),i(o,S(W,{title:"Strings & Indicators",icon:"üß¨",get children(){var a=$e(),p=a.firstChild,m=p.nextSibling,b=m.nextSibling,x=b.nextSibling;return i(m,()=>K().map(f=>(()=>{var g=xe();return i(g,f),g})())),i(x,()=>q().map(f=>(()=>{var g=Se(),y=g.firstChild,A=y.nextSibling;return i(y,()=>f.name),i(A,()=>f.description),g})())),a}}),null),i(j,(()=>{var a=U(()=>I().confidence>0);return()=>a()?`${I().confidence}% Confidence`:"No data"})()),i(T,()=>I().verdict,null),i(ae,S(ve,{get when(){return F().length>0},get fallback(){return Ce()},get children(){return F().map(a=>(()=>{var p=Ae(),m=p.firstChild,b=m.nextSibling;return i(m,()=>a.provider),i(b,()=>a.prediction),p})())}})),me(a=>ge(u,`width: ${(R()/8*100).toFixed(1)}%`,a)),e})()};export{Ee as default};
