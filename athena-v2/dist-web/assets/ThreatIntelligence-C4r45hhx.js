import{c as _,o as fe,t as l,i as n,a as o,S as v,m as U,F as T,b as V,d as ye}from"./vendor-solid-ZF9XUUOY.js";import{A as z,a as w,i as H}from"./index-C4Q2lgHl.js";var ve=l("<div style=color:var(--warning-color);margin-top:15px;max-width:500px;margin-left:auto;margin-right:auto>This is taking longer than usual. External threat intelligence services may be experiencing high load or network delays."),$e=l('<div style=text-align:center;padding:40px;background:var(--panel-bg);border-radius:8px;margin-bottom:20px><div class=spinner style="margin:0 auto 20px"></div><div style=color:var(--text-secondary)>'),_e=l('<div style=background:var(--danger-color);color:white;padding:15px;border-radius:8px;margin-bottom:20px><strong>Error:</strong> <button style="margin-left:10px;padding:5px 10px;background:white;color:var(--danger-color);border:none;border-radius:4px;cursor:pointer">Retry'),Se=l("<span style=color:var(--danger-color)>MD5:"),q=l("<br>"),xe=l("<span style=color:var(--danger-color)>SHA1:"),ke=l("<span style=color:var(--danger-color)>SHA256:"),Te=l("<div class=code-editor><div class=code-content><strong style=color:var(--danger-color)>ğŸš¨ HIGH PRIORITY IOCs</strong><br><br><strong style=color:var(--barbie-pink)>File Hashes:</strong><br><br><strong style=color:var(--barbie-pink)>Network Indicators:</strong><br><br><strong style=color:var(--barbie-pink)>File System Artifacts:</strong><br><br><strong style=color:var(--barbie-pink)>Registry Keys:</strong><br><br><strong style=color:var(--barbie-pink)>Process Indicators:</strong><br>"),we=l("<div class=code-editor><div class=code-content><strong style=color:var(--barbie-pink)>THREAT ATTRIBUTION</strong><br><br><strong>Campaign Name:</strong> <span style=color:var(--danger-color)>Operation Banking Wolf</span><br><strong>Threat Actor:</strong> <span style=color:var(--warning-color)>TA505 (Financially Motivated)</span><br><strong>Active Since:</strong> <span style=color:var(--text-secondary)>September 2024</span><br><strong>Geographic Focus:</strong> <span style=color:var(--info-color)>North America, Europe</span><br><strong>Confidence Level:</strong> <span style=color:var(--success-color)>High (85%)</span><br><br><strong style=color:var(--barbie-pink)>CAMPAIGN CHARACTERISTICS:</strong><br><br><strong>Primary Targets:</strong><br>â€¢ Financial institutions and their customers<br>â€¢ E-commerce platforms<br>â€¢ Online banking users<br>â€¢ Small to medium businesses<br><br><strong>Attack Vector:</strong><br>â€¢ Phishing emails with malicious attachments<br>â€¢ Fake software updates<br>â€¢ Exploit kits on compromised websites<br>â€¢ Social engineering campaigns<br><br><strong>Infrastructure Pattern:</strong><br>â€¢ Uses fast-flux DNS for C2 servers<br>â€¢ Bulletproof hosting in Eastern Europe<br>â€¢ Domain generation algorithm (DGA) backup<br>â€¢ Encrypted communication channels<br><br><strong style=color:var(--barbie-pink)>RELATED SAMPLES:</strong><br>â€¢ SHA256: abcdef1234567890... (87% similarity)<br>â€¢ SHA256: fedcba0987654321... (92% similarity)<br>â€¢ SHA256: 1357924680acebd... (76% similarity)"),Ie=l('<div class=content-panel><h2 style=color:var(--barbie-pink);margin-bottom:20px>ğŸš¨ Threat Intelligence - IOCs & Attribution</h2><div class=analysis-grid><div class=analysis-main></div><div class=ensemble-results><div class=mitre-mapping-section><h3 class=mitre-mapping-header>ğŸ¯ MITRE ATT&CK Mapping</h3><div class=mitre-categories></div></div><div class=defense-section><h3 class=defense-header>ğŸ›¡ï¸ Defense Recommendations</h3><div class=defense-content><div class=defense-priority><strong class="priority-label immediate">Immediate Actions:</strong><div class=defense-item>âœ… Block malicious domains/IPs</div><div class=defense-item>âœ… Remove registry persistence</div><div class=defense-item>âœ… Scan for similar indicators</div><div class=defense-item>âœ… Update endpoint protection</div></div><div class=defense-priority><strong class="priority-label medium">Medium-term:</strong><div class=defense-item>âš ï¸ User awareness training</div><div class=defense-item>âš ï¸ Email security hardening</div><div class=defense-item>âš ï¸ Network segmentation</div><div class=defense-item>âš ï¸ Behavioral monitoring</div></div></div></div><div class=threat-actions><button class="threat-action-btn primary">ğŸ“¤ Share Intel</button><button class=threat-action-btn>ğŸ”— MITRE Navigator</button><button class=threat-action-btn>ğŸ“Š Campaign Report</button><button class=threat-action-btn>ğŸš¨ Create Alert'),Ce=l('<div style=display:flex;gap:8px><button class="btn btn-secondary">ğŸ“‹ Copy IOCs</button><button class="btn btn-primary">ğŸ“¤ Export STIX'),Ee=l("<span style=color:var(--text-secondary)>No file hashes available"),Ae=l("<span style=color:var(--text-secondary)>No network indicators detected"),He=l("<div><span style=color:var(--danger-color)>:</span> <br>"),Re=l("<span style=color:var(--text-secondary)>No file system artifacts detected"),Ne=l("<div><span style=color:var(--warning-color)>File:</span> <br>"),Fe=l("<span style=color:var(--text-secondary)>No registry artifacts detected"),Oe=l("<div><span style=color:var(--danger-color)>Key:</span> <br><span style=color:var(--warning-color)>Value:</span> <br>"),Pe=l("<span style=color:var(--text-secondary)>No process artifacts detected"),Le=l("<div><span style=color:var(--warning-color)>Process:</span> <!> (<!>)<br>"),Me=l("<div class=mitre-category><strong class=mitre-category-name>:"),De=l("<div class=mitre-technique><span class=mitre-technique-id></span> - ");const Ke=()=>{const[I,h]=_(!1),[C,J]=_([]),[Ue,qe]=_("all"),[j,c]=_(null),[Q,S]=_(!1),[Z,F]=_("Loading threat intelligence...");fe(()=>{w.currentFile&&B()});const B=async()=>{const e=w.currentFile;if(!e){c("No file selected. Please upload and analyze a file first.");return}h(!0),c(null),S(!1),F("Querying threat intelligence sources...");const i=setTimeout(()=>{S(!0),F("Still loading... External threat intelligence services may be slow.")},6e4);try{const t=await H("get_threat_intelligence",{fileHash:e.hash,iocs:[]});clearTimeout(i),J(t),t.length===0&&c("No threat intelligence found for this file. This may indicate the file is new or not previously reported.")}catch(t){clearTimeout(i);const b=t instanceof Error?t.message:"Failed to fetch threat intelligence";c(`${b}

Possible causes:
- Network connectivity issues
- Threat intelligence service unavailable
- Invalid file hash or API key`)}finally{h(!1),S(!1)}},ee=async()=>{try{const e=g();let i=`=== FILE HASHES ===
`;e.fileHashes.md5&&(i+=`MD5: ${e.fileHashes.md5}
`,i+=`SHA1: ${e.fileHashes.sha1}
`,i+=`SHA256: ${e.fileHashes.sha256}

`),i+=`=== NETWORK INDICATORS ===
`,e.networkIndicators.forEach(t=>{i+=`${t.type}: ${t.value}
`}),i+=`
=== FILE SYSTEM ===
`,e.fileSystem.forEach(t=>{i+=`${t}
`}),i+=`
=== REGISTRY KEYS ===
`,e.registry.forEach(t=>{i+=`${t.key}: ${t.value}
`}),i+=`
=== PROCESSES ===
`,e.processes.forEach(t=>{i+=`${t.name} (${t.type})
`}),await navigator.clipboard.writeText(i),alert("IOCs copied to clipboard!")}catch(e){c(`Failed to copy IOCs: ${e}`)}},te=async()=>{try{const e=w.currentFile;if(!e){c("No file selected for STIX export");return}if(C().length===0){c("No threat intelligence data available to export. Please fetch threat intelligence first.");return}h(!0),F("Generating STIX export..."),S(!1);const i=setTimeout(()=>{S(!0)},3e4),t=await H("export_stix_format",{fileHash:e.hash,indicators:C()});clearTimeout(i);const b=`stix_export_${Date.now()}.json`,x=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),u=URL.createObjectURL(x),E=document.createElement("a");E.href=u,E.download=b,E.click(),URL.revokeObjectURL(u),alert(`STIX export successful: ${b}`)}catch(e){const i=e instanceof Error?e.message:"Unknown error";c(`Failed to export STIX: ${i}

Please check your threat intelligence data and try again.`)}finally{h(!1),S(!1)}},re=async()=>{try{const e=w.currentFile;if(!e){c("No file selected for sharing");return}h(!0),await H("share_threat_intelligence",{fileHash:e.hash,indicators:C(),platforms:["misp","virustotal"]}),alert("Threat intelligence shared successfully!")}catch(e){c(`Failed to share intelligence: ${e}`)}finally{h(!1)}},ne=()=>{window.open("https://mitre-attack.github.io/attack-navigator/","_blank")},ie=async()=>{try{const e=w.currentFile;if(!e){c("No file selected for report generation");return}h(!0);const i=await H("generate_campaign_report",{fileHash:e.hash,threatIntel:C()}),t=`campaign_report_${Date.now()}.html`,b=new Blob([i],{type:"text/html"}),x=URL.createObjectURL(b),u=document.createElement("a");u.href=x,u.download=t,u.click(),URL.revokeObjectURL(x)}catch(e){c(`Failed to generate report: ${e}`)}finally{h(!1)}},le=async()=>{try{const e=w.currentFile;if(!e){c("No file selected for alert creation");return}h(!0),await H("create_threat_alert",{fileHash:e.hash,severity:"high",indicators:C()}),alert("Threat alert created successfully!")}catch(e){c(`Failed to create alert: ${e}`)}finally{h(!1)}},[g]=_({fileHashes:{md5:"",sha1:"",sha256:""},networkIndicators:[],fileSystem:[],registry:[],processes:[]}),ae=[{category:"Initial Access",techniques:["T1566.001 - Spearphishing Attachment","T1566.002 - Spearphishing Link"]},{category:"Execution",techniques:["T1059.003 - Windows Command Shell","T1204.002 - Malicious File"]},{category:"Persistence",techniques:["T1547.001 - Registry Run Keys","T1053.005 - Scheduled Task"]},{category:"Defense Evasion",techniques:["T1055.012 - Process Hollowing","T1027 - Obfuscated Files","T1140 - Deobfuscate/Decode Files"]},{category:"Collection",techniques:["T1056.001 - Keylogging","T1113 - Screen Capture"]},{category:"Command and Control",techniques:["T1071.001 - Web Protocols","T1573.001 - Symmetric Cryptography"]}];return(()=>{var e=Ie(),i=e.firstChild,t=i.nextSibling,b=t.firstChild,x=b.nextSibling,u=x.firstChild,E=u.firstChild,se=E.nextSibling,oe=u.nextSibling,ce=oe.nextSibling,O=ce.firstChild,K=O.nextSibling,P=K.nextSibling,G=P.nextSibling;return n(e,o(v,{get when(){return I()},get children(){var r=$e(),a=r.firstChild,d=a.nextSibling;return n(d,Z),n(r,o(v,{get when(){return Q()},get children(){return ve()}}),null),r}}),t),n(e,o(v,{get when(){return j()},get children(){var r=_e(),a=r.firstChild,d=a.nextSibling,m=d.nextSibling;return n(r,j,m),m.$$click=()=>{c(null),B()},r}}),t),n(b,o(z,{title:"Indicators of Compromise (IOCs)",icon:"ğŸ¯",get actions(){return(()=>{var r=Ce(),a=r.firstChild,d=a.nextSibling;return a.$$click=ee,d.$$click=te,V(()=>d.disabled=I()),r})()},className:"scrollable-panel",get children(){var r=Te(),a=r.firstChild,d=a.firstChild,m=d.nextSibling,L=m.nextSibling,M=L.nextSibling,D=M.nextSibling,k=D.nextSibling,R=k.nextSibling,de=R.nextSibling,X=de.nextSibling,ge=X.nextSibling,he=ge.nextSibling,W=he.nextSibling,be=W.nextSibling,pe=be.nextSibling,Y=pe.nextSibling,ue=Y.nextSibling;return ue.nextSibling,n(a,o(v,{get when(){return g().fileHashes.md5},get fallback(){return Ee()},get children(){return[Se()," ",U(()=>g().fileHashes.md5),q(),xe()," ",U(()=>g().fileHashes.sha1),q(),ke()," ",U(()=>g().fileHashes.sha256),q()]}}),k),n(a,o(v,{get when(){return g().networkIndicators.length>0},get fallback(){return Ae()},get children(){return o(T,{get each(){return g().networkIndicators},children:p=>(()=>{var s=He(),f=s.firstChild,$=f.firstChild,y=f.nextSibling,A=y.nextSibling;return n(f,()=>p.type,$),n(s,()=>p.value,A),s})()})}}),X),n(a,o(v,{get when(){return g().fileSystem.length>0},get fallback(){return Re()},get children(){return o(T,{get each(){return g().fileSystem},children:p=>(()=>{var s=Ne(),f=s.firstChild,$=f.nextSibling,y=$.nextSibling;return n(s,p,y),s})()})}}),W),n(a,o(v,{get when(){return g().registry.length>0},get fallback(){return Fe()},get children(){return o(T,{get each(){return g().registry},children:p=>(()=>{var s=Oe(),f=s.firstChild,$=f.nextSibling,y=$.nextSibling,A=y.nextSibling,N=A.nextSibling,me=N.nextSibling;return n(s,()=>p.key,y),n(s,()=>p.value,me),s})()})}}),Y),n(a,o(v,{get when(){return g().processes.length>0},get fallback(){return Pe()},get children(){return o(T,{get each(){return g().processes},children:p=>(()=>{var s=Le(),f=s.firstChild,$=f.nextSibling,y=$.nextSibling,A=y.nextSibling,N=A.nextSibling;return N.nextSibling,n(s,()=>p.name,y),n(s,()=>p.type,N),s})()})}}),null),r}}),null),n(b,o(z,{title:"Attribution & Campaign Analysis",icon:"ğŸ•µï¸",className:"scrollable-panel",get children(){return we()}}),null),n(se,o(T,{each:ae,children:r=>(()=>{var a=Me(),d=a.firstChild,m=d.firstChild;return n(d,()=>r.category,m),n(a,o(T,{get each(){return r.techniques},children:L=>{const[M,...D]=L.split(" - ");return(()=>{var k=De(),R=k.firstChild;return R.nextSibling,n(R,M),n(k,()=>D.join(" - "),null),k})()}}),null),a})()})),O.$$click=re,K.$$click=ne,P.$$click=ie,G.$$click=le,V(r=>{var a=I(),d=I(),m=I();return a!==r.e&&(O.disabled=r.e=a),d!==r.t&&(P.disabled=r.t=d),m!==r.a&&(G.disabled=r.a=m),r},{e:void 0,t:void 0,a:void 0}),e})()};ye(["click"]);export{Ke as default};
