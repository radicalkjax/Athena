import{c as m,o as Ie,q as Ne,t as f,i as r,a as h,s as Te,l as _,b as E,F as J,S as N,m as oe,g as ze}from"./vendor-solid-B-ykKXyV.js";import{a as D,i as k,A as Q}from"./index-UCtE3PH6.js";import{o as Le}from"./vendor-BrNNPIVf.js";var Fe=f(`<div class=code-editor><textarea class=yara-editor-textarea placeholder="Enter your YARA rule here..."style="min-height:350px;font-family:'JetBrains Mono', monospace;font-size:0.9rem;line-height:1.5;border-radius:8px">`),Ee=f("<option value>Loading rule sets..."),Ye=f("<div style=background:var(--code-bg);padding:12px;border-radius:6px;font-size:0.85rem><div style=color:var(--text-secondary);margin-bottom:8px><strong style=color:var(--barbie-pink)>Selected Rule Set:"),Me=f('<div style=display:flex;flex-direction:column;gap:15px><div style=display:flex;gap:10px;flex-wrap:wrap><button class="btn btn-secondary"></button><button class="btn btn-secondary"></button></div><div style=display:flex;flex-direction:column;gap:8px><label style=color:var(--text-primary);font-weight:500>Available Rule Sets:</label><select class=form-select style=border-radius:6px;font-size:0.9rem></select></div><div style="color:var(--text-secondary);font-size:0.85rem;padding:10px;background:rgba(255, 107, 157, 0.1);border-radius:6px"><strong style=color:var(--barbie-pink)>ğŸ’¡ Tips:</strong><br>â€¢ Import custom YARA rules from .yar or .yara files<br>â€¢ Auto-generate rules based on current analysis results<br>â€¢ Generated rules include file hash, suspicious strings, and behaviors'),Pe=f("<div class=code-editor><div class=code-content><strong style=color:var(--barbie-pink)>TEST RESULTS</strong><br><br><span style=color:var(--success-color)>âœ… Compilation:</span> <br><span style=color:var(--info-color)>âš¡ Performance:</span> <br><span style=color:var(--warning-color)>âš ï¸ FP Risk:</span> <br><br><strong style=color:var(--barbie-pink)>RECOMMENDATIONS</strong><br><br>"),Oe=f('<div style="color:var(--danger-color);margin:10px 0;padding:10px;background:rgba(255, 107, 107, 0.1);border-radius:6px">âŒ '),Ge=f("<div class=content-panel><h2 style=color:var(--barbie-pink);margin-bottom:20px>ğŸ“ YARA Rules - Signature Detection</h2><div class=analysis-grid><div class=analysis-main></div><div class=ensemble-results><h3 style=color:var(--barbie-pink);margin-bottom:15px>ğŸ“š Saved Rules</h3><div style=background:var(--code-bg);padding:15px;border-radius:6px;margin-bottom:15px;font-size:0.85rem;max-height:200px;overflow-y:auto></div><h3 style=color:var(--barbie-pink);margin-bottom:15px>ğŸ“Š Scanner Status</h3><div style=background:var(--code-bg);padding:15px;border-radius:6px;margin-bottom:15px;font-size:0.85rem><br><br><br><br><strong>Matches:</strong> "),Ue=f('<div style=display:flex;gap:8px><button class="btn btn-secondary">â• New</button><button class="btn btn-secondary">ğŸ“„ Save</button><button class="btn btn-primary">'),je=f("<option> (<!> rules)"),Je=f("<div style=color:var(--text-secondary);margin-top:4px>Categories: "),De=f("<div><div style=color:var(--info-color)>ğŸ“¦ </div><div style=color:var(--text-secondary);margin-top:4px>Rules: <!> | Status: "),Be=f("<span style=color:var(--info-color)>â€¢ <br>"),He=f("<span style=color:var(--text-secondary)>No saved rules yet."),qe=f('<div style="display:flex;justify-content:space-between;align-items:center;padding:8px;margin-bottom:6px;background:rgba(255, 107, 157, 0.1);border-radius:4px"><span style=cursor:pointer;color:var(--barbie-pink);flex:1>ğŸ“ </span><button style=background:none;border:none;color:var(--danger-color);cursor:pointer>Ã—');const Qe=()=>{const[B,C]=m(`rule My_Custom_Rule {
    meta:
        description = "Custom detection rule"
        author = "Athena User"
        threat_level = "medium"

    strings:
        $mz = "MZ"
        $string1 = "suspicious_string" nocase

    condition:
        $mz at 0 and any of ($string*)
}`),[T,Y]=m([]),[M,A]=m(null),[W,ce]=m([]),[de,X]=m(!1),[ee,H]=m(!1),[te,ue]=m(!1),[ne,ge]=m(!1),[re,b]=m(null),[pe,z]=m([]),[q,be]=m([]),[V,me]=m("default-malware-rules"),[le,ie]=m(!1),[ae,se]=m(!1);Ie(()=>{(()=>{const e=localStorage.getItem("athena-yara-rules");if(e)try{const i=JSON.parse(e);if(!Array.isArray(i)){console.warn("Invalid YARA rules format: expected array"),localStorage.removeItem("athena-yara-rules");return}const l=i.filter(n=>{if(typeof n!="object"||n===null)return!1;const d=n;return typeof d.name=="string"&&typeof d.content=="string"});l.length>0&&(Y(l),l[0].content&&C(l[0].content))}catch(i){console.warn("Failed to parse saved YARA rules:",i),localStorage.removeItem("athena-yara-rules")}})(),k("initialize_yara_scanner").then(()=>ue(!0)).catch(e=>console.warn("Scanner init failed:",e)),k("load_default_yara_rules").then(()=>ge(!0)).catch(e=>console.warn("Rules load failed:",e)),k("get_yara_rule_sets").then(e=>be(e)).catch(e=>console.warn("Failed to load rule sets:",e))}),Ne(()=>{const t=D.files(),e=te(),i=ne();if(t.length>0&&e&&i){const l=t[t.length-1];l!=null&&l.path&&fe(l.path)}});const fe=t=>{X(!0),b(null),k("scan_file_with_yara",{filePath:t}).then(e=>{ce((e==null?void 0:e.matches)||[])}).catch(e=>{console.warn("YARA scan failed:",e)}).finally(()=>{X(!1)})},he=()=>{H(!0),A(null),b(null),z([]);const t=B();if(!t.trim()){b("Please enter a YARA rule to test"),H(!1);return}const e=[],i=t.includes("nocase"),l=t.includes("{")&&t.includes("}"),n=t.includes("filesize"),d=(t.match(/\$\w+\s*=/g)||[]).length;d<3&&e.push("Add more specific strings to improve detection accuracy"),n||e.push("Consider adding filesize constraints"),!i&&d>0&&e.push('Consider using "nocase" modifier'),l||e.push("Add hex byte patterns for binary matching"),e.length===0&&e.push("Rule looks comprehensive!"),z(e),k("validate_yara_rule",{rulesContent:t}).then(s=>{const R=(s==null?void 0:s.compilation)==="Success",g=(s==null?void 0:s.string_count)||0,x=g>=3?"Low":"Medium";A({compilation:R?"Success":"Failed",matches:0,falsePositives:x,performance:"Good",coverage:{strings:Math.min(100,Math.round(g/6*100)),conditions:85,confidence:75,fpRisk:x},warnings:(s==null?void 0:s.warnings)||[],errors:(s==null?void 0:s.errors)||[]})}).catch(s=>{b(`Rule validation failed: ${s}`),A({compilation:"Failed",matches:0,falsePositives:"N/A",performance:"N/A",coverage:{strings:0,conditions:0,confidence:0,fpRisk:"N/A"},warnings:[],errors:[String(s)]})}).finally(()=>{H(!1)})},ve=()=>{const t=B();if(!t.trim()){b("No rule to save");return}const e=t.match(/rule\s+(\w+)/),i=(e==null?void 0:e[1])||`rule_${Date.now()}`,l=T(),n=l.findIndex(x=>x.name===i);let d;n>=0?(d=[...l],d[n]={name:i,content:t}):d=[...l,{name:i,content:t}],Y(d),localStorage.setItem("athena-yara-rules",JSON.stringify(d));const s=new Blob([t],{type:"text/plain"}),R=URL.createObjectURL(s),g=document.createElement("a");g.href=R,g.download=`${i}.yar`,g.click(),URL.revokeObjectURL(R),b(null)},_e=t=>{C(t.content),A(null),z([]),b(null)},xe=t=>{const e=T().filter(i=>i.name!==t);Y(e),localStorage.setItem("athena-yara-rules",JSON.stringify(e))},ye=()=>{C(`rule New_Rule {
    meta:
        description = "New detection rule"
        author = "Athena User"

    strings:
        $s1 = "pattern" nocase

    condition:
        any of them
}`),A(null),z([]),b(null)},$e=async()=>{try{ie(!0),b(null);const t=await Le({multiple:!1,filters:[{name:"YARA Rules",extensions:["yar","yara","txt"]}]});if(t&&typeof t=="string"){const e=await k("read_file_text",{path:t});await k("load_yara_rules",{rulesContent:e,namespace:"imported"}),C(e),b(null);const i=e.match(/rule\s+(\w+)/),l=(i==null?void 0:i[1])||`imported_${Date.now()}`,n=[...T(),{name:l,content:e}];Y(n),localStorage.setItem("athena-yara-rules",JSON.stringify(n))}}catch(t){b(`Failed to import rules: ${t}`),console.error("Import error:",t)}finally{ie(!1)}},Se=async()=>{var t,e;try{se(!0),b(null);const i=D.currentFile,l=D.analysisProgress;if(!i){b("No file selected for rule generation");return}const n=(t=l==null?void 0:l.staticAnalysis)==null?void 0:t.result,d=(e=l==null?void 0:l.dynamicAnalysis)==null?void 0:e.result,s=i.hash||"unknown",R=i.type||"unknown",g=[];n!=null&&n.strings&&g.push(...n.strings),n!=null&&n.suspicious_strings&&g.push(...n.suspicious_strings);const x=[];n!=null&&n.imports&&x.push(...n.imports),n!=null&&n.suspicious_imports&&x.push(...n.suspicious_imports);const I=[];d!=null&&d.behaviors&&I.push(...d.behaviors),n!=null&&n.behaviors&&I.push(...n.behaviors);const P=await k("auto_generate_yara_rules",{fileHash:s,fileType:R,suspiciousStrings:g.slice(0,10),suspiciousImports:x.slice(0,10),behaviors:I.slice(0,5)});C(P),A(null),z([]),b(null)}catch(i){b(`Failed to generate rules: ${i}`),console.error("Auto-generation error:",i)}finally{se(!1)}};return(()=>{var t=Ge(),e=t.firstChild,i=e.nextSibling,l=i.firstChild,n=l.nextSibling,d=n.firstChild,s=d.nextSibling,R=s.nextSibling,g=R.nextSibling,x=g.firstChild,I=x.nextSibling,P=I.nextSibling,Re=P.nextSibling,we=Re.nextSibling;return we.nextSibling,r(l,h(Q,{title:"YARA Rule Editor",icon:"ğŸ¯",className:"scrollable-panel",get actions(){return(()=>{var o=Ue(),a=o.firstChild,p=a.nextSibling,y=p.nextSibling;return a.$$click=ye,p.$$click=ve,y.$$click=he,r(y,()=>ee()?"â³ Testing...":"âœ… Test Rule"),E(()=>y.disabled=ee()),o})()},get children(){var o=Fe(),a=o.firstChild;return a.$$input=p=>C(p.currentTarget.value),Te(a,"spellcheck",!1),_(a,"width","100%"),_(a,"padding","15px"),_(a,"background","var(--code-bg)"),_(a,"color","var(--text-primary)"),_(a,"border","1px solid rgba(255, 107, 157, 0.3)"),_(a,"resize","vertical"),_(a,"outline","none"),E(()=>a.value=B()),o}}),null),r(l,h(Q,{title:"Rule Management",icon:"ğŸ“š",className:"scrollable-panel",get children(){var o=Me(),a=o.firstChild,p=a.firstChild,y=p.nextSibling,O=a.nextSibling,Z=O.firstChild,$=Z.nextSibling,G=O.nextSibling;return p.$$click=$e,r(p,()=>le()?"â³ Importing...":"ğŸ“¥ Import Rules"),y.$$click=Se,r(y,()=>ae()?"â³ Generating...":"ğŸ¤– Auto-Generate Rules"),$.addEventListener("change",u=>me(u.currentTarget.value)),_($,"padding","8px 12px"),_($,"background","var(--code-bg)"),_($,"color","var(--text-primary)"),_($,"border","1px solid rgba(255, 107, 157, 0.3)"),_($,"cursor","pointer"),r($,h(J,{get each(){return q()},children:u=>(()=>{var c=je(),v=c.firstChild,w=v.nextSibling;return w.nextSibling,r(c,()=>u.name,v),r(c,()=>u.rules_count,w),E(()=>c.value=u.name),c})()}),null),r($,h(N,{get when(){return q().length===0},get children(){return Ee()}}),null),r(o,h(N,{get when(){return V()},get children(){var u=Ye();return u.firstChild,r(u,h(J,{get each(){return q().filter(c=>c.name===V())},children:c=>(()=>{var v=De(),w=v.firstChild;w.firstChild;var L=w.nextSibling,U=L.firstChild,j=U.nextSibling;return j.nextSibling,r(w,()=>c.name,null),r(L,()=>c.rules_count,j),r(L,()=>c.loaded?"âœ… Loaded":"â³ Not Loaded",null),r(v,h(N,{get when(){return oe(()=>!!c.categories)()&&c.categories.length>0},get children(){var F=Je();return F.firstChild,r(F,()=>c.categories.join(", "),null),F}}),null),v})()}),null),u}}),G),E(u=>{var c=le(),v=ae()||!D.currentFile;return c!==u.e&&(p.disabled=u.e=c),v!==u.t&&(y.disabled=u.t=v),u},{e:void 0,t:void 0}),E(()=>$.value=V()),o}}),null),r(l,h(N,{get when(){return M()},get children(){return h(Q,{title:"Rule Testing & Validation",icon:"ğŸ”",className:"scrollable-panel",get children(){var o=Pe(),a=o.firstChild,p=a.firstChild,y=p.nextSibling,O=y.nextSibling,Z=O.nextSibling,$=Z.nextSibling,G=$.nextSibling,u=G.nextSibling,c=u.nextSibling,v=c.nextSibling,w=v.nextSibling,L=w.nextSibling,U=L.nextSibling,j=U.nextSibling,F=j.nextSibling,ke=F.nextSibling;return ke.nextSibling,r(a,()=>{var S;return(S=M())==null?void 0:S.compilation},G),r(a,()=>{var S;return(S=M())==null?void 0:S.performance},v),r(a,()=>{var S;return(S=M())==null?void 0:S.falsePositives},U),r(a,h(J,{get each(){return pe()},children:S=>(()=>{var K=Be(),Ce=K.firstChild,Ae=Ce.nextSibling;return r(K,S,Ae),K})()}),null),o}})}}),null),r(s,h(N,{get when(){return T().length>0},get fallback(){return He()},get children(){return h(J,{get each(){return T()},children:o=>(()=>{var a=qe(),p=a.firstChild;p.firstChild;var y=p.nextSibling;return p.$$click=()=>_e(o),r(p,()=>o.name,null),y.$$click=()=>xe(o.name),a})()})}})),r(g,()=>te()?"âœ… Scanner Ready":"â³ Initializing...",x),r(g,()=>ne()?"âœ… Rules Loaded":"â³ Loading...",I),r(g,()=>de()?"â³ Scanning...":"âœ… Ready",P),r(g,(()=>{var o=oe(()=>W().length>0);return()=>o()?W().length:"None"})(),null),r(n,h(N,{get when(){return re()},get children(){var o=Oe();return o.firstChild,r(o,re,null),o}}),null),t})()};ze(["input","click"]);export{Qe as default};
