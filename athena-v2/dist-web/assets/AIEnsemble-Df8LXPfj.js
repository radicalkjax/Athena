import{c as w,q as pe,t as $,i as n,m as h,a as F,S as N,F as be,b as U,g as H,d as fe}from"./vendor-solid-ZF9XUUOY.js";import{a as A}from"./index-C4Q2lgHl.js";import{a as he}from"./aiService-BcH-L2s_.js";var $e=$("<div class=ensemble-consensus style=margin-bottom:20px><div style=display:flex;justify-content:space-between;align-items:center;margin-bottom:10px><div class=consensus-score>% Consensus</div><div style=color:var(--success-color);font-weight:600>/<!> Providers Agreement</div></div><div style=color:var(--text-secondary)><strong>Final Classification:</strong> "),ye=$('<div class=content-panel><h2 style=color:var(--barbie-pink);margin-bottom:20px>ğŸ¤– AI Provider Ensemble Analysis</h2><div class=analysis-grid><div class=analysis-main><div class=analysis-panel><div class=panel-header><h3 class=panel-title><span aria-hidden=true>ğŸ§ </span>AI Provider Insights</h3></div><div class=panel-content><div style=display:grid;gap:15px></div></div></div></div><div class=ensemble-results><h3 style=color:var(--barbie-pink);margin-bottom:15px>ğŸ“Š Ensemble Metrics</h3><div class=stats-overview style=grid-template-columns:1fr><div class=stat-card><div class=stat-value></div><div class=stat-label>Final Confidence</div></div><div class=stat-card><div class=stat-value></div><div class=stat-label>Provider Agreement</div></div><div class=stat-card><div class=stat-value></div><div class=stat-label>Disagreements</div></div></div><h3 style="color:var(--barbie-pink);margin:20px 0 15px">ğŸ¯ Generated Artifacts</h3><div style=display:flex;flex-direction:column;gap:10px><button class="btn btn-primary">ğŸ“ Download YARA Rules</button><button class="btn btn-secondary">ğŸš¨ Export IOCs</button><button class="btn btn-secondary">ğŸ“Š Generate Report</button><button class="btn btn-secondary">ğŸ”„ '),xe=$('<div style="background:rgba(255, 107, 107, 0.1);border:1px solid var(--danger-color);padding:10px;border-radius:8px;margin-bottom:20px"><strong style=color:var(--danger-color)>Error:</strong> '),_e=$("<div style=text-align:center;padding:40px;color:var(--text-secondary)>"),Se=$('<div><h4> <!> - <!>% Confidence</h4><p style="color:var(--text-secondary);font-size:0.9rem;margin:0 0 8px 0"><strong>Threat Level:</strong> <!> |<strong>Family:</strong> <!> |<strong>Type:</strong> </p><p style="color:var(--text-secondary);font-size:0.85rem;margin:0 0 8px 0"><strong>Signatures:</strong> </p><p style=color:var(--text-secondary);font-size:0.85rem;margin:0><strong>Recommendations:</strong> ');const Re=()=>{const[R,E]=w(!1),[s,z]=w(null),[T]=w(["claude","gpt4","deepseek","gemini","mistral","llama"]),[P,y]=w(null),O=[{id:"claude",name:"Claude 3.5 Sonnet",icon:"ğŸ¤–",confidence:92},{id:"gpt4",name:"GPT-4 Turbo",icon:"ğŸ§ ",confidence:95},{id:"deepseek",name:"DeepSeek V3",icon:"ğŸ”",confidence:96},{id:"gemini",name:"Gemini Pro",icon:"ğŸŒŸ",confidence:97},{id:"mistral",name:"Claude 3 Opus",icon:"ğŸ’",confidence:93},{id:"llama",name:"GPT-4o",icon:"âš¡",confidence:94}];pe(()=>{A.currentFile&&s()&&(z(null),y(null))});const q=async()=>{const l=A.currentFile;if(!l){y("Please upload a file to analyze");return}E(!0),y(null);try{const i=await he.analyzeWithEnsemble({fileHash:l.hash,fileName:l.name,filePath:l.path,fileSize:l.size,fileType:l.type,analysisType:"comprehensive",providers:T(),priority:"high"},"voting"),a={id:`ensemble-${l.hash}-${Date.now()}`,fileHash:l.hash,timestamp:Date.now(),providers:T(),individualResults:i.individual,consensusResult:{confidence:i.consensus.confidence,threatLevel:i.consensus.threatLevel,malwareFamily:i.consensus.malwareFamily,malwareType:i.consensus.malwareType,aggregatedSignatures:i.consensus.signatures,aggregatedBehaviors:i.consensus.behaviors,aggregatedIocs:i.consensus.iocs,summary:`${i.consensus.malwareFamily||"Unknown"} - ${i.consensus.malwareType||"Suspicious"}`},disagreements:B(i.individual)};z(a),A.updateProgress({aiAnalysis:{status:"completed",progress:100,result:a.consensusResult}})}catch(i){y(i instanceof Error?i.message:"Analysis failed")}finally{E(!1)}},B=l=>{const i=[],a=["threatLevel","malwareFamily","malwareType"];for(const m of a){const u=new Map;if(l.forEach(v=>{const d=v[m]||"unknown",x=u.get(d)||[];x.push(v.provider),u.set(d,x)}),u.size>1)for(const[v,d]of u)d.length===1&&i.push({provider:d[0],field:m,value:v})}return i},V={claude:"#74b9ff",gpt4:"#fd79a8",deepseek:"#e17055",gemini:"#00b894",mistral:"#fdcb6e",llama:"#6c5ce7"};return(()=>{var l=ye(),i=l.firstChild,a=i.nextSibling,m=a.firstChild,u=m.firstChild,v=u.firstChild,d=v.nextSibling,x=d.firstChild,W=m.nextSibling,Y=W.firstChild,D=Y.nextSibling,G=D.firstChild,J=G.firstChild,I=G.nextSibling,K=I.firstChild,Q=I.nextSibling,X=Q.firstChild,Z=D.nextSibling,ee=Z.nextSibling,ne=ee.firstChild,ie=ne.nextSibling,se=ie.nextSibling,_=se.nextSibling;return _.firstChild,n(l,(()=>{var e=h(()=>!!P());return()=>e()&&(()=>{var t=xe(),o=t.firstChild;return o.nextSibling,n(t,P,null),t})()})(),a),n(l,F(N,{get when(){return s()},get children(){var e=$e(),t=e.firstChild,o=t.firstChild,c=o.firstChild,r=o.nextSibling,p=r.firstChild,b=p.nextSibling;b.nextSibling;var S=t.nextSibling,C=S.firstChild;return C.nextSibling,n(o,()=>Math.round(s().consensusResult.confidence*100),c),n(r,()=>s().individualResults.filter(g=>g.confidence>0).length,p),n(r,()=>s().providers.length,b),n(S,()=>s().consensusResult.summary,null),e}}),a),n(x,F(N,{get when(){return s()},get fallback(){return(()=>{var e=_e();return n(e,()=>R()?"Analyzing with AI providers...":'No analysis results yet. Click "Run Analysis" to start.'),e})()},get children(){return F(be,{get each(){return s().individualResults},children:e=>{const t=O.find(c=>c.id===e.provider),o=V[e.provider]||"#74b9ff";return(()=>{var c=Se(),r=c.firstChild,p=r.firstChild,b=p.nextSibling,S=b.nextSibling,C=S.nextSibling;C.nextSibling;var g=r.nextSibling,le=g.firstChild,te=le.nextSibling,L=te.nextSibling,re=L.nextSibling,ae=re.nextSibling,oe=ae.nextSibling,M=oe.nextSibling,de=M.nextSibling,ce=de.nextSibling;ce.nextSibling;var k=g.nextSibling,ge=k.firstChild;ge.nextSibling;var j=k.nextSibling,ue=j.firstChild;return ue.nextSibling,n(r,()=>t==null?void 0:t.icon,p),n(r,()=>t==null?void 0:t.name,b),n(r,()=>Math.round(e.confidence*100),C),n(g,()=>e.threatLevel,L),n(g,()=>e.malwareFamily||"Unknown",M),n(g,()=>e.malwareType||"Unknown",null),n(k,()=>e.signatures.slice(0,3).join(", ")||"None detected",null),n(j,()=>e.recommendations.slice(0,2).join(". "),null),U(f=>{var ve=`background: var(--code-bg); padding: 15px; border-radius: 6px; border-left: 4px solid ${o};`,me=`color: ${o}; margin-bottom: 8px;`;return f.e=H(c,ve,f.e),f.t=H(r,me,f.t),f},{e:void 0,t:void 0}),c})()}})}})),n(J,(()=>{var e=h(()=>!!s());return()=>e()?`${Math.round(s().consensusResult.confidence*100)}%`:"0%"})()),n(K,(()=>{var e=h(()=>!!s());return()=>e()?`${s().individualResults.filter(t=>t.confidence>0).length}/${s().providers.length}`:"0/0"})()),n(X,(()=>{var e=h(()=>!!(s()&&s().disagreements.length>0));return()=>e()?s().disagreements.length:"0"})()),_.$$click=q,n(_,(()=>{var e=h(()=>!!R());return()=>e()?"Analyzing...":s()?"Rerun Analysis":"Run Analysis"})(),null),U(()=>_.disabled=R()||!A.currentFile),l})()};fe(["click"]);export{Re as default};
