const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/StaticAnalysis-D1NmYBC0.js","assets/vendor-solid-B-ykKXyV.js","assets/vendor-BrNNPIVf.js","assets/StaticAnalysis-BMnaliMQ.css","assets/DynamicAnalysis-Cfqb2R9n.js","assets/HexEditor-D2TvzsUw.js","assets/HexEditor-BgHEe2i2.css","assets/DynamicAnalysis-Kj6pABaa.css","assets/AIEnsemble-QRSZTaaY.js","assets/AIEnsemble-Cm1q2XAq.css","assets/NetworkAnalysis-CMHO6HJw.js","assets/NetworkAnalysis-Bn1OLbCP.css","assets/HexViewer-BkYklpTk.js","assets/Disassembly-3UYq-bv0.js","assets/Disassembly-ChkSwURI.css","assets/Reports-CyeALEnQ.js","assets/Reports-oaRD7m8O.css","assets/YaraScanner-9DdkAb0R.js","assets/YaraScanner-BDSmFOUi.css","assets/ThreatIntelligence-Bvz0sVHh.js","assets/ThreatIntelligence-BDvRZooi.css","assets/MemoryAnalysis-DS0x-oSw.js","assets/MemoryAnalysis-Cwtw_LB-.css","assets/CustomWorkflows-DnrAj8fJ.js","assets/CustomWorkflows-itQy8O7i.css","assets/PlatformConfig-q1oqqsGD.js","assets/PlatformConfig-BGUEzjGV.css","assets/ContainerSandbox-CE1YE_z2.js","assets/ContainerSandbox-CUHlahLk.css"])))=>i.map(i=>d[i]);
var or=Object.defineProperty;var cr=(r,e,t)=>e in r?or(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var N=(r,e,t)=>cr(r,typeof e!="symbol"?e+"":e,t);import{c as $,o as Xe,t as b,s as dt,i as a,a as s,b as T,d as M,e as pt,F as ke,f as Ye,g as gt,h as Bt,m as Qe,S as V,E as dr,j as wt,k as ur,l as bt,n as le,p as se,r as pr}from"./vendor-solid-B-ykKXyV.js";import{i as gr}from"./vendor-BrNNPIVf.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const o of d.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(l){if(l.ep)return;l.ep=!0;const d=t(l);fetch(l.href,d)}})();const hr="modulepreload",mr=function(r){return"/"+r},Lt={},P=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(u){return Promise.all(u.map(v=>Promise.resolve(v).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),n=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));l=g(t.map(u=>{if(u=mr(u),u in Lt)return;Lt[u]=!0;const v=u.endsWith(".css"),f=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const y=document.createElement("link");if(y.rel=v?"stylesheet":hr,v||(y.as="script"),y.crossOrigin="",y.href=u,n&&y.setAttribute("nonce",n),document.head.appendChild(y),v)return new Promise((C,x)=>{y.addEventListener("load",C),y.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function d(o){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=o,window.dispatchEvent(n),!n.defaultPrevented)throw o}return l.then(o=>{for(const n of o||[])n.status==="rejected"&&d(n.reason);return e().catch(d)})},nt=()=>{try{return window.__TAURI__!==void 0}catch{return!1}},ee=async(r,e)=>{if(nt()){const{invoke:t}=await P(async()=>{const{invoke:i}=await import("./vendor-BrNNPIVf.js").then(l=>l.c);return{invoke:i}},[]);return t(r,e)}switch(r){case"calculate_sha256":if(e!=null&&e.bytes){const t=await crypto.subtle.digest("SHA-256",new Uint8Array(e.bytes));return Array.from(new Uint8Array(t)).map(l=>l.toString(16).padStart(2,"0")).join("")}return"";case"get_system_status":throw new Error("System monitoring is not available in web mode. Please use the desktop application.");case"analyze_file":throw new Error("File analysis requires the desktop application. Web mode does not support this feature.");default:throw new Error(`Command "${r}" is not available in web mode. Please use the desktop application.`)}},vr=async()=>{if(nt())try{const{open:r}=await P(async()=>{const{open:t}=await import("./vendor-BrNNPIVf.js").then(i=>i.a);return{open:t}},[]);return await r({multiple:!1,title:"Select Malware Sample"})}catch(r){throw console.error("Failed to open file dialog:",r),new Error(`File dialog failed: ${r}`)}return new Promise(r=>{const e=document.createElement("input");e.type="file",e.onchange=t=>{var l;const i=(l=t.target.files)==null?void 0:l[0];r(i?i.name:null)},e.click()})},yr="/assets/logo-DcWNyry6.png";var fr=b('<header class=header><div class=logo-section><div class=logo><img alt="Athena Platform Logo"></div><div><h1 class=logo-text>Athena Platform<span class=logo-separator>:</span><span class=platform-subtitle>AI-Powered Malware Analysis</span></h1></div></div><div class=status-indicator role=status aria-live=polite><div class=status-dot aria-hidden=true></div><span>AI Providers Ready â€¢ WASM Runtime Online â€¢ 6 Models Active');const br=()=>{const[r,e]=$({platform:"",version:"0.1.0",memory_usage:0});return Xe(async()=>{try{const t=await ee("get_system_status");e(t)}catch(t){console.error("Failed to get system status:",t)}}),(()=>{var t=fr(),i=t.firstChild,l=i.firstChild,d=l.firstChild;return dt(d,"src",yr),t})()};class _r{constructor(){N(this,"isDev",!1)}formatMessage(e,t){return`[${new Date().toISOString()}] [${e.toUpperCase()}] ${t}`}info(e,t){this.isDev&&console.log(this.formatMessage("info",e),t||""),this.sendToLoggingService({level:"info",message:e,data:t})}warn(e,t){this.isDev&&console.warn(this.formatMessage("warn",e),t||""),this.sendToLoggingService({level:"warn",message:e,data:t})}error(e,t){console.error(this.formatMessage("error",e),t||""),this.sendToLoggingService({level:"error",message:e,error:t}),this.sendToErrorTracking(e,t)}debug(e,t){this.isDev&&console.log(this.formatMessage("debug",e),t||"")}sendToLoggingService(e){const t={timestamp:new Date().toISOString(),level:e.level||"info",message:e.message||"",data:e.data,error:e.error};this.isDev||P(async()=>{const{invoke:i}=await import("./vendor-BrNNPIVf.js").then(l=>l.c);return{invoke:i}},[]).then(({invoke:i})=>{i("log_frontend_message",{level:t.level,message:t.message,data:t.data,timestamp:t.timestamp}).catch(()=>{})}).catch(()=>{})}sendToErrorTracking(e,t){!this.isDev&&t&&P(async()=>{const{invoke:i}=await import("./vendor-BrNNPIVf.js").then(l=>l.c);return{invoke:i}},[]).then(({invoke:i})=>{i("log_frontend_error",{message:e,error:(t==null?void 0:t.toString())||String(t),stack:t==null?void 0:t.stack,timestamp:new Date().toISOString()}).catch(()=>{})}).catch(()=>{})}}const S=new _r,xr={lazyLoading:{preloadDelay:150},virtualScrolling:{itemHeight:40,overscan:5,threshold:100}};class $r{constructor(){N(this,"preloadQueue",new Set);N(this,"preloadTimers",new Map);N(this,"loadedModules",new Map);N(this,"componentLoaders",{static:()=>P(()=>import("./StaticAnalysis-D1NmYBC0.js"),__vite__mapDeps([0,1,2,3])),dynamic:()=>P(()=>import("./DynamicAnalysis-Cfqb2R9n.js"),__vite__mapDeps([4,1,5,6,2,7])),"ai-ensemble":()=>P(()=>import("./AIEnsemble-QRSZTaaY.js"),__vite__mapDeps([8,1,2,9])),network:()=>P(()=>import("./NetworkAnalysis-CMHO6HJw.js"),__vite__mapDeps([10,1,2,11])),hex:()=>P(()=>import("./HexViewer-BkYklpTk.js"),__vite__mapDeps([12,1,5,6,2])),disassembly:()=>P(()=>import("./Disassembly-3UYq-bv0.js"),__vite__mapDeps([13,1,2,14])),reports:()=>P(()=>import("./Reports-CyeALEnQ.js"),__vite__mapDeps([15,1,2,16])),yara:()=>P(()=>import("./YaraScanner-9DdkAb0R.js"),__vite__mapDeps([17,1,2,18])),"threat-intel":()=>P(()=>import("./ThreatIntelligence-Bvz0sVHh.js"),__vite__mapDeps([19,1,2,20])),memory:()=>P(()=>import("./MemoryAnalysis-DS0x-oSw.js"),__vite__mapDeps([21,1,2,22])),workflows:()=>P(()=>import("./CustomWorkflows-DnrAj8fJ.js"),__vite__mapDeps([23,1,2,24])),"platform-config":()=>P(()=>import("./PlatformConfig-q1oqqsGD.js"),__vite__mapDeps([25,1,2,26]))})}preloadComponent(e){if(this.loadedModules.has(e)||this.preloadQueue.has(e))return;const t=this.preloadTimers.get(e);t&&clearTimeout(t);const i=setTimeout(()=>{this.doPreload(e)},xr.lazyLoading.preloadDelay);this.preloadTimers.set(e,i)}cancelPreload(e){const t=this.preloadTimers.get(e);t&&(clearTimeout(t),this.preloadTimers.delete(e))}async doPreload(e){const t=this.componentLoaders[e];if(t){this.preloadQueue.add(e),S.debug(`Preloading component: ${e}`);try{const i=await t();this.loadedModules.set(e,i),S.debug(`Successfully preloaded: ${e}`)}catch(i){S.error(`Failed to preload component ${e}:`,i)}finally{this.preloadQueue.delete(e),this.preloadTimers.delete(e)}}}isLoaded(e){return this.loadedModules.has(e)}getModule(e){return this.loadedModules.get(e)}async preloadCritical(){const e=["static","ai-ensemble","network"];S.info("Preloading critical components...");const t=e.map(i=>this.doPreload(i));await Promise.allSettled(t),S.info("Critical components preloaded")}clearCache(){this.loadedModules.clear(),this.preloadQueue.clear(),this.preloadTimers.forEach(e=>clearTimeout(e)),this.preloadTimers.clear(),S.info("Preload cache cleared")}}const qe=new $r;var wr=b("<div class=ensemble-status><div class=ensemble-header><span>ğŸ¤–</span>AI Ensemble Status</div><div class=agent-status-grid>"),Sr=b("<div class=agent-status><span></span><span>");const Dt=["claude","openai","deepseek","gemini","mistral","llama"],It={claude:{displayName:"Claude",model:"claude-3-opus"},openai:{displayName:"GPT",model:"gpt-4-turbo"},deepseek:{displayName:"DeepSeek",model:"deepseek-v2"},gemini:{displayName:"Gemini",model:"gemini-pro"},mistral:{displayName:"Mistral",model:"mistral-large"},llama:{displayName:"Llama",model:"llama-3-70b"}},kr=()=>{const[r,e]=$([]),t=async()=>{try{const l=await gr("get_ai_provider_status"),d=Dt.map(o=>{const n=l[o],g=It[o]??{displayName:o,model:"unknown"};let u="offline";return n&&n.configured&&n.enabled?n.healthy?n.queue_length>0?u="analyzing":n.circuit_state==="open"?u="error":u="ready":u="error":u="offline",{name:g.displayName,model:g.model,status:u,queueLength:n==null?void 0:n.queue_length,latency:n==null?void 0:n.avg_latency_ms}});e(d)}catch(l){console.error("Failed to fetch AI provider status:",l),r().length===0&&e(Dt.map(d=>{const o=It[d]??{displayName:d,model:"unknown"};return{name:o.displayName,model:o.model,status:"offline"}}))}};Xe(()=>{t();const l=setInterval(t,5e3);Ye(()=>clearInterval(l))});const i=l=>{switch(l){case"ready":return"var(--success-color)";case"analyzing":return"var(--warning-color)";case"error":return"var(--danger-color)";case"offline":return"var(--text-secondary)";default:return"var(--text-secondary)"}};return(()=>{var l=wr(),d=l.firstChild,o=d.nextSibling;return a(o,s(ke,{get each(){return r()},children:n=>(()=>{var g=Sr(),u=g.firstChild,v=u.nextSibling;return a(v,()=>n.name),T(f=>{var y=`agent-status-dot ${n.status==="analyzing"?"analyzing":""}`,C=`background-color: ${i(n.status)}`;return y!==f.e&&M(u,f.e=y),f.t=pt(u,C,f.t),f},{e:void 0,t:void 0}),g})()})),l})()};var Cr=b('<nav class=analysis-sidebar role=navigation aria-label="Analysis navigation"><div class=sidebar-header><span aria-hidden=true>ğŸ§°</span><h2>Malware Analysis Toolbox</h2></div><div class=sidebar-content><div class="priority-section critical-priority"><div class=priority-header><span aria-hidden=true>ğŸ¯</span><span>Core Analysis</span></div></div><div class="priority-section important-priority"><div class=priority-header><span aria-hidden=true>ğŸ”¬</span><span>Deep Inspection</span></div></div><div class="priority-section advanced-priority"><div class=priority-header><span aria-hidden=true>âš™ï¸</span><span>Automation & Config'),_t=b("<a href=#><span aria-hidden=true></span><span>");const Ar=r=>{const e=[{id:"upload",label:"Sample Upload",icon:"ğŸ“¤"},{id:"static",label:"Static Analysis",icon:"ğŸ”"},{id:"dynamic",label:"Dynamic Analysis",icon:"âš¡"},{id:"ai-ensemble",label:"AI Provider Ensemble",icon:"ğŸ¤–"},{id:"threat-intel",label:"Threat Intelligence",icon:"ğŸš¨"},{id:"reports",label:"Analysis Reports",icon:"ğŸ“Š"}],t=[{id:"hex",label:"Hex Editor",icon:"ğŸ”¢"},{id:"disassembly",label:"Disassembly",icon:"âš™ï¸"},{id:"network",label:"Network Analysis",icon:"ğŸŒ"},{id:"memory",label:"Memory Analysis",icon:"ğŸ§ "},{id:"container",label:"Container Sandbox",icon:"ğŸ³"}],i=[{id:"workflows",label:"Custom Workflows",icon:"ğŸ”—"},{id:"yara",label:"YARA Rules",icon:"ğŸ“"},{id:"platform-config",label:"Platform Config",icon:"ğŸ› ï¸"}];return(()=>{var l=Cr(),d=l.firstChild,o=d.nextSibling,n=o.firstChild;n.firstChild;var g=n.nextSibling;g.firstChild;var u=g.nextSibling;return u.firstChild,a(n,s(ke,{each:e,children:v=>(()=>{var f=_t(),y=f.firstChild,C=y.nextSibling;return f.addEventListener("mouseleave",()=>qe.cancelPreload(v.id)),f.addEventListener("mouseenter",()=>qe.preloadComponent(v.id)),f.$$click=x=>{x.preventDefault(),r.onPanelChange(v.id)},a(y,()=>v.icon),a(C,()=>v.label),T(x=>{var O=`sidebar-item ${r.activePanel===v.id?"active":""}`,R=v.id;return O!==x.e&&M(f,x.e=O),R!==x.t&&dt(f,"data-tab",x.t=R),x},{e:void 0,t:void 0}),f})()}),null),a(g,s(ke,{each:t,children:v=>(()=>{var f=_t(),y=f.firstChild,C=y.nextSibling;return f.addEventListener("mouseleave",()=>qe.cancelPreload(v.id)),f.addEventListener("mouseenter",()=>qe.preloadComponent(v.id)),f.$$click=x=>{x.preventDefault(),r.onPanelChange(v.id)},a(y,()=>v.icon),a(C,()=>v.label),T(x=>{var O=`sidebar-item ${r.activePanel===v.id?"active":""}`,R=v.id;return O!==x.e&&M(f,x.e=O),R!==x.t&&dt(f,"data-tab",x.t=R),x},{e:void 0,t:void 0}),f})()}),null),a(u,s(ke,{each:i,children:v=>(()=>{var f=_t(),y=f.firstChild,C=y.nextSibling;return f.addEventListener("mouseleave",()=>qe.cancelPreload(v.id)),f.addEventListener("mouseenter",()=>qe.preloadComponent(v.id)),f.$$click=x=>{x.preventDefault(),r.onPanelChange(v.id)},a(y,()=>v.icon),a(C,()=>v.label),T(x=>{var O=`sidebar-item ${r.activePanel===v.id?"active":""}`,R=v.id;return O!==x.e&&M(f,x.e=O),R!==x.t&&dt(f,"data-tab",x.t=R),x},{e:void 0,t:void 0}),f})()}),null),a(l,s(kr,{}),null),l})()};gt(["click"]);const[Z,E]=Bt({files:[],activeFileId:null,isAnalyzing:!1,uploadedFile:void 0}),ut={state:Z,files:()=>Z.files,get currentFile(){return Z.currentFile},get analysisProgress(){return Z.analysisProgress},addFile(r){const e={...r,id:crypto.randomUUID(),uploadedAt:new Date,status:"pending"};return E("files",t=>[...t,e]),E("uploadedFile",e),E("currentFile",e),e.id},setActiveFile(r){E("activeFileId",r);const e=Z.files.find(t=>t.id===r);e&&E("currentFile",e)},updateFileStatus(r,e){E("files",t=>t.id===r,"status",e)},setAnalysisResults(r,e){E("files",t=>t.id===r,"results",e)},startAnalysis(r){E("isAnalyzing",!0),this.updateFileStatus(r,"analyzing")},completeAnalysis(r,e){this.setAnalysisResults(r,e),this.updateFileStatus(r,"completed"),E("isAnalyzing",!1)},updateProgress(r){E("analysisProgress",e=>({...e,...r}))},updateStreamingResults(r){E("streamingResults",r)},deleteFile(r){var t,i,l,d;const e=Z.files.findIndex(o=>o.id===r);if(e!==-1){if(E("files",o=>o.filter(n=>n.id!==r)),Z.activeFileId===r)if(Z.files.length>1){const o=e>0?Z.files[e-1]:Z.files[0];o&&o.id!==r?(E("activeFileId",o.id),E("currentFile",o)):(E("activeFileId",null),E("currentFile",void 0))}else E("activeFileId",null),E("currentFile",void 0);((t=Z.uploadedFile)==null?void 0:t.id)===r&&E("uploadedFile",void 0),((i=Z.currentFile)==null?void 0:i.id)===r&&E("currentFile",void 0),((l=Z.currentFile)==null?void 0:l.id)===r&&Z.isAnalyzing&&(E("analysisProgress",void 0),E("isAnalyzing",!1)),(d=Z.streamingResults)!=null&&d[r]&&E("streamingResults",o=>{if(!o)return o;const n={...o};return delete n[r],Object.keys(n).length>0?n:void 0})}},clearAllFiles(){E("files",[]),E("activeFileId",null),E("uploadedFile",void 0),E("currentFile",void 0),E("analysisProgress",void 0),E("streamingResults",void 0),E("isAnalyzing",!1)}},Ue=class Ue{constructor(){N(this,"allocations",new Map);N(this,"totalLimit",500*1024*1024);N(this,"warningThreshold",.7);N(this,"criticalThreshold",.9);N(this,"cleanupCallbacks",new Map);N(this,"pressureCallbacks",new Set);this.startMemoryMonitoring()}static getInstance(){return Ue.instance||(Ue.instance=new Ue),Ue.instance}allocate(e,t,i,l,d){const o=this.getTotalAllocated();if(o+t>this.totalLimit){const g=this.runGarbageCollection(t);if(o-g+t>this.totalLimit)return console.error(`Memory allocation failed: Requested ${t} bytes would exceed limit`),!1}const n={id:e,size:t,type:i,timestamp:Date.now(),description:l};return this.allocations.set(e,n),d&&this.cleanupCallbacks.set(e,d),this.checkMemoryPressure(),!0}deallocate(e){if(!this.allocations.get(e))return!1;const i=this.cleanupCallbacks.get(e);if(i){try{i()}catch(l){console.error(`Error during cleanup for ${e}:`,l)}this.cleanupCallbacks.delete(e)}return this.allocations.delete(e),this.checkMemoryPressure(),!0}getTotalAllocated(){let e=0;for(const t of this.allocations.values())e+=t.size;return e}getStats(){const e=this.getTotalAllocated(),t=this.calculatePressure(e);return{totalAllocated:e,totalLimit:this.totalLimit,allocations:new Map(this.allocations),pressure:t}}calculatePressure(e){const t=e/this.totalLimit;return t>=this.criticalThreshold?"critical":t>=this.warningThreshold?"high":t>=.5?"medium":"low"}runGarbageCollection(e){let t=0;const i=Date.now(),l=300*1e3,d=Array.from(this.allocations.entries()).sort((o,n)=>o[1].timestamp-n[1].timestamp);for(const[o,n]of d)if(!(n.type==="wasm"||n.type==="analysis")&&(n.type==="cache"&&i-n.timestamp>l&&this.deallocate(o)&&(t+=n.size,console.log(`GC: Freed ${n.size} bytes from ${o}`)),t>=e))break;if(t<e){for(const[o,n]of d)if(n.type==="file"&&i-n.timestamp>l/2&&this.deallocate(o)&&(t+=n.size,console.log(`GC: Freed ${n.size} bytes from ${o}`)),t>=e)break}return t}checkMemoryPressure(){const e=this.getStats();for(const t of this.pressureCallbacks)try{t(e.pressure)}catch(i){console.error("Error in pressure callback:",i)}}onPressureChange(e){return this.pressureCallbacks.add(e),()=>this.pressureCallbacks.delete(e)}startMemoryMonitoring(){setInterval(()=>{this.checkMemoryPressure();const e=this.getStats();if(e.pressure==="critical"||e.pressure==="high"){const t=this.totalLimit*.3;this.runGarbageCollection(t)}},5e3)}setMemoryLimit(e){this.totalLimit=e*1024*1024,this.checkMemoryPressure()}getAllocationsByType(e){const t=[];for(const i of this.allocations.values())i.type===e&&t.push(i);return t}clearType(e){let t=0;const i=[];for(const[l,d]of this.allocations)d.type===e&&(i.push(l),t+=d.size);for(const l of i)this.deallocate(l);return t}static formatBytes(e){if(e===0)return"0 B";const t=1024,i=["B","KB","MB","GB"],l=Math.floor(Math.log(e)/Math.log(t));return`${(e/Math.pow(t,l)).toFixed(2)} ${i[l]}`}};N(Ue,"instance");let $t=Ue;const Er=$t.getInstance();var Tr=b("<div class=stat-card><div class=stat-value></div><div class=stat-label>");const ct=r=>(()=>{var e=Tr(),t=e.firstChild,i=t.nextSibling;return a(t,()=>r.value),a(i,()=>r.label),e})();var Pr=b("<div><div class=panel-header><h3 class=panel-title><span></span> </h3></div><div class=panel-content>"),Fr=b("<div class=panel-actions>");const Mt=r=>(()=>{var e=Pr(),t=e.firstChild,i=t.firstChild,l=i.firstChild;l.nextSibling;var d=t.nextSibling;return a(l,()=>r.icon),a(i,()=>r.title,null),a(t,(()=>{var o=Qe(()=>!!r.actions);return()=>o()&&(()=>{var n=Fr();return a(n,()=>r.actions),n})()})(),null),a(d,()=>r.children),T(o=>{var n=`analysis-panel ${r.className||""}`,g=r.style;return n!==o.e&&M(e,o.e=n),o.t=pt(e,g,o.t),o},{e:void 0,t:void 0}),e})();var zr=b('<div class=error-message style="color:var(--danger-color);margin-top:10px;padding:10px;background:rgba(255, 0, 0, 0.1);border-radius:4px">âŒ '),Lr=b('<div style="color:var(--success-color);margin-top:10px;padding:10px;background:rgba(0, 255, 0, 0.1);border-radius:4px">âœ… '),Dr=b("<div class=upload-progress style=margin-top:20px><p>Uploading file... <!>%</p><div class=progress-bar style=width:100%;height:6px;background:var(--accent-bg);border-radius:3px;overflow:hidden;position:relative><div class=progress-fill>"),Ir=b("<p style=color:var(--text-secondary);text-align:center;padding:20px>No samples found. Upload your first sample above."),Mr=b('<div style="margin-top:20px;padding:20px;background:var(--panel-bg);border-radius:8px;border:1px solid var(--border-color)"><h3 style="margin:0 0 15px 0;color:var(--text-primary)">ğŸ“š All Samples (<!>)</h3><div style=max-height:400px;overflow-y:auto>'),Or=b('<button class="btn btn-secondary"style="font-size:0.75rem;padding:4px 8px">Edit Tags'),Rr=b('<div style=display:flex;gap:8px><input type=text placeholder="Enter tag name..."style="flex:1;padding:8px;background:var(--accent-bg);color:var(--text-primary);border:1px solid var(--border-color);border-radius:4px"><button class="btn btn-primary"style="padding:8px 16px">Add</button><button class="btn btn-secondary"style="padding:8px 16px">Done'),Br=b('<button class="btn btn-secondary"style="font-size:0.75rem;padding:4px 8px">Edit Notes'),Ur=b(`<div><textarea placeholder="Add analysis notes..."rows=4 style="width:100%;padding:8px;background:var(--accent-bg);color:var(--text-primary);border:1px solid var(--border-color);border-radius:4px;font-family:'JetBrains Mono', monospace;font-size:0.85rem;resize:vertical"></textarea><div style=display:flex;gap:8px;margin-top:8px><button class="btn btn-primary"style="padding:8px 16px">Save Notes</button><button class="btn btn-secondary"style="padding:8px 16px">Cancel`),Nr=b(`<div style="padding:10px;background:var(--accent-bg);border-radius:4px;font-family:'JetBrains Mono', monospace;font-size:0.85rem;color:var(--text-primary);white-space:pre-wrap;min-height:60px">`),Vr=b(`<div style="margin-top:20px;padding:20px;background:var(--panel-bg);border-radius:8px;border:1px solid var(--barbie-pink)"><div style=display:flex;justify-content:space-between;align-items:center;margin-bottom:15px><h3 style=margin:0;color:var(--text-primary)>ğŸ” Sample Details</h3><button class="btn btn-secondary"style="font-size:0.8rem;padding:6px 12px">Close</button></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:20px"><div><label style=color:var(--text-secondary);font-size:0.85rem>Filename:</label><div style=color:var(--text-primary);font-weight:500;margin-top:4px></div></div><div><label style=color:var(--text-secondary);font-size:0.85rem>File Type:</label><div style=color:var(--text-primary);margin-top:4px></div></div><div><label style=color:var(--text-secondary);font-size:0.85rem>Size:</label><div style="color:var(--text-primary);font-family:'JetBrains Mono', monospace;margin-top:4px"></div></div><div><label style=color:var(--text-secondary);font-size:0.85rem>Status:</label><div style=color:var(--text-primary);margin-top:4px></div></div><div><label style=color:var(--text-secondary);font-size:0.85rem>First Seen:</label><div style=color:var(--text-primary);font-size:0.85rem;margin-top:4px></div></div><div><label style=color:var(--text-secondary);font-size:0.85rem>Analysis Count:</label><div style=color:var(--text-primary);margin-top:4px> times</div></div></div><div style=margin-bottom:15px><label style=color:var(--text-secondary);font-size:0.85rem;margin-bottom:8px;display:block>SHA256:</label><div style="font-family:'JetBrains Mono', monospace;font-size:0.8rem;color:var(--text-primary);background:var(--accent-bg);padding:8px;border-radius:4px;word-break:break-all"></div></div><div style=margin-bottom:15px><div style=display:flex;justify-content:space-between;align-items:center;margin-bottom:8px><label style=color:var(--text-secondary);font-size:0.85rem>Tags:</label></div><div style=display:flex;flex-wrap:wrap;gap:8px;margin-bottom:8px></div></div><div><div style=display:flex;justify-content:space-between;align-items:center;margin-bottom:8px><label style=color:var(--text-secondary);font-size:0.85rem>Notes:`),Hr=b('<div style="margin-top:30px;padding:20px;background:var(--panel-bg);border-radius:8px;border:1px solid var(--border-color)"><div style=display:flex;justify-content:space-between;align-items:center;margin-bottom:15px><h3 style=margin:0;color:var(--text-primary)>ğŸ“¦ Staged Samples (<!>)</h3><div style=display:flex;gap:10px><button class="btn btn-secondary"style="font-size:0.85rem;padding:6px 12px">Select All</button><button class="btn btn-secondary"style="font-size:0.85rem;padding:6px 12px">Deselect</button></div></div><div style=max-height:300px;overflow-y:auto><table style=width:100%;border-collapse:collapse><thead><tr style="border-bottom:1px solid var(--border-color)"><th style=padding:10px;text-align:left;width:40px></th><th style=padding:10px;text-align:left>Filename</th><th style=padding:10px;text-align:left>Type</th><th style=padding:10px;text-align:left>Tags</th><th style=padding:10px;text-align:right>Size</th><th style=padding:10px;text-align:left>Uploaded</th></tr></thead><tbody></tbody></table></div><div style="display:flex;gap:15px;margin-top:20px;padding-top:15px;border-top:1px solid var(--border-color)"><button class="btn btn-primary"style=flex:1></button><button class="btn btn-danger"style="padding:10px 20px">ğŸ—‘ï¸ Delete'),Wr=b('<div style=padding:20px><h4 style="margin:0 0 15px 0;font-size:0.9rem;color:var(--text-primary)">Analysis Types</h4><div style=display:flex;flex-direction:column;gap:12px;margin-bottom:20px><label style=display:flex;align-items:center;gap:8px;cursor:pointer><input type=checkbox style=accent-color:var(--barbie-pink)><span style=color:var(--text-primary)>Static Analysis (File properties, hashes, entropy)</span></label><label style=display:flex;align-items:center;gap:8px;cursor:pointer><input type=checkbox style=accent-color:var(--barbie-pink)><span style=color:var(--text-primary)>Dynamic Analysis (CAPE Sandbox)</span></label><label style=display:flex;align-items:center;gap:8px;cursor:pointer><input type=checkbox style=accent-color:var(--barbie-pink)><span style=color:var(--text-primary)>AI Provider Ensemble (All 6 Models)</span></label><label style=display:flex;align-items:center;gap:8px;cursor:pointer><input type=checkbox style=accent-color:var(--barbie-pink)><span style=color:var(--text-primary)>Advanced Reverse Engineering</span></label></div><h4 style="margin:20px 0 15px 0;font-size:0.9rem;color:var(--text-primary)">Sandbox Environment</h4><div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px"><div><label style=color:var(--text-secondary);font-size:0.85rem>Target OS:</label><select style="width:100%;padding:8px;margin-top:5px;background:var(--accent-bg);color:var(--text-primary);border:1px solid var(--border-color);border-radius:4px"><option value=linux>Linux</option><option value=macos>macOS</option><option value=windows>Windows</option></select></div><div><label style=color:var(--text-secondary);font-size:0.85rem>Architecture:</label><select style="width:100%;padding:8px;margin-top:5px;background:var(--accent-bg);color:var(--text-primary);border:1px solid var(--border-color);border-radius:4px"><option value=x86_64>x86-64 (AMD64)</option><option value=arm64>ARM64 (Apple Silicon)</option></select></div></div><div style=margin-bottom:15px><label style=color:var(--text-secondary);font-size:0.85rem>Container Image:</label><select style="width:100%;padding:8px;margin-top:5px;background:var(--accent-bg);color:var(--text-primary);border:1px solid var(--border-color);border-radius:4px"></select></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px"><div><label style=color:var(--text-secondary);font-size:0.85rem>Timeout (seconds):</label><input type=number min=30 max=600 style="width:100%;padding:8px;margin-top:5px;background:var(--accent-bg);color:var(--text-primary);border:1px solid var(--border-color);border-radius:4px"></div><div><label style=color:var(--text-secondary);font-size:0.85rem>Memory (MB):</label><input type=number min=128 max=4096 step=128 style="width:100%;padding:8px;margin-top:5px;background:var(--accent-bg);color:var(--text-primary);border:1px solid var(--border-color);border-radius:4px"></div></div><div style=margin-bottom:15px><label style=color:var(--text-secondary);font-size:0.85rem>CPU Limit (cores):</label><input type=range min=0.25 max=4 step=0.25 style=width:100%;margin-top:5px><span style=color:var(--text-primary);font-size:0.85rem> cores</span></div><div style=display:flex;flex-direction:column;gap:8px;margin-bottom:15px><label style=display:flex;align-items:center;gap:8px;cursor:pointer><input type=checkbox style=accent-color:var(--barbie-pink)><span style=color:var(--text-primary);font-size:0.9rem>Capture Network Traffic (PCAP)</span></label></div><div style=padding:10px;background:var(--accent-bg);border-radius:4px;font-size:0.85rem><div style=color:var(--info-color)><strong>Config:</strong> <!> (<!>) Â· <!> Â· <!>MB Â· <!>s'),Gr=b("<div class=stats-overview style=grid-template-columns:1fr;padding:20px>"),jr=b('<div class=content-panel style=padding:40px;background:transparent><h2 style=color:var(--barbie-pink);margin-bottom:30px;font-size:1.5rem;font-weight:500>ğŸ“¤ Upload Malware Sample</h2><div role=button tabindex=0 aria-label="Click to select file or drag and drop"><div class=upload-icon aria-hidden=true>ğŸ“¤</div><h3>Upload Malware Sample for Analysis</h3><p style="color:var(--text-secondary);margin:15px 0">Drag and drop files here or click to browse<br>Supports: PE, ELF, Mach-O, Office docs, PDFs, APKs, Archives<br><strong>Files are staged securely until you start analysis</strong></p><button class="btn btn-primary">Choose Files</button></div><div style=margin-top:30px><button class="btn btn-secondary"style=width:100%;display:flex;justify-content:space-between;align-items:center><span></span><span></span></button></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:30px">'),Kr=b(`<div style="padding:15px;margin-bottom:10px;background:var(--accent-bg);border-radius:6px;border:1px solid var(--border-color);cursor:pointer;transition:all 0.2s"><div style=display:flex;justify-content:space-between;align-items:start;margin-bottom:8px><div style=flex:1><div style=font-weight:500;color:var(--text-primary);margin-bottom:4px></div><div style="font-family:'JetBrains Mono', monospace;font-size:0.75rem;color:var(--text-secondary)">SHA256: <!>...</div></div><div style=text-align:right><span style="padding:4px 8px;background:var(--panel-bg);border-radius:4px;font-size:0.8rem;color:var(--text-primary)"></span><div style=font-size:0.75rem;color:var(--text-secondary);margin-top:4px></div></div></div><div style=display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px></div><div style=display:flex;justify-content:space-between;align-items:center;font-size:0.75rem;color:var(--text-secondary)><span>Status: </span><span></span></div><div style=margin-top:10px;display:flex;gap:8px><button class="btn btn-primary"style="flex:1;font-size:0.8rem;padding:6px 12px">Re-analyze</button><button class="btn btn-secondary"style="font-size:0.8rem;padding:6px 12px">Details`),Jr=b('<span style="padding:2px 8px;background:var(--barbie-pink);color:white;border-radius:12px;font-size:0.75rem">'),qr=b("<button style=background:none;border:none;color:white;cursor:pointer;padding:0;font-size:1rem;line-height:1>Ã—"),Qr=b('<span style="padding:4px 12px;background:var(--barbie-pink);color:white;border-radius:12px;font-size:0.85rem;display:flex;align-items:center;gap:6px">'),Yr=b(`<tr><td style=padding:10px><input type=checkbox style=accent-color:var(--barbie-pink)></td><td style="padding:10px;font-family:'JetBrains Mono', monospace;font-size:0.9rem"><br><span style=font-size:0.75rem;color:var(--text-secondary)>...</span></td><td style=padding:10px><span style="padding:2px 8px;background:var(--accent-bg);border-radius:4px;font-size:0.85rem"></span></td><td style=padding:10px><div style=display:flex;gap:4px;flex-wrap:wrap><button class="btn btn-secondary"style="font-size:0.7rem;padding:2px 6px;border-radius:10px">+</button></div></td><td style="padding:10px;text-align:right;font-family:'JetBrains Mono', monospace"></td><td style=padding:10px;font-size:0.85rem;color:var(--text-secondary)>`),Xr=b('<span style="padding:2px 6px;background:var(--barbie-pink);color:white;border-radius:10px;font-size:0.7rem">'),Zr=b("<span style=color:var(--danger-color);font-size:0.75rem;margin-left:10px>(Docker not available)"),ea=b("<span style=color:var(--success-color);font-size:0.75rem;margin-left:10px>(Docker ready)"),ta=b("<option>");const ra=()=>{const[r,e]=$(!1),[t,i]=$(!1),[l,d]=$(null),[o,n]=$(null),[g,u]=$(null),[v,f]=$([]),[y,C]=$(new Set),[x,O]=$(!1),[R,H]=$(null),[w,W]=$({staticAnalysis:!0,dynamicAnalysis:!0,aiEnsemble:!0,reverseEngineering:!1,sandboxOS:"linux",sandboxArch:"x86_64",sandboxImage:"ubuntu:22.04",sandboxTimeout:120,sandboxMemory:512,sandboxCPU:1,captureNetwork:!0}),[fe,G]=$({samples_analyzed_today:0,avg_analysis_time_ms:0,ai_provider_accuracy:0}),[ue,h]=$(null),[A,Ze]=$(null),[Ne,lt]=$([]),[ze,et]=$(!1),[Ve,Le]=$(null),[He,De]=$(""),[We,Ie]=$(null),[tt,Me]=$(""),Nt=()=>{const c=w().sandboxOS;return c==="linux"?[{value:"ubuntu:22.04",label:"Ubuntu 22.04 LTS (Recommended)"},{value:"ubuntu:20.04",label:"Ubuntu 20.04 LTS"},{value:"debian:12",label:"Debian 12 (Bookworm)"},{value:"alpine:latest",label:"Alpine Linux (Minimal)"},{value:"fedora:39",label:"Fedora 39"},{value:"athena-sandbox:latest",label:"Athena Sandbox (Full Monitoring)"}]:c==="windows"?[{value:"mcr.microsoft.com/windows/servercore:ltsc2022",label:"Windows Server 2022 Core"},{value:"mcr.microsoft.com/windows/servercore:ltsc2019",label:"Windows Server 2019 Core"},{value:"athena-sandbox-windows:latest",label:"Athena Windows Sandbox"}]:[{value:"macos-sonoma:14",label:"macOS Sonoma 14 (Recommended)"},{value:"macos-ventura:13",label:"macOS Ventura 13"},{value:"macos-monterey:12",label:"macOS Monterey 12"},{value:"athena-sandbox-macos:latest",label:"Athena macOS Sandbox"}]},Vt=async()=>{try{const c=await ee("check_docker_available");H(c)}catch(c){console.warn("Docker check failed:",c),H(!1)}};let ht=null;const st=async()=>{try{const c=await ee("get_analysis_stats");G(c)}catch(c){console.warn("Failed to fetch analysis stats:",c)}},Oe=async()=>{try{const c=await ee("list_staged_samples");f(c)}catch(c){console.warn("Failed to fetch staged samples:",c)}},mt=async()=>{try{const c=await ee("list_all_samples");lt(c)}catch(c){console.warn("Failed to fetch all samples:",c)}},rt=async c=>{try{const m=await ee("get_sample_metadata",{sha256:c});Ze(m),h(c)}catch(m){d(`Failed to load sample details: ${m}`)}},kt=async(c,m)=>{try{await ee("update_sample_tags",{sha256:c,tags:m}),Le(null),De(""),await Oe(),await mt(),ue()===c&&await rt(c),n("Tags updated successfully"),setTimeout(()=>n(null),3e3)}catch(_){d(`Failed to update tags: ${_}`)}},Ht=async(c,m)=>{try{await ee("update_sample_notes",{sha256:c,notes:m}),Ie(null),Me(""),ue()===c&&await rt(c),n("Notes updated successfully"),setTimeout(()=>n(null),3e3)}catch(_){d(`Failed to update notes: ${_}`)}};Xe(async()=>{await Promise.all([st(),Oe(),mt(),Vt()]);const c=setInterval(st,3e4),m=setInterval(Oe,1e4),_=setInterval(mt,3e4);if(nt())try{const{listen:k}=window.__TAURI__.event;ht=await k("upload-progress",Q=>{u(Q.payload),Q.payload.status==="completed"&&(setTimeout(()=>u(null),1e3),st(),Oe())})}catch(k){console.warn("Tauri event API not available:",k)}Ye(()=>{clearInterval(c),clearInterval(m),clearInterval(_)})}),Ye(()=>{ht&&ht()});const Wt=async()=>{try{if(nt()){const c=await vr();c&&typeof c=="string"&&await vt(c)}else{const c=document.createElement("input");c.type="file",c.onchange=async m=>{var k;const _=(k=m.target.files)==null?void 0:k[0];_&&await ot(_)},c.click()}}catch(c){d(`Failed to select file: ${c}`)}},ot=async c=>{i(!0),d(null),n(null);try{const m=await c.arrayBuffer(),_=Array.from(new Uint8Array(m)),k=await ee("create_temp_file",{fileName:c.name,bytes:_});if(k)await vt(k,c.name);else throw new Error("Failed to create temporary file")}catch(m){d(`Failed to upload file: ${m}`)}finally{i(!1)}},vt=async(c,m)=>{i(!0),d(null),n(null);try{const _=await ee("register_sample",{filePath:c,originalFilename:m||null});_.is_duplicate?n(`Sample already exists: ${_.file_type} (${at(_.size)})`):n(`Sample registered: ${_.file_type} (${at(_.size)})`),await Oe(),setTimeout(()=>n(null),5e3)}catch(_){d(`Failed to register sample: ${_}`)}finally{i(!1)}},Gt=async()=>{const c=Array.from(y());if(c.length===0){d("No samples selected for analysis");return}O(!0),d(null);try{const m=w();for(const _ of c){const k=await ee("start_sample_analysis",{sha256:_}),Q=await ee("analyze_file",{filePath:k,config:{static_analysis:m.staticAnalysis,dynamic_analysis:m.dynamicAnalysis,ai_ensemble:m.aiEnsemble,reverse_engineering:m.reverseEngineering,sandbox_os:m.sandboxOS,sandbox_arch:m.sandboxArch,sandbox_image:m.sandboxImage,sandbox_timeout:m.sandboxTimeout,sandbox_memory:m.sandboxMemory,sandbox_cpu:m.sandboxCPU,capture_network:m.captureNetwork}});await ee("complete_sample_analysis",{sha256:_});const oe=v().find(Ce=>Ce.sha256===_);if(oe&&Q){ut.addFile({name:oe.original_filename,path:k,size:oe.size,hash:_,type:oe.mime_type,analysisResult:Q});const Ce=`file_${_}`;Er.allocate(Ce,oe.size,"file",`File: ${oe.original_filename}`,()=>S.debug(`Memory freed for file ${oe.original_filename}`)),window.dispatchEvent(new CustomEvent("file-analyzed",{detail:{filePath:k,result:Q}}))}}C(new Set),await Oe(),await st(),n(`Analysis complete for ${c.length} sample(s)`),setTimeout(()=>n(null),5e3)}catch(m){d(`Analysis failed: ${m}`)}finally{O(!1)}},jt=async()=>{const c=Array.from(y());if(c.length!==0)try{for(const m of c)await ee("delete_staged_sample",{sha256:m});C(new Set),await Oe(),n(`Deleted ${c.length} sample(s)`),setTimeout(()=>n(null),3e3)}catch(m){d(`Failed to delete samples: ${m}`)}},Ct=c=>{C(m=>{const _=new Set(m);return _.has(c)?_.delete(c):_.add(c),_})},Kt=()=>{const c=v().map(m=>m.sha256);C(new Set(c))},Jt=()=>{C(new Set)},at=c=>c<1024?`${c} B`:c<1024*1024?`${(c/1024).toFixed(1)} KB`:`${(c/1024/1024).toFixed(2)} MB`,yt=c=>new Date(c).toLocaleString(),qt=c=>{c.preventDefault(),e(!0)},Qt=()=>{e(!1)},Yt=async c=>{var _;c.preventDefault(),e(!1);const m=(_=c.dataTransfer)==null?void 0:_.files;if(m&&m.length>0){const k=m[0];if(!k)return;if(nt())try{const Q=await k.arrayBuffer(),oe=Array.from(new Uint8Array(Q)),Ce=await ee("create_temp_file",{fileName:k.name,bytes:oe});Ce?await vt(Ce,k.name):await ot(k)}catch(Q){S.warn("Failed to handle Tauri file drop, falling back to web method",Q),await ot(k)}else await ot(k)}},At=(c,m)=>{const _=He().trim();if(_&&!m.includes(_)){const k=[...m,_];kt(c,k)}},Xt=(c,m,_)=>{const k=m.filter(Q=>Q!==_);kt(c,k)},Zt=async c=>{try{C(new Set([c])),et(!1),n(`Sample ${c.substring(0,16)}... ready for re-analysis`),setTimeout(()=>n(null),3e3)}catch(m){d(`Failed to prepare sample for re-analysis: ${m}`)}};return(()=>{var c=jr(),m=c.firstChild,_=m.nextSibling,k=_.nextSibling,Q=k.firstChild,oe=Q.firstChild,Ce=oe.nextSibling,it=k.nextSibling;return _.addEventListener("drop",Yt),_.addEventListener("dragleave",Qt),_.addEventListener("dragover",qt),_.$$click=Wt,a(c,s(V,{get when(){return l()},get children(){var F=zr();return F.firstChild,a(F,l,null),F}}),k),a(c,s(V,{get when(){return o()},get children(){var F=Lr();return F.firstChild,a(F,o,null),F}}),k),a(c,s(V,{get when(){return t()},get children(){var F=Dr(),Y=F.firstChild,ce=Y.firstChild,de=ce.nextSibling;de.nextSibling;var ae=Y.nextSibling,B=ae.firstChild;return a(Y,()=>{var U,J;return((J=(U=g())==null?void 0:U.percentage)==null?void 0:J.toFixed(1))||0},de),T(U=>{var J;return pt(B,`width: ${((J=g())==null?void 0:J.percentage)||0}%; height: 100%; background: var(--barbie-pink); transition: width 0.3s ease;`,U)}),F}}),k),Q.$$click=()=>et(!ze()),a(oe,()=>ze()?"ğŸ“¦ Hide Sample History":"ğŸ“š Show Sample History"),a(Ce,()=>ze()?"â–¼":"â–¶"),a(c,s(V,{get when(){return ze()},get children(){var F=Mr(),Y=F.firstChild,ce=Y.firstChild,de=ce.nextSibling;de.nextSibling;var ae=Y.nextSibling;return a(Y,()=>Ne().length,de),a(ae,s(V,{get when(){return Ne().length===0},get children(){return Ir()}}),null),a(ae,s(ke,{get each(){return Ne()},children:B=>(()=>{var U=Kr(),J=U.firstChild,pe=J.firstChild,Ae=pe.firstChild,be=Ae.nextSibling,ge=be.firstChild,_e=ge.nextSibling;_e.nextSibling;var he=pe.nextSibling,ve=he.firstChild,z=ve.nextSibling,te=J.nextSibling,ie=te.nextSibling,X=ie.firstChild;X.firstChild;var ye=X.nextSibling,Ee=ie.nextSibling,me=Ee.firstChild,xe=me.nextSibling;return U.addEventListener("mouseleave",j=>j.currentTarget.style.borderColor="var(--border-color)"),U.addEventListener("mouseenter",j=>j.currentTarget.style.borderColor="var(--barbie-pink)"),U.$$click=()=>rt(B.sha256),a(Ae,()=>B.original_filename),a(be,()=>B.sha256.substring(0,16),_e),a(ve,()=>B.file_type),a(z,()=>at(B.size)),a(te,s(ke,{get each(){return B.tags},children:j=>(()=>{var $e=Jr();return a($e,j),$e})()})),a(X,()=>B.status,null),a(ye,()=>yt(B.uploaded_at)),me.$$click=j=>{j.stopPropagation(),Zt(B.sha256)},xe.$$click=j=>{j.stopPropagation(),rt(B.sha256)},U})()}),null),F}}),it),a(c,s(V,{get when(){return A()!==null},get children(){var F=Vr(),Y=F.firstChild,ce=Y.firstChild,de=ce.nextSibling,ae=Y.nextSibling,B=ae.firstChild,U=B.firstChild,J=U.nextSibling,pe=B.nextSibling,Ae=pe.firstChild,be=Ae.nextSibling,ge=pe.nextSibling,_e=ge.firstChild,he=_e.nextSibling,ve=ge.nextSibling,z=ve.firstChild,te=z.nextSibling,ie=ve.nextSibling,X=ie.firstChild,ye=X.nextSibling,Ee=ie.nextSibling,me=Ee.firstChild,xe=me.nextSibling,j=xe.firstChild,$e=ae.nextSibling,Re=$e.firstChild,Ge=Re.nextSibling,Te=$e.nextSibling,we=Te.firstChild;we.firstChild;var je=we.nextSibling,ne=Te.nextSibling,Se=ne.firstChild;return Se.firstChild,de.$$click=()=>{Ze(null),h(null),Le(null),Ie(null)},a(J,()=>{var p;return(p=A())==null?void 0:p.original_filename}),a(be,()=>{var p;return(p=A())==null?void 0:p.mime_type}),a(he,()=>{var p;return at(((p=A())==null?void 0:p.size)||0)}),a(te,()=>{var p;return(p=A())==null?void 0:p.status}),a(ye,(()=>{var p=Qe(()=>!!A());return()=>p()?yt(A().uploaded_at):""})()),a(xe,()=>{var p;return((p=A())==null?void 0:p.analysis_count)||0},j),a(Ge,()=>{var p;return(p=A())==null?void 0:p.sha256}),a(we,s(V,{get when(){var p;return Ve()!==((p=A())==null?void 0:p.sha256)},get children(){var p=Or();return p.$$click=()=>{var I;Le(((I=A())==null?void 0:I.sha256)||null),De("")},p}}),null),a(je,s(ke,{get each(){var p;return((p=A())==null?void 0:p.tags)||[]},children:p=>(()=>{var I=Qr();return a(I,p,null),a(I,s(V,{get when(){var K;return Ve()===((K=A())==null?void 0:K.sha256)},get children(){var K=qr();return K.$$click=()=>Xt(A().sha256,A().tags,p),K}}),null),I})()})),a(Te,s(V,{get when(){var p;return Ve()===((p=A())==null?void 0:p.sha256)},get children(){var p=Rr(),I=p.firstChild,K=I.nextSibling,Ke=K.nextSibling;return I.addEventListener("keypress",Pe=>{Pe.key==="Enter"&&At(A().sha256,A().tags)}),I.$$input=Pe=>De(Pe.currentTarget.value),K.$$click=()=>At(A().sha256,A().tags),Ke.$$click=()=>{Le(null),De("")},T(()=>K.disabled=!He().trim()),T(()=>I.value=He()),p}}),null),a(Se,s(V,{get when(){var p;return We()!==((p=A())==null?void 0:p.sha256)},get children(){var p=Br();return p.$$click=()=>{var I,K;Ie(((I=A())==null?void 0:I.sha256)||null),Me(((K=A())==null?void 0:K.notes)||"")},p}}),null),a(ne,s(V,{get when(){var p;return We()===((p=A())==null?void 0:p.sha256)},get children(){var p=Ur(),I=p.firstChild,K=I.nextSibling,Ke=K.firstChild,Pe=Ke.nextSibling;return I.$$input=ft=>Me(ft.currentTarget.value),Ke.$$click=()=>Ht(A().sha256,tt()||null),Pe.$$click=()=>{Ie(null),Me("")},T(()=>I.value=tt()),p}}),null),a(ne,s(V,{get when(){var p;return We()!==((p=A())==null?void 0:p.sha256)},get children(){var p=Nr();return a(p,()=>{var I;return((I=A())==null?void 0:I.notes)||"No notes added yet."}),p}}),null),F}}),it),a(c,s(V,{get when(){return v().length>0},get children(){var F=Hr(),Y=F.firstChild,ce=Y.firstChild,de=ce.firstChild,ae=de.nextSibling;ae.nextSibling;var B=ce.nextSibling,U=B.firstChild,J=U.nextSibling,pe=Y.nextSibling,Ae=pe.firstChild,be=Ae.firstChild,ge=be.nextSibling,_e=pe.nextSibling,he=_e.firstChild,ve=he.nextSibling;return a(ce,()=>v().length,ae),U.$$click=Kt,J.$$click=Jt,a(ge,s(ke,{get each(){return v()},children:z=>(()=>{var te=Yr(),ie=te.firstChild,X=ie.firstChild,ye=ie.nextSibling,Ee=ye.firstChild,me=Ee.nextSibling,xe=me.firstChild,j=ye.nextSibling,$e=j.firstChild,Re=j.nextSibling,Ge=Re.firstChild,Te=Ge.firstChild,we=Re.nextSibling,je=we.nextSibling;return te.$$click=()=>Ct(z.sha256),X.addEventListener("change",()=>Ct(z.sha256)),X.$$click=ne=>ne.stopPropagation(),a(ye,()=>z.original_filename,Ee),a(me,()=>z.sha256.substring(0,16),xe),a($e,()=>z.file_type),a(Ge,s(ke,{get each(){return z.tags},children:ne=>(()=>{var Se=Xr();return a(Se,ne),Se})()}),Te),Te.$$click=ne=>{ne.stopPropagation(),rt(z.sha256)},a(we,()=>at(z.size)),a(je,()=>yt(z.uploaded_at)),T(ne=>pt(te,`border-bottom: 1px solid var(--border-color); cursor: pointer; ${y().has(z.sha256)?"background: rgba(255, 105, 180, 0.1);":""}`,ne)),T(()=>X.checked=y().has(z.sha256)),te})()})),he.$$click=Gt,a(he,(()=>{var z=Qe(()=>!!x());return()=>z()?"â³ Analyzing...":`ğŸ”¬ Start Analysis (${y().size} selected)`})()),ve.$$click=jt,T(z=>{var te=y().size===0,ie=y().size===0||x(),X=y().size===0;return te!==z.e&&(J.disabled=z.e=te),ie!==z.t&&(he.disabled=z.t=ie),X!==z.a&&(ve.disabled=z.a=X),z},{e:void 0,t:void 0,a:void 0}),F}}),it),a(it,s(Mt,{title:"Analysis Configuration",icon:"âš™ï¸",get children(){var F=Wr(),Y=F.firstChild,ce=Y.nextSibling,de=ce.firstChild,ae=de.firstChild,B=de.nextSibling,U=B.firstChild,J=B.nextSibling,pe=J.firstChild,Ae=J.nextSibling,be=Ae.firstChild,ge=ce.nextSibling;ge.firstChild;var _e=ge.nextSibling,he=_e.firstChild,ve=he.firstChild,z=ve.nextSibling,te=he.nextSibling,ie=te.firstChild,X=ie.nextSibling,ye=_e.nextSibling,Ee=ye.firstChild,me=Ee.nextSibling,xe=ye.nextSibling,j=xe.firstChild,$e=j.firstChild,Re=$e.nextSibling,Ge=j.nextSibling,Te=Ge.firstChild,we=Te.nextSibling,je=xe.nextSibling,ne=je.firstChild,Se=ne.nextSibling,p=Se.nextSibling,I=p.firstChild,K=je.nextSibling,Ke=K.firstChild,Pe=Ke.firstChild,ft=K.nextSibling,Je=ft.firstChild,er=Je.firstChild,tr=er.nextSibling,Et=tr.nextSibling,rr=Et.nextSibling,Tt=rr.nextSibling,ar=Tt.nextSibling,Pt=ar.nextSibling,ir=Pt.nextSibling,Ft=ir.nextSibling,nr=Ft.nextSibling,zt=nr.nextSibling;return zt.nextSibling,ae.addEventListener("change",L=>W(D=>({...D,staticAnalysis:L.currentTarget.checked}))),U.addEventListener("change",L=>W(D=>({...D,dynamicAnalysis:L.currentTarget.checked}))),pe.addEventListener("change",L=>W(D=>({...D,aiEnsemble:L.currentTarget.checked}))),be.addEventListener("change",L=>W(D=>({...D,reverseEngineering:L.currentTarget.checked}))),a(ge,(()=>{var L=Qe(()=>R()===!1);return()=>L()&&Zr()})(),null),a(ge,(()=>{var L=Qe(()=>R()===!0);return()=>L()&&ea()})(),null),z.addEventListener("change",L=>{const D=L.currentTarget.value,lr={linux:"ubuntu:22.04",windows:"mcr.microsoft.com/windows/servercore:ltsc2022",macos:"macos-sonoma:14"};W(sr=>({...sr,sandboxOS:D,sandboxImage:lr[D]||"ubuntu:22.04"}))}),X.addEventListener("change",L=>W(D=>({...D,sandboxArch:L.currentTarget.value}))),me.addEventListener("change",L=>W(D=>({...D,sandboxImage:L.currentTarget.value}))),a(me,()=>Nt().map(L=>(()=>{var D=ta();return a(D,()=>L.label),T(()=>D.value=L.value),D})())),Re.addEventListener("change",L=>W(D=>({...D,sandboxTimeout:parseInt(L.currentTarget.value)||120}))),we.addEventListener("change",L=>W(D=>({...D,sandboxMemory:parseInt(L.currentTarget.value)||512}))),Se.addEventListener("change",L=>W(D=>({...D,sandboxCPU:parseFloat(L.currentTarget.value)||1}))),a(p,()=>w().sandboxCPU,I),Pe.addEventListener("change",L=>W(D=>({...D,captureNetwork:L.currentTarget.checked}))),a(Je,()=>w().sandboxOS.toUpperCase(),Et),a(Je,()=>w().sandboxArch,Tt),a(Je,()=>w().sandboxImage.split(":")[0],Pt),a(Je,()=>w().sandboxMemory,Ft),a(Je,()=>w().sandboxTimeout,zt),T(()=>ae.checked=w().staticAnalysis),T(()=>U.checked=w().dynamicAnalysis),T(()=>pe.checked=w().aiEnsemble),T(()=>be.checked=w().reverseEngineering),T(()=>z.value=w().sandboxOS),T(()=>X.value=w().sandboxArch),T(()=>me.value=w().sandboxImage),T(()=>Re.value=w().sandboxTimeout),T(()=>we.value=w().sandboxMemory),T(()=>Se.value=w().sandboxCPU),T(()=>Pe.checked=w().captureNetwork),F}}),null),a(it,s(Mt,{title:"Quick Stats",icon:"ğŸ“Š",get children(){var F=Gr();return a(F,s(ct,{get value(){return fe().samples_analyzed_today.toLocaleString()},label:"Samples Analyzed Today"}),null),a(F,s(ct,{get value(){return`${fe().ai_provider_accuracy.toFixed(1)}%`},label:"AI Provider Accuracy"}),null),a(F,s(ct,{get value(){return`${(fe().avg_analysis_time_ms/1e3).toFixed(1)}s`},label:"Avg Analysis Time"}),null),a(F,s(ct,{get value(){return v().length.toString()},label:"Samples Staged"}),null),F}}),null),T(()=>M(_,`upload-area ${r()?"dragging":""}`)),c})()};gt(["click","input"]);var aa=b("<div class=error-boundary-fallback><div class=error-icon>âš ï¸</div><h2>Something went wrong</h2><p class=error-message></p><div class=error-actions><button class=btn-error-reset>Try Again</button><button class=btn-error-details> Details"),ia=b("<div class=error-details><h3>Error Details</h3><pre>"),na=b("<div class=wasm-error-fallback><div class=error-icon>ğŸš€</div><h2>WASM Error</h2><p class=error-message></p><button class=btn-error-reset>Retry Operation"),la=b("<div class=error-hint><p>This appears to be a memory-related error.</p><p>Try clearing some memory by closing unused modules or clearing the cache."),sa=b("<div class=error-hint><p>Failed to load or execute WASM module.</p><p>The module may be corrupted or incompatible."),oa=b("<div class=analysis-error-fallback><div class=error-icon>ğŸ”</div><h2>Analysis Error</h2><p>Failed to complete the analysis operation.</p><p class=error-message></p><div class=error-suggestions><h3>Suggestions:</h3><ul><li>Check if the file is valid and not corrupted</li><li>Ensure you have sufficient memory available</li><li>Try analyzing a smaller file</li></ul></div><button class=btn-error-reset>Try Again");const ca=r=>{const[e,t]=$(!1);return(()=>{var i=aa(),l=i.firstChild,d=l.nextSibling,o=d.nextSibling,n=o.nextSibling,g=n.firstChild,u=g.nextSibling,v=u.firstChild;return a(o,()=>r.error.message||"An unexpected error occurred"),wt(g,"click",r.reset),u.$$click=()=>t(!e()),a(u,()=>e()?"Hide":"Show",v),a(i,(()=>{var f=Qe(()=>!!e());return()=>f()&&(()=>{var y=ia(),C=y.firstChild,x=C.nextSibling;return a(x,()=>r.error.stack||r.error.toString()),y})()})(),null),i})()},St=r=>{const[e,t]=$([]),[i,l]=$(0),d=(g,u)=>{S.error("Error caught by boundary:",{error:g,errorInfo:u});const v={error:g,timestamp:new Date,componentStack:u==null?void 0:u.componentStack,retryCount:i()};t(f=>[...f,v]),r.onError&&r.onError(g,u),window.performanceMonitor&&window.performanceMonitor.recordMetric("error_boundary_triggered",1,"count")},o=()=>{l(g=>g+1),t([])},n=r.fallbackComponent||ca;return s(dr,{fallback:(g,u)=>(d(g,{componentStack:""}),s(n,{error:g,reset:()=>{o(),u()}})),get children(){return r.children}})},Ot=r=>s(St,{fallbackComponent:t=>{const i=t.error.message.toLowerCase().includes("memory"),l=t.error.message.toLowerCase().includes("module");return(()=>{var d=na(),o=d.firstChild,n=o.nextSibling,g=n.nextSibling,u=g.nextSibling;return a(d,i&&la(),g),a(d,l&&sa(),g),a(g,()=>t.error.message),wt(u,"click",t.reset),d})()},onError:t=>{S.error("WASM Error:",t)},get children(){return r.children}}),Fe=r=>s(St,{fallbackComponent:t=>(()=>{var i=oa(),l=i.firstChild,d=l.nextSibling,o=d.nextSibling,n=o.nextSibling,g=n.nextSibling,u=g.nextSibling;return a(n,()=>t.error.message),wt(u,"click",t.reset),i})(),onError:t=>{S.error("Analysis Error:",t)},get children(){return r.children}});gt(["click"]);const da=ur(),ua=r=>{const[e,t]=$(null),[i,l]=Bt([]),[d,o]=$(null),[n,g]=$(!1),[u,v]=$(new Set(["static","dynamic","ai"])),[f,y]=$("ensemble"),[C,x]=$(new Set(["openai","claude","deepseek"])),O=G=>{l([...i,G])},R=(G,ue)=>{l(i.map(h=>h.id===G?{...h,...ue}:h))},H=()=>{l([])},w=G=>{const ue=u(),h=new Set(ue);h.has(G)?h.delete(G):h.add(G),v(h)},W=G=>{const ue=C(),h=new Set(ue);h.has(G)?h.delete(G):h.add(G),x(h)},fe={currentFile:e(),setCurrentFile:t,results:i,addResult:O,updateResult:R,clearResults:H,progress:d(),setProgress:o,isAnalyzing:n(),setIsAnalyzing:g,selectedAnalyses:u(),toggleAnalysis:w,ensembleMode:f(),setEnsembleMode:y,selectedProviders:C(),toggleProvider:W};return s(da.Provider,{value:fe,get children(){return r.children}})};class pa{constructor(){N(this,"shortcuts",new Map);N(this,"enabled",!0);N(this,"handleKeyDown",e=>{if(!this.enabled)return;const t=e.target;if(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable)return;const i=this.generateKey(e),l=this.shortcuts.get(i);l&&(e.preventDefault(),e.stopPropagation(),l.handler())});this.initializeDefaultShortcuts()}initializeDefaultShortcuts(){this.register({key:"o",ctrl:!0,handler:()=>this.triggerFileOpen(),description:"Open file"}),this.register({key:"s",ctrl:!0,handler:()=>this.triggerSave(),description:"Save current analysis"}),this.register({key:"e",ctrl:!0,shift:!0,handler:()=>this.triggerExport(),description:"Export analysis"}),this.register({key:"1",alt:!0,handler:()=>this.navigateToTab("static"),description:"Go to Static Analysis"}),this.register({key:"2",alt:!0,handler:()=>this.navigateToTab("dynamic"),description:"Go to Dynamic Analysis"}),this.register({key:"3",alt:!0,handler:()=>this.navigateToTab("network"),description:"Go to Network Analysis"}),this.register({key:"4",alt:!0,handler:()=>this.navigateToTab("ai"),description:"Go to AI Analysis"}),this.register({key:"r",ctrl:!0,handler:()=>this.refreshAnalysis(),description:"Refresh analysis"}),this.register({key:"Escape",handler:()=>this.closeModals(),description:"Close modal/dialog"}),this.register({key:"f",ctrl:!0,handler:()=>this.focusSearch(),description:"Focus search"}),this.register({key:"?",shift:!0,handler:()=>this.showShortcutHelp(),description:"Show keyboard shortcuts"})}generateKey(e){const t=[];return e.ctrlKey&&t.push("ctrl"),e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.metaKey&&t.push("meta"),t.push(e.key.toLowerCase()),t.join("+")}register(e){const t=this.generateKeyFromShortcut(e);this.shortcuts.set(t,e)}unregister(e){const t=this.generateKeyFromShortcut(e);this.shortcuts.delete(t)}generateKeyFromShortcut(e){const t=[];return e.ctrl&&t.push("ctrl"),e.shift&&t.push("shift"),e.alt&&t.push("alt"),e.meta&&t.push("meta"),t.push(e.key.toLowerCase()),t.join("+")}enable(){this.enabled=!0}disable(){this.enabled=!1}triggerFileOpen(){const e=document.querySelector("#file-upload-input");e==null||e.click()}triggerSave(){window.dispatchEvent(new CustomEvent("save-analysis"))}triggerExport(){window.dispatchEvent(new CustomEvent("export-analysis"))}navigateToTab(e){window.dispatchEvent(new CustomEvent("navigate-tab",{detail:{tab:e}}))}refreshAnalysis(){window.dispatchEvent(new CustomEvent("refresh-analysis"))}closeModals(){window.dispatchEvent(new CustomEvent("close-modals"))}focusSearch(){const e=document.querySelector(".search-input");e==null||e.focus()}showShortcutHelp(){window.dispatchEvent(new CustomEvent("show-shortcut-help"))}getShortcuts(){return Array.from(this.shortcuts.values())}}const xt=new pa;function ga(){return Xe(()=>{window.addEventListener("keydown",xt.handleKeyDown)}),Ye(()=>{window.removeEventListener("keydown",xt.handleKeyDown)}),xt}var ha=b("<div class=loading-spinner>"),ma=b("<p class=loading-message>"),va=b("<div><div class=loading-content>");const re=r=>{const t={small:20,medium:40,large:60}[r.size||"medium"];return(()=>{var i=ha();return bt(i,"width",`${t}px`),bt(i,"height",`${t}px`),T(l=>bt(i,"border-color",r.color||"var(--barbie-pink)")),i})()},ya=r=>(()=>{var e=va(),t=e.firstChild;return a(t,s(re,{size:"large"}),null),a(t,s(V,{get when(){return r.message},get children(){var i=ma();return a(i,()=>r.message),i}}),null),T(()=>M(e,`loading-overlay ${r.transparent?"transparent":""}`)),e})(),q={baseUrl:"http://localhost:3000",endpoints:{health:"/api/v1/health",analyze:"/api/v1/analyze",providers:"/api/v1/providers",workflows:"/api/v1/workflows",upload:"/api/v1/analysis/upload",status:"/api/v1/analysis/:id/status",results:"/api/v1/analysis/:id/results",batch:"/api/v1/analysis/batch",wasm:"/api/v1/wasm/analyze"},requestConfig:{timeout:3e4,headers:{"Content-Type":"application/json"},credentials:"include"},retryConfig:{maxRetries:3,retryDelay:1e3,backoffMultiplier:2}};function Ut(r,e){let t=`${q.baseUrl}${r}`;return e&&Object.entries(e).forEach(([i,l])=>{t=t.replace(`:${i}`,l)}),t}async function Be(r,e={},t){const i=Ut(r,t),l={...q.requestConfig,...e,headers:{...q.requestConfig.headers,...e.headers||{}}};let d=null;for(let o=0;o<=q.retryConfig.maxRetries;o++)try{const n=await fetch(i,l);if(!n.ok)throw new Error(`API request failed: ${n.status} ${n.statusText}`);return await n.json()}catch(n){if(d=n,o<q.retryConfig.maxRetries){const g=q.retryConfig.retryDelay*Math.pow(q.retryConfig.backoffMultiplier,o);await new Promise(u=>setTimeout(u,g))}}throw d||new Error("API request failed")}class fa{constructor(){N(this,"isConnected",!1);N(this,"healthCheckInterval",null)}async initialize(){S.info("Initializing backend service");try{await this.checkHealth(),this.startHealthMonitoring(),S.info("Backend service initialized successfully")}catch(e){throw S.error("Failed to initialize backend service:",e),e}}async checkHealth(){try{const e=await Be(q.endpoints.health);return this.isConnected=e.status==="healthy",e}catch(e){throw this.isConnected=!1,S.error("Health check failed:",e),e}}startHealthMonitoring(){this.healthCheckInterval&&clearInterval(this.healthCheckInterval),this.healthCheckInterval=window.setInterval(async()=>{try{await this.checkHealth()}catch(e){S.warn("Health check failed during monitoring:",e)}},3e4)}stopHealthMonitoring(){this.healthCheckInterval&&(clearInterval(this.healthCheckInterval),this.healthCheckInterval=null)}getConnectionStatus(){return this.isConnected}async analyzeContent(e){S.info("Analyzing content",{providerId:e.providerId});try{const t=await Be(q.endpoints.analyze,{method:"POST",body:JSON.stringify(e)});return S.info("Content analysis completed",{success:t.success}),t}catch(t){throw S.error("Content analysis failed:",t),t}}async uploadFile(e){S.info("Uploading file for analysis",{fileName:e.file.name,fileSize:e.file.size});try{const t=new FormData;t.append("file",e.file),e.analysisTypes&&t.append("analysisTypes",JSON.stringify(e.analysisTypes));const i=await fetch(Ut(q.endpoints.upload),{method:"POST",body:t,credentials:q.requestConfig.credentials});if(!i.ok)throw new Error(`Upload failed: ${i.status} ${i.statusText}`);const l=await i.json();return S.info("File upload completed",{analysisId:l.analysisId}),l}catch(t){throw S.error("File upload failed:",t),t}}async getAnalysisStatus(e){S.debug("Getting analysis status",{analysisId:e});try{return await Be(q.endpoints.status,{method:"GET"},{id:e})}catch(t){throw S.error("Failed to get analysis status:",t),t}}async getAnalysisResults(e){S.debug("Getting analysis results",{analysisId:e});try{return await Be(q.endpoints.results,{method:"GET"},{id:e})}catch(t){throw S.error("Failed to get analysis results:",t),t}}async getProviders(){S.debug("Getting AI providers");try{return await Be(q.endpoints.providers,{method:"GET"})}catch(e){throw S.error("Failed to get providers:",e),e}}async executeWorkflow(e,t,i){S.info("Executing workflow",{agentId:e,workflowName:t});try{const l=`${q.endpoints.workflows}/${e}/${t}/execute`;return await Be(l,{method:"POST",body:JSON.stringify(i)})}catch(l){throw S.error("Workflow execution failed:",l),l}}async analyzeWithWasm(e){S.info("Analyzing with WASM modules");try{return await Be(q.endpoints.wasm,{method:"POST",body:JSON.stringify(e)})}catch(t){throw S.error("WASM analysis failed:",t),t}}}const ba=new fa;var _a=b("<div class=status-error>âš ï¸ "),xa=b("<div class=status-details><div class=service-status><span>API: </span><span>Cache: </span><span>WASM: "),$a=b("<div><div class=status-indicator><span></span><span class=status-text>Backend: ");const wa=()=>{const[r,e]=$(!1),[t,i]=$(null),[l,d]=$(null);let o=null;const n=async()=>{try{const g=await ba.checkHealth();e(!0),i(g),d(null),S.info("Backend status checked:",g)}catch(g){e(!1);const u=g instanceof Error?g.message:"Failed to connect to backend";d(u),S.error("Backend connection failed:",g)}};return Xe(async()=>{await n(),o=window.setInterval(n,1e4)}),Ye(()=>{o&&clearInterval(o)}),(()=>{var g=$a(),u=g.firstChild,v=u.firstChild,f=v.nextSibling;return f.firstChild,a(f,()=>r()?"Connected":"Disconnected",null),a(g,s(V,{get when(){return l()},get children(){var y=_a();return y.firstChild,a(y,l,null),y}}),null),a(g,s(V,{get when(){return t()},get children(){var y=xa(),C=y.firstChild,x=C.firstChild;x.firstChild;var O=x.nextSibling;O.firstChild;var R=O.nextSibling;return R.firstChild,a(x,()=>{var H,w;return((w=(H=t())==null?void 0:H.services)==null?void 0:w.api)||"unknown"},null),a(O,()=>{var H,w;return((w=(H=t())==null?void 0:H.services)==null?void 0:w.cache)||"unknown"},null),a(R,()=>{var H,w;return((w=(H=t())==null?void 0:H.services)==null?void 0:w.wasm)||"unknown"},null),y}}),null),T(y=>{var C=`backend-status ${r()?"connected":"disconnected"}`,x=`status-dot ${r()?"online":"offline"}`;return C!==y.e&&M(g,y.e=C),x!==y.t&&M(v,y.t=x),y},{e:void 0,t:void 0}),g})()};var Sa=b("<div class=global-error-banner><span>âš ï¸ </span><button>âœ•"),ka=b("<div class=app-container><div class=main-content><main class=analysis-area id=main-content role=main><div class=content-panels><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div>");const Ca=se(()=>P(()=>import("./StaticAnalysis-D1NmYBC0.js"),__vite__mapDeps([0,1,2,3]))),Aa=se(()=>P(()=>import("./DynamicAnalysis-Cfqb2R9n.js"),__vite__mapDeps([4,1,5,6,2,7]))),Ea=se(()=>P(()=>import("./AIEnsemble-QRSZTaaY.js"),__vite__mapDeps([8,1,2,9]))),Ta=se(()=>P(()=>import("./Reports-CyeALEnQ.js"),__vite__mapDeps([15,1,2,16]))),Pa=se(()=>P(()=>import("./HexViewer-BkYklpTk.js"),__vite__mapDeps([12,1,5,6,2]))),Fa=se(()=>P(()=>import("./NetworkAnalysis-CMHO6HJw.js"),__vite__mapDeps([10,1,2,11]))),za=se(()=>P(()=>import("./Disassembly-3UYq-bv0.js"),__vite__mapDeps([13,1,2,14]))),La=se(()=>P(()=>import("./YaraScanner-9DdkAb0R.js"),__vite__mapDeps([17,1,2,18]))),Da=se(()=>P(()=>import("./ThreatIntelligence-Bvz0sVHh.js"),__vite__mapDeps([19,1,2,20]))),Ia=se(()=>P(()=>import("./MemoryAnalysis-DS0x-oSw.js"),__vite__mapDeps([21,1,2,22]))),Ma=se(()=>P(()=>import("./CustomWorkflows-DnrAj8fJ.js"),__vite__mapDeps([23,1,2,24]))),Oa=se(()=>P(()=>import("./PlatformConfig-q1oqqsGD.js"),__vite__mapDeps([25,1,2,26]))),Ra=se(()=>P(()=>import("./ContainerSandbox-CE1YE_z2.js"),__vite__mapDeps([27,1,2,28]))),Ba=()=>{const[r,e]=$("upload"),[t]=$(!1),[i,l]=$(null);return ga(),Xe(()=>{const d=n=>{const u={static:"static",dynamic:"dynamic",network:"network",ai:"ai-ensemble"}[n.detail.tab];u&&e(u)},o=n=>{console.error("Global error:",n.error),l(n.message),setTimeout(()=>l(null),5e3)};window.addEventListener("navigate-tab",d),window.addEventListener("error",o),Ye(()=>{window.removeEventListener("navigate-tab",d),window.removeEventListener("error",o)})}),s(St,{get children(){return s(ua,{get children(){return[s(V,{get when(){return t()},get children(){return s(ya,{message:"Loading Athena Security Platform..."})}}),s(V,{get when(){return i()},get children(){var d=Sa(),o=d.firstChild;o.firstChild;var n=o.nextSibling;return a(o,i,null),n.$$click=()=>l(null),d}}),(()=>{var d=ka(),o=d.firstChild,n=o.firstChild,g=n.firstChild,u=g.firstChild,v=u.nextSibling,f=v.nextSibling,y=f.nextSibling,C=y.nextSibling,x=C.nextSibling,O=x.nextSibling,R=O.nextSibling,H=R.nextSibling,w=H.nextSibling,W=w.nextSibling,fe=W.nextSibling,G=fe.nextSibling,ue=G.nextSibling;return a(d,s(br,{}),o),a(o,s(Ar,{get activePanel(){return r()},onPanelChange:e}),n),a(u,s(Fe,{get children(){return s(ra,{})}})),a(v,s(Fe,{get children(){return s(le,{get fallback(){return s(re,{})},get children(){return s(Ca,{})}})}})),a(f,s(Ot,{get children(){return s(le,{get fallback(){return s(re,{})},get children(){return s(Aa,{})}})}})),a(y,s(Fe,{get children(){return s(le,{get fallback(){return s(re,{})},get children(){return s(Ea,{})}})}})),a(C,s(Fe,{get children(){return s(le,{get fallback(){return s(re,{})},get children(){return s(Da,{})}})}})),a(x,s(le,{get fallback(){return s(re,{})},get children(){return s(Ta,{})}})),a(O,s(le,{get fallback(){return s(re,{})},get children(){return s(Pa,{get filePath(){var h;return(h=ut.state.uploadedFile)==null?void 0:h.path}})}})),a(R,s(Fe,{get children(){return s(le,{get fallback(){return s(re,{})},get children(){return s(Fa,{get filePath(){var h;return(h=ut.state.uploadedFile)==null?void 0:h.path}})}})}})),a(H,s(Fe,{get children(){return s(le,{get fallback(){return s(re,{})},get children(){return s(za,{get filePath(){var h;return(h=ut.state.uploadedFile)==null?void 0:h.path}})}})}})),a(w,s(Ot,{get children(){return s(le,{get fallback(){return s(re,{})},get children(){return s(Ia,{})}})}})),a(W,s(Fe,{get children(){return s(le,{get fallback(){return s(re,{})},get children(){return s(Ra,{})}})}})),a(fe,s(le,{get fallback(){return s(re,{})},get children(){return s(Ma,{})}})),a(G,s(Fe,{get children(){return s(le,{get fallback(){return s(re,{})},get children(){return s(La,{})}})}})),a(ue,s(le,{get fallback(){return s(re,{})},get children(){return s(Oa,{})}})),T(h=>{var A=`content-panel-container ${r()==="upload"?"active":""}`,Ze=`content-panel-container ${r()==="static"?"active":""}`,Ne=`content-panel-container ${r()==="dynamic"?"active":""}`,lt=`content-panel-container ${r()==="ai-ensemble"?"active":""}`,ze=`content-panel-container ${r()==="threat-intel"?"active":""}`,et=`content-panel-container ${r()==="reports"?"active":""}`,Ve=`content-panel-container ${r()==="hex"?"active":""}`,Le=`content-panel-container ${r()==="network"?"active":""}`,He=`content-panel-container ${r()==="disassembly"?"active":""}`,De=`content-panel-container ${r()==="memory"?"active":""}`,We=`content-panel-container ${r()==="container"?"active":""}`,Ie=`content-panel-container ${r()==="workflows"?"active":""}`,tt=`content-panel-container ${r()==="yara"?"active":""}`,Me=`content-panel-container ${r()==="platform-config"?"active":""}`;return A!==h.e&&M(u,h.e=A),Ze!==h.t&&M(v,h.t=Ze),Ne!==h.a&&M(f,h.a=Ne),lt!==h.o&&M(y,h.o=lt),ze!==h.i&&M(C,h.i=ze),et!==h.n&&M(x,h.n=et),Ve!==h.s&&M(O,h.s=Ve),Le!==h.h&&M(R,h.h=Le),He!==h.r&&M(H,h.r=He),De!==h.d&&M(w,h.d=De),We!==h.l&&M(W,h.l=We),Ie!==h.u&&M(fe,h.u=Ie),tt!==h.c&&M(G,h.c=tt),Me!==h.w&&M(ue,h.w=Me),h},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),d})(),s(wa,{})]}})}})};gt(["click"]);const Rt=document.getElementById("root");Rt&&pr(()=>s(Ba,{}),Rt);export{Mt as A,ct as S,P as _,ut as a,ee as i,S as l,xr as p};
