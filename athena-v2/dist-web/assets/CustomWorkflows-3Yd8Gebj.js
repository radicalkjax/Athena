var Ne=Object.defineProperty;var We=($,o,g)=>o in $?Ne($,o,{enumerable:!0,configurable:!0,writable:!0,value:g}):$[o]=g;var de=($,o,g)=>We($,typeof o!="symbol"?o+"":o,g);import{f as ue,c as k,o as De,t as f,i as a,a as w,F as C,S as K,b as F,l as V,m as Je,s as E,e as Pe,v as Ee,d as Te}from"./vendor-solid-ZF9XUUOY.js";import{l as je,i as T}from"./vendor-B78zZivC.js";class Re{constructor(){de(this,"progressListeners",new Map);je("job-progress",o=>{const g=o.payload,A=this.progressListeners.get(g.job_id);A&&A(g)})}async startJob(o,g){return await T("start_job",{workflowType:o,input:g})}async getJobStatus(o){return await T("get_job_status",{jobId:o})}async listJobs(o,g){return await T("list_jobs",{status:o,limit:g})}async cancelJob(o){await T("cancel_job",{jobId:o})}async deleteJob(o){await T("delete_job",{jobId:o})}async getActiveJobs(){return await T("get_active_jobs")}onProgress(o,g){return this.progressListeners.set(o,g),()=>{this.progressListeners.delete(o)}}}const Z=new Re;var Le=f("<div class=workflows-list>"),Me=f("<div class=custom-workflows><div class=workflows-header><h2>Custom Workflows</h2><button class=primary-button>â• New Workflow"),Fe=f("<div class=node-config><h3>Node Configuration</h3><p>Selected: </p><pre>"),Ie=f('<div class=workflow-designer><div class=designer-header><input type=text placeholder="Workflow Name"class=workflow-name-input><div class=designer-actions><button class=save-button>ğŸ’¾ Save</button><button class=cancel-button>âŒ Cancel</button></div></div><div class=designer-content><div class=nodes-palette><h3>Analysis Nodes</h3><div class=node-category></div><h3>Conditions</h3><div class=node-category></div><h3>Actions</h3><div class=node-category></div></div><div class=workflow-canvas><svg class=connections-svg>'),Oe=f("<div class=palette-node draggable><span class=node-icon></span><span class=node-name>"),Ue=f('<div class="palette-node condition"draggable><span class=node-icon></span><span class=node-name>'),qe=f('<div class="palette-node action"draggable><span class=node-icon></span><span class=node-name>'),Be=f("<svg><line stroke=#ff6b9d stroke-width=2></svg>",!1,!0,!1),Ge=f("<div><div class=node-header><span></span><button class=delete-node>Ã—</button></div><div class=node-ports><div class=input-ports></div><div class=output-ports>"),He=f('<div class="port input">'),Ye=f('<div class="port output">'),Qe=f("<div class=workflow-execution-status><div class=execution-message></div><div class=execution-progress-bar><div class=execution-progress-fill></div></div><div class=execution-progress-text>%"),Xe=f("<div class=workflow-card><h3></h3><p></p><div class=workflow-stats><span>ğŸ“Š <!> nodes</span><span>ğŸ”— <!> connections</span></div><div class=workflow-actions><button class=edit-button>âœï¸ Edit</button><button class=run-button>â–¶ï¸ Run");const ze=[{type:"static",name:"Static Analysis",icon:"ğŸ”"},{type:"yara",name:"YARA Scanner",icon:"ğŸ¯"},{type:"wasm",name:"WASM Analysis",icon:"âš¡"},{type:"ai",name:"AI Analysis",icon:"ğŸ¤–"},{type:"network",name:"Network Analysis",icon:"ğŸŒ"},{type:"behavioral",name:"Behavioral Analysis",icon:"ğŸ”¬"}],Ke=[{type:"threshold",name:"Score Threshold",icon:"ğŸ“Š"},{type:"pattern",name:"Pattern Match",icon:"ğŸ”"},{type:"time",name:"Time Condition",icon:"â°"}],Ve=[{type:"alert",name:"Send Alert",icon:"ğŸš¨"},{type:"quarantine",name:"Quarantine File",icon:"ğŸ”’"},{type:"report",name:"Generate Report",icon:"ğŸ“„"},{type:"api",name:"API Call",icon:"ğŸ”Œ"}],nt=()=>{const[$,o]=ue([]),[g,A]=k(!1),[pe,ee]=k(null),[m,N]=ue({id:"",name:"",description:"",nodes:[],connections:[],createdAt:new Date,updatedAt:new Date}),[I,te]=k(null),[,ne]=k(!1),[ge,se]=k(null),[oe,D]=k(null),[ie,_]=k(0),[re,v]=k("");let O;De(()=>{fe()});const fe=()=>{const e=localStorage.getItem("athena-workflows");o(e?JSON.parse(e):[{id:"default-malware",name:"Malware Detection",description:"Comprehensive malware analysis workflow",nodes:[{id:"node1",type:"analysis",name:"Static Analysis",config:{type:"static"},position:{x:100,y:100},inputs:[],outputs:["score","threats"]},{id:"node2",type:"condition",name:"High Risk Check",config:{threshold:70},position:{x:300,y:100},inputs:["score"],outputs:["true","false"]},{id:"node3",type:"action",name:"Alert Security",config:{type:"alert",severity:"high"},position:{x:500,y:50},inputs:["trigger"],outputs:[]}],connections:[{id:"conn1",from:"node1",to:"node2",fromPort:"score",toPort:"score"},{id:"conn2",from:"node2",to:"node3",fromPort:"true",toPort:"trigger"}],createdAt:new Date,updatedAt:new Date}])},me=()=>{localStorage.setItem("athena-workflows",JSON.stringify($))},ve=()=>{N({id:crypto.randomUUID(),name:"New Workflow",description:"",nodes:[],connections:[],createdAt:new Date,updatedAt:new Date}),A(!0)},he=()=>{if(m.name&&m.nodes.length>0){const e=$.findIndex(n=>n.id===m.id);e>=0?o(e,m):o([...$,m]),me(),A(!1)}},Q=(e,n)=>{ee(n)},$e=e=>{e.preventDefault();const n=pe();if(n&&O){const s=O.getBoundingClientRect(),h=e.clientX-s.left,x=e.clientY-s.top,u={id:`node-${Date.now()}`,type:"analysis",name:n.name,config:{type:n.type},position:{x:h,y:x},inputs:be(n.type),outputs:ye(n.type)};N("nodes",[...m.nodes,u])}ee(null)},we=e=>{e.preventDefault()},be=e=>({static:[],yara:[],wasm:[],ai:["context"],network:[],behavioral:[],threshold:["value"],pattern:["data"],time:[],alert:["trigger"],quarantine:["file"],report:["data"],api:["payload"]})[e]||[],ye=e=>({static:["score","threats","metadata"],yara:["matches","count"],wasm:["results","modules"],ai:["analysis","confidence"],network:["connections","protocols"],behavioral:["behaviors","anomalies"],threshold:["true","false"],pattern:["match","nomatch"],time:["triggered"],alert:[],quarantine:["status"],report:["url"],api:["response"]})[e]||[],_e=e=>{te(e)},xe=e=>{N("nodes",n=>n.filter(s=>s.id!==e)),N("connections",n=>n.filter(s=>s.from!==e&&s.to!==e)),te(null)},Se=(e,n)=>{ne(!0),se({node:e,port:n})},ke=(e,n)=>{const s=ge();if(s&&s.node!==e){const h={id:`conn-${Date.now()}`,from:s.node,to:e,fromPort:s.port,toPort:n};N("connections",[...m.connections,h])}ne(!1),se(null)},Ce=async e=>{try{if(!e.nodes||e.nodes.length===0){alert("Workflow has no nodes to execute");return}const n=Ae(e),s={workflow_id:e.id,workflow_name:e.name,nodes:e.nodes.map(i=>({id:i.id,type:i.type,name:i.name,config:i.config})),connections:e.connections,metadata:{description:e.description,created_at:e.createdAt}};v("Starting workflow execution..."),_(0);const h=await Z.startJob(n,s);D(h);const x=Z.onProgress(h,i=>{_(i.progress*100),v(i.message)});let u=!1,b=0;const J=120;for(;!u&&b<J;){await new Promise(i=>setTimeout(i,1e3));try{const i=await Z.getJobStatus(h);if(i.status==="Completed")u=!0,_(100),v("Workflow completed successfully!"),i.output&&(console.log("Workflow output:",i.output),alert(`Workflow completed successfully!

Results:
${JSON.stringify(i.output,null,2)}`)),setTimeout(()=>{D(null),_(0),v("")},3e3);else if(i.status==="Failed"){u=!0;const W=i.error||"Unknown error occurred";v(`Workflow failed: ${W}`),alert(`Workflow execution failed:
${W}`),setTimeout(()=>{D(null),_(0),v("")},3e3)}else i.status==="Cancelled"?(u=!0,v("Workflow was cancelled"),setTimeout(()=>{D(null),_(0),v("")},3e3)):i.status==="Running"&&_(i.progress*100)}catch(i){console.error("Error checking job status:",i)}b++}x(),u||(v("Workflow execution timed out"),alert("Workflow execution timed out. Check the job status manually."),setTimeout(()=>{D(null),_(0),v("")},3e3))}catch(n){console.error("Failed to start workflow:",n);const s=n instanceof Error?n.message:"Unknown error";v(`Error: ${s}`),alert(`Failed to execute workflow:
${s}`),setTimeout(()=>{D(null),_(0),v("")},3e3)}},Ae=e=>{const n=e.nodes.map(s=>{var h;return((h=s.config)==null?void 0:h.type)||s.name.toLowerCase()});return n.some(s=>["static","yara","wasm","ai"].includes(s))?"FileAnalysis":n.some(s=>s.includes("batch")||s.includes("scan"))?"BatchScan":n.some(s=>["network","behavioral","pattern"].includes(s))?"ThreatHunting":n.some(s=>s.includes("report")||s==="report")?"ReportGeneration":"FileAnalysis"};return(()=>{var e=Me(),n=e.firstChild,s=n.firstChild,h=s.nextSibling;return h.$$click=ve,a(e,w(K,{get when(){return!g()},get fallback(){return(()=>{var x=Ie(),u=x.firstChild,b=u.firstChild,J=b.nextSibling,i=J.firstChild,W=i.nextSibling,P=u.nextSibling,U=P.firstChild,q=U.firstChild,j=q.nextSibling,X=j.nextSibling,R=X.nextSibling,z=R.nextSibling,B=z.nextSibling,S=U.nextSibling,G=S.firstChild;b.$$input=t=>N("name",t.currentTarget.value),i.$$click=he,W.$$click=()=>A(!1),a(j,w(C,{each:ze,children:t=>(()=>{var r=Oe(),c=r.firstChild,d=c.nextSibling;return r.addEventListener("dragstart",l=>Q(l,t)),a(c,()=>t.icon),a(d,()=>t.name),r})()})),a(R,w(C,{each:Ke,children:t=>(()=>{var r=Ue(),c=r.firstChild,d=c.nextSibling;return r.addEventListener("dragstart",l=>Q(l,t)),a(c,()=>t.icon),a(d,()=>t.name),r})()})),a(B,w(C,{each:Ve,children:t=>(()=>{var r=qe(),c=r.firstChild,d=c.nextSibling;return r.addEventListener("dragstart",l=>Q(l,t)),a(c,()=>t.icon),a(d,()=>t.name),r})()})),S.addEventListener("dragover",we),S.addEventListener("drop",$e);var L=O;return typeof L=="function"?Ee(L,S):O=S,a(G,w(C,{get each(){return m.connections},children:t=>{const r=m.nodes.find(d=>d.id===t.from),c=m.nodes.find(d=>d.id===t.to);return r&&c?(()=>{var d=Be();return F(l=>{var H=r.position.x+100,M=r.position.y+30,Y=c.position.x,p=c.position.y+30;return H!==l.e&&E(d,"x1",l.e=H),M!==l.t&&E(d,"y1",l.t=M),Y!==l.a&&E(d,"x2",l.a=Y),p!==l.o&&E(d,"y2",l.o=p),l},{e:void 0,t:void 0,a:void 0,o:void 0}),d})():null}})),a(S,w(C,{get each(){return m.nodes},children:t=>(()=>{var r=Ge(),c=r.firstChild,d=c.firstChild,l=d.nextSibling,H=c.nextSibling,M=H.firstChild,Y=M.nextSibling;return r.$$click=()=>_e(t),a(d,()=>t.name),l.$$click=()=>xe(t.id),a(M,w(C,{get each(){return t.inputs},children:p=>(()=>{var y=He();return y.$$click=()=>ke(t.id,p),E(y,"title",p),y})()})),a(Y,w(C,{get each(){return t.outputs},children:p=>(()=>{var y=Ye();return y.$$click=()=>Se(t.id,p),E(y,"title",p),y})()})),F(p=>{var ce;var y=`workflow-node ${((ce=I())==null?void 0:ce.id)===t.id?"selected":""}`,ae=`${t.position.x}px`,le=`${t.position.y}px`;return y!==p.e&&Pe(r,p.e=y),ae!==p.t&&V(r,"left",p.t=ae),le!==p.a&&V(r,"top",p.a=le),p},{e:void 0,t:void 0,a:void 0}),r})()}),null),a(P,w(K,{get when(){return I()},get children(){var t=Fe(),r=t.firstChild,c=r.nextSibling;c.firstChild;var d=c.nextSibling;return a(c,()=>{var l;return(l=I())==null?void 0:l.name},null),a(d,()=>{var l;return JSON.stringify((l=I())==null?void 0:l.config,null,2)}),t}}),null),F(()=>b.value=m.name),x})()},get children(){var x=Le();return a(x,w(C,{each:$,children:u=>(()=>{var b=Xe(),J=b.firstChild,i=J.nextSibling,W=i.nextSibling,P=W.firstChild,U=P.firstChild,q=U.nextSibling;q.nextSibling;var j=P.nextSibling,X=j.firstChild,R=X.nextSibling;R.nextSibling;var z=W.nextSibling,B=z.firstChild,S=B.nextSibling;return a(J,()=>u.name),a(i,()=>u.description),a(P,()=>u.nodes.length,q),a(j,()=>u.connections.length,R),B.$$click=()=>{N(u),A(!0)},S.$$click=()=>Ce(u),a(b,w(K,{get when(){return Je(()=>oe()!==null)()&&re()},get children(){var G=Qe(),L=G.firstChild,t=L.nextSibling,r=t.firstChild,c=t.nextSibling,d=c.firstChild;return a(L,re),a(c,()=>Math.round(ie()),d),F(l=>V(r,"width",`${ie()}%`)),G}}),null),F(()=>S.disabled=oe()!==null),b})()})),x}}),null),e})()};Te(["click","input"]);export{nt as default};
