const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BatchExport-BtU06rd0.js","assets/vendor-solid-B-ykKXyV.js","assets/vendor-BrNNPIVf.js","assets/index-UCtE3PH6.js","assets/index-Dta1mKkm.css","assets/BatchExport-CLchT5JE.css"])))=>i.map(i=>d[i]);
import{a as X,i as Q,_ as ze}from"./index-UCtE3PH6.js";import{h as pe,c as w,o as Me,t as v,i as c,a as g,F as P,b as f,S as k,d as Be,p as Ge,g as qe}from"./vendor-solid-B-ykKXyV.js";import"./vendor-BrNNPIVf.js";var He=v("<p class=no-files>No analyzed files available. Complete file analysis first."),Je=v('<div class=campaign-inputs><input type=text placeholder="Campaign Name (e.g., APT28 Operation XYZ)"class=campaign-name-input><div class=samples-selector><label>Select Related Samples:'),Ke=v("<select class=file-selector><option value>Choose a file..."),Xe=v("<div class=sections-list>"),Ve=v("<div class=generator-section><div class=section-header><h3>3. Customize Sections</h3><button class=customize-button>"),Ye=v("<div class=stix-options><h4>STIX Export Options</h4><label class=stix-checkbox><input type=checkbox><span>Include Indicators</span></label><label class=stix-checkbox><input type=checkbox><span>Include Relationships</span></label><label class=stix-checkbox><input type=checkbox><span>Include Attack Patterns</span></label><label class=stix-checkbox><input type=checkbox><span>Include Threat Actors"),Ze=v("<div class=reports-container><div class=reports-header><h2>Report Generation</h2><div class=report-stats><span>ğŸ“„ <!> reports generated</span><button class=batch-export-button>ğŸ“¦ Batch Export</button></div></div><div class=report-generator><div class=generator-section><h3>1. Select File</h3></div><div class=generator-section><h3>2. Choose Template</h3><div class=template-grid></div></div><div class=generator-section><h3>4. Export Format</h3><div class=format-options><label class=format-option><input type=radio name=format value=pdf><span>ğŸ“‘ PDF</span></label><label class=format-option><input type=radio name=format value=html><span>ğŸŒ HTML</span></label><label class=format-option><input type=radio name=format value=json><span>ğŸ“Š JSON</span></label><label class=format-option><input type=radio name=format value=stix><span>ğŸ”’ STIX 2.1</span></label></div></div><button class=generate-button></button></div><div class=generated-reports><h3>Generated Reports</h3><div class=reports-list>"),Qe=v("<label class=sample-checkbox><input type=checkbox><span> (<!>)"),We=v("<option>"),et=v("<div><h4></h4><p></p><span class=section-count> sections"),tt=v("<div class=section-item><input type=checkbox><span class=section-title></span><input type=number min=1 max=10 class=order-input>"),st=v("<button class=download-button>â¬‡ï¸ Download"),nt=v("<span class=generating>Generating..."),at=v("<span class=error>Failed"),it=v("<div class=report-item><div class=report-info><h4></h4><div class=report-meta><span></span><span>â€¢</span><span></span><span>â€¢</span><span></span></div></div><div class=report-status>");const rt=Ge(()=>ze(()=>import("./BatchExport-BtU06rd0.js"),__vite__mapDeps([0,1,2,3,4,5]))),lt=[{id:"executive",name:"Executive Summary",description:"High-level overview for management",sections:[{id:"overview",title:"Overview",enabled:!0,order:1},{id:"risk-assessment",title:"Risk Assessment",enabled:!0,order:2},{id:"recommendations",title:"Recommendations",enabled:!0,order:3},{id:"mitre-mapping",title:"MITRE ATT&CK",enabled:!0,order:4}]},{id:"technical",name:"Technical Deep Dive",description:"Detailed technical analysis",sections:[{id:"static-analysis",title:"Static Analysis",enabled:!0,order:1},{id:"dynamic-analysis",title:"Dynamic Analysis",enabled:!0,order:2},{id:"network-analysis",title:"Network Analysis",enabled:!0,order:3},{id:"ai-insights",title:"AI Insights",enabled:!0,order:4},{id:"ioc-extraction",title:"IoC Extraction",enabled:!0,order:5},{id:"code-analysis",title:"Code Analysis",enabled:!0,order:6}]},{id:"incident",name:"Incident Response",description:"Actionable incident response report",sections:[{id:"timeline",title:"Attack Timeline",enabled:!0,order:1},{id:"indicators",title:"Indicators of Compromise",enabled:!0,order:2},{id:"affected-systems",title:"Affected Systems",enabled:!0,order:3},{id:"containment",title:"Containment Steps",enabled:!0,order:4},{id:"remediation",title:"Remediation",enabled:!0,order:5}]},{id:"campaign",name:"Campaign Report",description:"Comprehensive threat campaign analysis",sections:[{id:"campaign-overview",title:"Campaign Overview",enabled:!0,order:1},{id:"threat-actor",title:"Threat Actor Profile",enabled:!0,order:2},{id:"campaign-iocs",title:"Campaign IOCs",enabled:!0,order:3},{id:"campaign-ttps",title:"Tactics & Techniques",enabled:!0,order:4},{id:"timeline",title:"Attack Timeline",enabled:!0,order:5},{id:"related-samples",title:"Related Samples",enabled:!0,order:6}]}],ut=()=>{const[W,me]=pe(lt),[C,he]=w(null),[V,ge]=w(null),[A,D]=pe([]),[ee,z]=w(!1),[$,M]=w("pdf"),[Y,fe]=w(!1),[ve,te]=w(!1),[N,be]=w(""),[O,se]=w([]),[ne,ye]=w(!0),[ae,_e]=w(!0),[$e,xe]=w(!0),[Se,we]=w(!1);Me(()=>{Ce()});const Ce=()=>{const e=localStorage.getItem("athena-reports");if(e)try{const n=JSON.parse(e);if(!Array.isArray(n)){console.warn("Invalid reports format: expected array"),localStorage.removeItem("athena-reports");return}const t=n.filter(a=>{if(typeof a!="object"||a===null)return!1;const i=a;return typeof i.id=="string"&&typeof i.fileId=="string"&&typeof i.fileName=="string"&&typeof i.template=="string"&&typeof i.format=="string"}).map(a=>({...a,createdAt:a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt)}));D(t)}catch(n){console.warn("Failed to parse saved reports:",n),localStorage.removeItem("athena-reports")}},ie=()=>{localStorage.setItem("athena-reports",JSON.stringify(A))},Re=async()=>{const e=C(),n=V(),t=X.state.files.find(s=>s.id===n);if(!e)return;if(e.id==="campaign"){if(!N().trim()){alert("Please enter a campaign name");return}if(O().length===0){alert("Please select at least one sample for the campaign report");return}await ke();return}if(!t)return;z(!0);const a={id:crypto.randomUUID(),fileId:t.id,fileName:t.name,template:e.name,createdAt:new Date,format:$(),status:"generating"};D([...A,a]);try{if($()==="stix"){const s=await Q("export_stix_format",{analysisId:t.hash||t.id,includeIndicators:ne(),includeRelationships:ae()});a.content=JSON.parse(s),a.status="completed"}else{const s=await Ie(t,e);if($()==="json")a.content=s,a.status="completed";else{const l=await Q("generate_report",{content:s,format:$(),fileName:`${t.name}_report_${Date.now()}`});a.url=l.url,a.status="completed"}}}catch(s){console.error("Failed to generate report:",s),a.status="error"}const i=A.findIndex(s=>s.id===a.id);i>=0&&D(i,a),ie(),z(!1)},ke=async()=>{z(!0);const e={id:crypto.randomUUID(),fileId:"campaign",fileName:N(),template:"Campaign Report",createdAt:new Date,format:$(),status:"generating"};D([...A,e]);try{const t=$()==="stix"?"json":$(),a=await Q("generate_campaign_report",{campaignName:N(),samples:O(),format:t}),s=new TextDecoder().decode(new Uint8Array(a));t==="json"?e.content=JSON.parse(s):e.content=s,e.status="completed"}catch(t){console.error("Failed to generate campaign report:",t),e.status="error"}const n=A.findIndex(t=>t.id===e.id);n>=0&&D(n,e),ie(),z(!1)},Ie=async(e,n)=>{const t={metadata:{fileName:e.name,fileHash:e.hash,fileSize:e.size,analysisDate:new Date().toISOString(),template:n.name},sections:{}},a=n.sections.filter(i=>i.enabled).sort((i,s)=>i.order-s.order);for(const i of a)t.sections[i.id]=await Te(e,i.id);return t},Te=async(e,n)=>{var t,a,i,s,l,y,_,R,T,E,G,q,L,H,J,U;switch(n){case"overview":return{title:"Executive Overview",content:`File ${e.name} has been analyzed with a comprehensive security assessment.`,severity:((t=e.results)==null?void 0:t.malwareScore)>70?"critical":((a=e.results)==null?void 0:a.malwareScore)>40?"high":"medium",summary:Ae(e)};case"risk-assessment":return{title:"Risk Assessment",overallRisk:re(e),categories:{malware:((i=e.results)==null?void 0:i.malwareScore)||0,vulnerabilities:45,dataExfiltration:30,persistence:60},factors:Ee(e)};case"recommendations":return{title:"Recommendations",immediate:["Isolate affected systems immediately","Block identified IoCs at perimeter","Initiate incident response procedures"],shortTerm:["Conduct full network scan for similar indicators","Update security signatures and rules","Review access logs for suspicious activity"],longTerm:["Implement enhanced monitoring","Review security architecture","Conduct security awareness training"]};case"mitre-mapping":return{title:"MITRE ATT&CK Mapping",techniques:Le(e),tactics:["Initial Access","Execution","Persistence","Defense Evasion"],heatmap:Oe(e)};case"static-analysis":return{title:"Static Analysis Results",fileInfo:((s=e.analysisResult)==null?void 0:s.basic_analysis)||{},entropy:((l=e.analysisResult)==null?void 0:l.entropy)||0,strings:((y=e.analysisResult)==null?void 0:y.strings)||[],imports:((_=e.analysisResult)==null?void 0:_.imports)||[],sections:((R=e.analysisResult)==null?void 0:R.sections)||[]};case"ai-insights":return{title:"AI Analysis Insights",consensus:((T=e.results)==null?void 0:T.aiAnalysis)||{},providers:Object.entries(((E=e.results)==null?void 0:E.aiAnalysis)||{}).map(([F,j])=>({provider:F,score:j.score,summary:j.summary,confidence:j.score/100})),aggregatedInsights:je(e)};case"ioc-extraction":return{title:"Indicators of Compromise",domains:B(e,"domains"),ips:B(e,"ips"),files:B(e,"files"),registry:B(e,"registry"),hashes:{md5:(q=(G=e.analysisResult)==null?void 0:G.hashes)==null?void 0:q.md5,sha1:(H=(L=e.analysisResult)==null?void 0:L.hashes)==null?void 0:H.sha1,sha256:(U=(J=e.analysisResult)==null?void 0:J.hashes)==null?void 0:U.sha256}};default:return{title:n,content:"Section content not available"}}},Ae=e=>{var t;const n=((t=e.results)==null?void 0:t.malwareScore)||0;return n>70?`Critical threat detected. ${e.name} exhibits multiple malicious behaviors and should be treated as high-risk malware. Immediate action required.`:n>40?`Suspicious file detected. ${e.name} shows concerning behaviors that warrant further investigation and containment.`:"File analyzed with moderate risk indicators. Continue monitoring and apply standard security procedures."},re=e=>{var t,a,i,s,l;const n={malwareScore:((t=e.results)==null?void 0:t.malwareScore)||0,entropy:((a=e.analysisResult)==null?void 0:a.entropy)>7?80:40,suspiciousImports:((s=(i=e.analysisResult)==null?void 0:i.imports)==null?void 0:s.filter(y=>y.suspicious).length)*10||0,aiConsensus:Object.values(((l=e.results)==null?void 0:l.aiAnalysis)||{}).reduce((y,_)=>y+_.score,0)/6};return Math.min(100,Object.values(n).reduce((y,_)=>y+_)/Object.keys(n).length)},Ee=e=>{var t,a,i,s,l;const n=[];return((t=e.analysisResult)==null?void 0:t.entropy)>7&&n.push("High entropy indicates packing/encryption"),((i=(a=e.results)==null?void 0:a.threats)==null?void 0:i.length)>0&&n.push(`${e.results.threats.length} threat signatures detected`),((l=(s=e.analysisResult)==null?void 0:s.anomalies)==null?void 0:l.length)>0&&n.push("Structural anomalies detected"),n},Le=e=>{var t,a,i,s;const n=[];return(a=(t=e.analysisResult)==null?void 0:t.suspicious_strings)!=null&&a.includes("CreateRemoteThread")&&n.push("T1055 - Process Injection"),(s=(i=e.analysisResult)==null?void 0:i.suspicious_strings)!=null&&s.includes("RegSetValueEx")&&n.push("T1547.001 - Registry Run Keys"),n},Oe=e=>{var i;const n=e==null?void 0:e.analysisResult,t={"initial-access":0,execution:0,persistence:0,"privilege-escalation":0,"defense-evasion":0,"credential-access":0,discovery:0,"lateral-movement":0,collection:0,"command-and-control":0,exfiltration:0,impact:0};return n&&((((i=n.imports)==null?void 0:i.filter(s=>s.suspicious))||[]).forEach(s=>{const l=(s.name||"").toLowerCase();(l.includes("createremotethread")||l.includes("virtualalloc"))&&(t.execution=(t.execution||0)+.3),(l.includes("regsetvalue")||l.includes("createservice"))&&(t.persistence=(t.persistence||0)+.3),(l.includes("adjusttoken")||l.includes("impersonate"))&&(t["privilege-escalation"]=(t["privilege-escalation"]||0)+.3),(l.includes("crypt")||l.includes("encode"))&&(t["defense-evasion"]=(t["defense-evasion"]||0)+.3),(l.includes("lsass")||l.includes("credential"))&&(t["credential-access"]=(t["credential-access"]||0)+.3),(l.includes("socket")||l.includes("http"))&&(t["command-and-control"]=(t["command-and-control"]||0)+.3)}),Object.keys(t).forEach(s=>{const l=t[s];t[s]=Math.min(1,l!==void 0?l:0)})),t},B=(e,n)=>{var i;const t=[],a=e==null?void 0:e.analysisResult;return a?(a.strings&&n==="network"&&a.strings.forEach(s=>{(s.match(/https?:\/\//)||s.match(/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/))&&t.push(s)}),Object.values(((i=e.results)==null?void 0:i.aiAnalysis)||{}).forEach(s=>{s.details&&s.details.includes(n)}),t.slice(0,20)):t},je=e=>{var l,y,_,R,T;if(!(e!=null&&e.analysisResult))return{consensusThreatLevel:"Unknown",confidenceScore:0,primaryThreatType:"Not analyzed",suggestedActions:["Upload and analyze a file to get insights"]};const n=e.analysisResult,t=((l=e.results)==null?void 0:l.malwareScore)||re(e);let a="Low";t>70?a="Critical":t>50?a="High":t>30&&(a="Medium");let i="Unknown";((y=n.signatures)==null?void 0:y.length)>0?i=n.signatures[0].name||"Unknown":(_=n.format_info)!=null&&_.is_packed?i="Packed/Obfuscated Binary":n.entropy>7&&(i="Potentially Encrypted/Packed");const s=[];return t>50&&s.push("Consider isolation and quarantine"),(R=n.imports)!=null&&R.some(E=>E.suspicious)&&s.push("Review suspicious API calls"),((T=n.anomalies)==null?void 0:T.length)>0&&s.push("Investigate structural anomalies"),s.length===0&&s.push("Continue standard monitoring"),{consensusThreatLevel:a,confidenceScore:Math.min(1,t/100),primaryThreatType:i,suggestedActions:s}},De=e=>{if((e.format==="json"||e.format==="stix")&&e.content){const n=e.format==="stix"?"application/stix+json":"application/json",t=e.format==="stix"?"stix.json":"json",a=new Blob([JSON.stringify(e.content,null,2)],{type:n}),i=URL.createObjectURL(a),s=document.createElement("a");s.href=i,s.download=`${e.fileName}_report_${e.id}.${t}`,s.click(),URL.revokeObjectURL(i)}else if(typeof e.content=="string"){const n=e.format==="html"?"text/html":"text/markdown",t=e.format==="html"?"html":"md",a=new Blob([e.content],{type:n}),i=URL.createObjectURL(a),s=document.createElement("a");s.href=i,s.download=`${e.fileName}_report_${e.id}.${t}`,s.click(),URL.revokeObjectURL(i)}else if(e.url)try{const n=new URL(e.url);n.protocol==="http:"||n.protocol==="https:"||n.protocol==="blob:"?window.open(e.url,"_blank","noopener,noreferrer"):console.error("Invalid URL protocol:",n.protocol)}catch(n){console.error("Invalid URL:",e.url,n)}},le=(e,n)=>{const t=C();if(!t)return;const a=W.findIndex(s=>s.id===t.id),i=t.sections.findIndex(s=>s.id===e);a>=0&&i>=0&&me(a,"sections",i,n)};return(()=>{var e=Ze(),n=e.firstChild,t=n.firstChild,a=t.nextSibling,i=a.firstChild,s=i.firstChild,l=s.nextSibling;l.nextSibling;var y=i.nextSibling,_=n.nextSibling,R=_.firstChild,T=R.firstChild;T.firstChild;var E=R.nextSibling,G=E.firstChild,q=G.nextSibling,L=E.nextSibling,H=L.firstChild,J=H.nextSibling,U=J.firstChild,F=U.firstChild,j=U.nextSibling,ce=j.firstChild,oe=j.nextSibling,de=oe.firstChild,Ne=oe.nextSibling,ue=Ne.firstChild,Z=L.nextSibling,Ue=_.nextSibling,Fe=Ue.firstChild,Pe=Fe.nextSibling;return c(i,()=>A.length,l),y.$$click=()=>te(!0),c(T,()=>{var r;return((r=C())==null?void 0:r.id)==="campaign"?"s":""},null),c(R,g(k,{get when(){var r;return((r=C())==null?void 0:r.id)==="campaign"},get children(){var r=Je(),d=r.firstChild,u=d.nextSibling;return u.firstChild,d.$$input=o=>be(o.currentTarget.value),c(u,g(P,{get each(){return X.state.files.filter(o=>o.status==="completed")},children:o=>(()=>{var h=Qe(),m=h.firstChild,b=m.nextSibling,x=b.firstChild,I=x.nextSibling;return I.nextSibling,m.addEventListener("change",S=>{const p=o.hash||o.id;S.currentTarget.checked?se([...O(),p]):se(O().filter(K=>K!==p))}),c(b,()=>o.name,x),c(b,()=>{var S;return((S=o.hash)==null?void 0:S.substring(0,8))||o.id.substring(0,8)},I),f(()=>m.checked=O().includes(o.hash||o.id)),h})()}),null),c(u,g(k,{get when(){return X.state.files.filter(o=>o.status==="completed").length===0},get children(){return He()}}),null),f(()=>d.value=N()),r}}),null),c(R,g(k,{get when(){var r;return((r=C())==null?void 0:r.id)!=="campaign"},get children(){var r=Ke();return r.firstChild,r.addEventListener("change",d=>ge(d.currentTarget.value)),c(r,g(P,{get each(){return X.state.files.filter(d=>d.status==="completed")},children:d=>(()=>{var u=We();return c(u,()=>d.name),f(()=>u.value=d.id),u})()}),null),f(()=>r.value=V()||""),r}}),null),c(q,g(P,{each:W,children:r=>(()=>{var d=et(),u=d.firstChild,o=u.nextSibling,h=o.nextSibling,m=h.firstChild;return d.$$click=()=>he(r),c(u,()=>r.name),c(o,()=>r.description),c(h,()=>r.sections.length,m),f(()=>{var b;return Be(d,`template-card ${((b=C())==null?void 0:b.id)===r.id?"selected":""}`)}),d})()})),c(_,g(k,{get when(){return C()},get children(){var r=Ve(),d=r.firstChild,u=d.firstChild,o=u.nextSibling;return o.$$click=()=>fe(!Y()),c(o,()=>Y()?"âœ“ Done":"âš™ï¸ Customize"),c(r,g(k,{get when(){return Y()},get children(){var h=Xe();return c(h,g(P,{get each(){return C().sections},children:m=>(()=>{var b=tt(),x=b.firstChild,I=x.nextSibling,S=I.nextSibling;return x.addEventListener("change",p=>le(m.id,{enabled:p.currentTarget.checked})),c(I,()=>m.title),S.addEventListener("change",p=>le(m.id,{order:parseInt(p.currentTarget.value)})),f(()=>x.checked=m.enabled),f(()=>S.value=m.order),b})()})),h}}),null),r}}),L),F.addEventListener("change",()=>M("pdf")),ce.addEventListener("change",()=>M("html")),de.addEventListener("change",()=>M("json")),ue.addEventListener("change",()=>M("stix")),c(L,g(k,{get when(){return $()==="stix"},get children(){var r=Ye(),d=r.firstChild,u=d.nextSibling,o=u.firstChild,h=u.nextSibling,m=h.firstChild,b=h.nextSibling,x=b.firstChild,I=b.nextSibling,S=I.firstChild;return o.addEventListener("change",p=>ye(p.currentTarget.checked)),m.addEventListener("change",p=>_e(p.currentTarget.checked)),x.addEventListener("change",p=>xe(p.currentTarget.checked)),S.addEventListener("change",p=>we(p.currentTarget.checked)),f(()=>o.checked=ne()),f(()=>m.checked=ae()),f(()=>x.checked=$e()),f(()=>S.checked=Se()),r}}),null),Z.$$click=Re,c(Z,()=>ee()?"â³ Generating...":"ğŸš€ Generate Report"),c(Pe,g(P,{get each(){return A.slice().reverse()},children:r=>(()=>{var d=it(),u=d.firstChild,o=u.firstChild,h=o.nextSibling,m=h.firstChild,b=m.nextSibling,x=b.nextSibling,I=x.nextSibling,S=I.nextSibling,p=u.nextSibling;return c(o,()=>r.fileName),c(m,()=>r.template),c(x,()=>r.format.toUpperCase()),c(S,()=>new Date(r.createdAt).toLocaleString()),c(p,g(k,{get when(){return r.status==="completed"},get children(){var K=st();return K.$$click=()=>De(r),K}}),null),c(p,g(k,{get when(){return r.status==="generating"},get children(){return nt()}}),null),c(p,g(k,{get when(){return r.status==="error"},get children(){return at()}}),null),d})()})),c(e,g(k,{get when(){return ve()},get children(){return g(rt,{onClose:()=>te(!1)})}}),null),f(r=>{var o,h;var d=((o=C())==null?void 0:o.id)==="campaign",u=!C()||ee()||(((h=C())==null?void 0:h.id)==="campaign"?!N().trim()||O().length===0:!V());return d!==r.e&&(F.disabled=r.e=d),u!==r.t&&(Z.disabled=r.t=u),r},{e:void 0,t:void 0}),f(()=>F.checked=$()==="pdf"),f(()=>ce.checked=$()==="html"),f(()=>de.checked=$()==="json"),f(()=>ue.checked=$()==="stix"),e})()};qe(["click","input"]);export{ut as default};
