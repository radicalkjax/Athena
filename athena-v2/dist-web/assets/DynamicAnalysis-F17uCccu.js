import{c as b,o as ye,h as xe,u as Se,a as r,t as i,i as e,S as m,b as T,s as me,F as D,e as M,l as fe,m as K,v as we,d as ve,q as ke}from"./vendor-solid-ZF9XUUOY.js";import{A as pe,i as Q,a as Ce}from"./index-C4Q2lgHl.js";import{H as Ae}from"./HexEditor-DLDeQ3M1.js";var Te=i("<div class=video-loading><div class=loading-spinner></div><span>Loading video recording..."),Re=i("<div class=video-error><span class=error-icon>!</span><span>"),Ee=i("<div class=play-overlay><span class=play-icon>&#9658;"),Le=i("<div class=video-wrapper><video class=video-element>"),Pe=i("<div class=event-timeline><div class=timeline-progress>"),Me=i("<div class=video-controls><div class=controls-left><button class=control-btn></button><button class=control-btn>⏮</button><span class=time-display> / </span></div><div class=controls-center><div class=rate-selector></div></div><div class=controls-right><input type=range min=0 max=1 step=0.1 class=volume-slider>"),De=i("<span class=mitre-badge>"),Ne=i("<div class=selected-event-info><span></span><span class=event-description></span><button class=close-btn>×"),Ve=i("<div class=screenshot-section><h4 class=screenshot-title>Screenshots (<!>)</h4><div class=screenshot-strip>"),ze=i("<div class=video-player-container>"),Ue=i('<div class=video-actions><button class="btn btn-secondary btn-sm">'),Fe=i("<div>"),Oe=i("<button>x"),Ie=i("<img class=screenshot-img>"),Be=i("<div class=screenshot-item><span class=screenshot-time>"),He=i("<div class=screenshot-placeholder>Loading...");const je=E=>{const[R,W]=b(0),[X,Y]=b(0),[re,q]=b(!1),[G,J]=b(null),[A,ae]=b(!0),[U,N]=b(null),[B,H]=b(1),[I,P]=b(.5),[Z,ee]=b(!0),[te,ne]=b(new Map),[F,j]=b(null);let C;ye(async()=>{if(!E.videoPath){N("No video path provided"),ae(!1);return}try{const h=await Q("read_file_binary",{path:E.videoPath,offset:0,length:104857600});if(!h||h.length===0){N("Video file is empty or could not be read"),ae(!1);return}const g=new Blob([new Uint8Array(h)],{type:"video/mp4"}),l=URL.createObjectURL(g);J(l),await ue()}catch(h){console.error("Failed to load video:",h),N(h instanceof Error?h.message:"Failed to load video")}finally{ae(!1)}}),xe(()=>{const h=G();h&&URL.revokeObjectURL(h),te().forEach(g=>URL.revokeObjectURL(g))});const ue=async()=>{const h=new Map;for(const g of E.screenshots)if(g.dataUrl)h.set(g.path,g.dataUrl);else try{const l=await Q("read_file_binary",{path:g.path,offset:0,length:1048576});if(l&&l.length>0){const a=new Blob([new Uint8Array(l)],{type:"image/png"});h.set(g.path,URL.createObjectURL(a))}}catch(l){console.warn("Failed to load screenshot:",g.path,l)}ne(h)},z=Se(()=>{const h=X();return h===0?[]:E.events.filter(g=>g.timestamp!==void 0).map(g=>({...g,position:g.timestamp/1e3/h*100}))}),V=h=>{const g=Math.floor(h/60),l=Math.floor(h%60);return`${g.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},se=()=>{C&&(re()?C.pause():C.play())},O=h=>{C&&(C.currentTime=h)},ce=h=>{var g;if(h.timestamp!==void 0&&C){const l=h.timestamp/1e3;C.currentTime=l,j(h),(g=E.onSeekToEvent)==null||g.call(E,h)}},de=h=>{if(!C)return;const l=h.currentTarget.getBoundingClientRect(),n=(h.clientX-l.left)/l.width;O(n*X())},le=h=>{C&&(H(h),C.playbackRate=h)},ge=h=>{switch(h){case"danger":return"marker-critical";case"warning":return"marker-warning";case"success":return"marker-success";default:return"marker-info"}};return r(pe,{title:"Execution Recording",icon:"Recording",className:"video-player-panel",get actions(){return(()=>{var h=Ue(),g=h.firstChild;return g.$$click=()=>ee(!Z()),e(g,()=>Z()?"Hide Timeline":"Show Timeline"),h})()},get children(){var h=ze();return e(h,r(m,{get when(){return A()},get children(){return Te()}}),null),e(h,r(m,{get when(){return U()},get children(){var g=Re(),l=g.firstChild,a=l.nextSibling;return e(a,U),g}}),null),e(h,r(m,{get when(){return K(()=>!!(G()&&!A()))()&&!U()},get children(){return[(()=>{var g=Le(),l=g.firstChild;l.$$click=se,l.addEventListener("ended",()=>q(!1)),l.addEventListener("pause",()=>q(!1)),l.addEventListener("play",()=>q(!0)),l.addEventListener("loadedmetadata",n=>Y(n.currentTarget.duration)),l.addEventListener("timeupdate",n=>W(n.currentTarget.currentTime));var a=C;return typeof a=="function"?we(a,l):C=l,e(g,r(m,{get when(){return!re()},get children(){var n=Ee();return n.$$click=se,n}}),null),T(()=>me(l,"src",G())),g})(),r(m,{get when(){return Z()},get children(){var g=Pe(),l=g.firstChild;return g.$$click=de,e(g,r(D,{get each(){return z()},children:a=>(()=>{var n=Fe();return n.$$click=s=>{s.stopPropagation(),ce(a)},T(s=>{var S=`timeline-marker ${ge(a.type)} ${F()===a?"selected":""}`,w=`${a.position}%`,_=`${a.symbol} ${a.description}${a.mitre_attack_id?` [${a.mitre_attack_id}]`:""}`;return S!==s.e&&M(n,s.e=S),w!==s.t&&fe(n,"left",s.t=w),_!==s.a&&me(n,"title",s.a=_),s},{e:void 0,t:void 0,a:void 0}),n})()}),null),T(a=>fe(l,"width",`${R()/X()*100}%`)),g}}),(()=>{var g=Me(),l=g.firstChild,a=l.firstChild,n=a.nextSibling,s=n.nextSibling,S=s.firstChild,w=l.nextSibling,_=w.firstChild,f=w.nextSibling,p=f.firstChild;return a.$$click=se,e(a,()=>re()?"⏸":"▶"),n.$$click=()=>O(0),e(s,()=>V(R()),S),e(s,()=>V(X()),null),e(_,r(D,{each:[.5,1,1.5,2],children:u=>(()=>{var v=Oe(),x=v.firstChild;return v.$$click=()=>le(u),e(v,u,x),T(()=>M(v,`rate-btn ${B()===u?"active":""}`)),v})()})),p.$$input=u=>{const v=parseFloat(u.currentTarget.value);P(v),C&&(C.volume=v)},T(()=>p.value=I()),g})(),r(m,{get when(){return F()},get children(){var g=Ne(),l=g.firstChild,a=l.nextSibling,n=a.nextSibling;return e(l,()=>F().symbol),e(a,()=>F().description),e(g,r(m,{get when(){return F().mitre_attack_id},get children(){var s=De();return e(s,()=>F().mitre_attack_id),s}}),n),n.$$click=()=>j(null),T(()=>M(l,`event-badge ${F().type}`)),g}})]}}),null),e(h,r(m,{get when(){return E.screenshots.length>0},get children(){var g=Ve(),l=g.firstChild,a=l.firstChild,n=a.nextSibling;n.nextSibling;var s=l.nextSibling;return e(l,()=>E.screenshots.length,n),e(s,r(D,{get each(){return E.screenshots},children:S=>(()=>{var w=Be(),_=w.firstChild;return w.$$click=()=>O(S.timestamp/1e3),e(w,r(m,{get when(){return te().get(S.path)},get fallback(){return He()},get children(){var f=Ie();return T(p=>{var u=te().get(S.path),v=`Screenshot at ${V(S.timestamp/1e3)}`;return u!==p.e&&me(f,"src",p.e=u),v!==p.t&&me(f,"alt",p.t=v),p},{e:void 0,t:void 0}),f}}),_),e(_,()=>V(S.timestamp/1e3)),w})()})),g}}),null),h}})};ve(["click","input"]);var Ke=i("<div class=no-dumps>No memory dumps captured yet. Run sandbox analysis to capture memory."),Qe=i("<button>Volatility"),We=i("<div class=view-tabs><button>Hex View</button><button>Strings (<!>)</button><button>Regions (<!>)"),qe=i("<div class=memory-error><span>Error: </span><button>Dismiss"),Ge=i("<div class=memory-loading><div class=loading-spinner></div><span>Loading memory data..."),Xe=i("<div class=no-selection><div class=no-selection-icon>*</div><span>Select a memory dump to view"),Ye=i("<div class=hex-view-container><div class=hex-navigation><button class=nav-btn>Previous</button><span class=offset-display>Offset: 0x<!> - 0x<!> (<!> total)</span><button class=nav-btn>Next</button></div><div class=hex-editor-wrapper>"),Je=i("<div class=no-strings>No strings found matching criteria"),Ze=i("<div class=strings-more>Showing 500 of <!> strings. Use filter to narrow results."),et=i('<div class=strings-view-container><div class=strings-toolbar><input type=text class=strings-filter placeholder="Filter strings..."><label class=suspicious-toggle><input type=checkbox>Suspicious only</label></div><div class=strings-list>'),tt=i("<div class=no-regions>Memory region information not available for this dump format."),nt=i("<div class=regions-view-container><div class=regions-list><div class=regions-header><span>Address</span><span>Size</span><span>Protection</span><span>Mapped File"),st=i('<div class=volatility-section><h4 class="section-title danger">Malfind - Injected Code (<!>)</h4><div class=malfind-list>'),lt=i("<div class=volatility-section><h4 class=section-title>Process List (<!>)</h4><div class=process-list>"),it=i("<div class=volatility-section><h4 class=section-title>Network Connections (<!>)</h4><div class=network-list>"),rt=i('<div class=volatility-section><h4 class="section-title warning">API Hooks (<!>)</h4><div class=hooks-list>'),at=i("<div class=no-volatility>No suspicious findings from Volatility analysis."),ot=i("<div class=volatility-view-container>"),ct=i("<div class=memory-viewer-container><div class=dump-selector><h4 class=section-title>Memory Dumps (<!>)</h4><div class=dump-list></div></div><div class=memory-content>"),dt=i('<button class="btn btn-primary btn-sm">'),ut=i("<div class=memory-actions>"),gt=i("<div><div class=dump-main><span class=dump-pid>PID </span><span class=dump-name></span></div><div class=dump-meta><span></span><span class=dump-size></span><span class=dump-time>"),ht=i("<span class=suspicious-badge>!"),mt=i("<div><span class=string-offset>0x</span><span class=string-encoding></span><span class=string-value>"),pt=i("<div><span class=region-address></span><span class=region-size></span><span></span><span class=region-file>"),$t=i("<span class=shellcode-badge>Shellcode"),_t=i("<div class=malfind-disasm>"),vt=i("<div><div class=malfind-header><span class=malfind-pid>PID </span><span class=malfind-name></span><span class=malfind-address></span><span class=malfind-size></span></div><div class=malfind-protection>"),ft=i("<div class=disasm-line>"),bt=i("<div class=process-item><span class=proc-pid>PID </span><span class=proc-ppid>PPID </span><span class=proc-name></span><span class=proc-path>"),yt=i("<div class=network-item><span class=net-protocol></span><span class=net-local></span><span class=net-arrow>-&gt;</span><span class=net-remote></span><span class=net-state></span><span class=net-pid>PID "),St=i("<div class=hook-item><span class=hook-function></span><span class=hook-module></span><span class=hook-address> -&gt; ");const xt=E=>{const[R,W]=b(null),[X,Y]=b(null),[re,q]=b([]),[G,J]=b([]),[A,ae]=b(null),[U,N]=b("hex"),[B,H]=b(!1),[I,P]=b(null),[Z,ee]=b(""),[te,ne]=b(!1),[F,j]=b(!1),[C,ue]=b(0),[z]=b(65536),V=l=>{if(l===0)return"0 B";const a=1024,n=["B","KB","MB","GB"],s=Math.floor(Math.log(l)/Math.log(a));return parseFloat((l/Math.pow(a,s)).toFixed(2))+" "+n[s]},se=l=>new Date(l).toLocaleTimeString(),O=l=>"0x"+l.toString(16).padStart(16,"0").toUpperCase();ke(async()=>{const l=R();if(!l){Y(null),q([]),J([]);return}H(!0),P(null);try{const a=await Q("read_file_binary",{path:l.dump_path,offset:C(),length:z()});a&&a.length>0&&Y(new Uint8Array(a));try{const n=await Q("extract_strings_from_dump",{path:l.dump_path,minLength:4});q(n||[])}catch{if(a){const n=ce(new Uint8Array(a));q(n)}}try{const n=await Q("get_memory_regions",{path:l.dump_path});J(n||[])}catch{J([])}}catch(a){console.error("Failed to load memory dump:",a),P(a instanceof Error?a.message:"Failed to load memory dump")}finally{H(!1)}});const ce=l=>{const a=[];let n="",s=0;for(let S=0;S<l.length;S++){const w=l[S];if(w>=32&&w<=126)n.length===0&&(s=S),n+=String.fromCharCode(w);else{if(n.length>=4){const _=de(n);a.push({offset:s,value:n,encoding:"ascii",suspicious:_})}n=""}}return n.length>=4&&a.push({offset:s,value:n,encoding:"ascii",suspicious:de(n)}),a.slice(0,1e3)},de=l=>[/http[s]?:\/\//i,/\.exe$/i,/\.dll$/i,/cmd\.exe/i,/powershell/i,/base64/i,/password/i,/HKEY_/i,/CreateProcess/i,/VirtualAlloc/i,/WriteProcessMemory/i,/LoadLibrary/i,/GetProcAddress/i,/NtCreateThread/i,/shell32/i,/kernel32/i,/ntdll/i,/regsvr32/i,/mshta/i,/wscript/i,/cscript/i].some(n=>n.test(l)),le=Se(()=>{let l=re();if(te()&&(l=l.filter(a=>a.suspicious)),Z()){const a=Z().toLowerCase();l=l.filter(n=>n.value.toLowerCase().includes(a))}return l}),ge=async()=>{const l=R();if(l){j(!0),P(null);try{E.onAnalyzeWithVolatility&&E.onAnalyzeWithVolatility(l.dump_path);const a=await Q("analyze_memory_with_volatility",{dump_path:l.dump_path,plugins:["pslist","malfind","netscan"]});ae(a),N("volatility")}catch(a){console.error("Volatility analysis failed:",a),P(a instanceof Error?a.message:"Volatility analysis failed")}finally{j(!1)}}},h=async l=>{const a=R();if(!a)return;const n=l==="next"?C()+z():Math.max(0,C()-z());if(!(n>=a.size_bytes)){ue(n),H(!0);try{const s=await Q("read_file_binary",{path:a.dump_path,offset:n,length:z()});s&&s.length>0&&Y(new Uint8Array(s))}catch(s){P(s instanceof Error?s.message:"Failed to load data")}finally{H(!1)}}},g=async l=>{const a=R();if(!a)return;const n=Math.floor(l/z())*z();ue(n),H(!0);try{const s=await Q("read_file_binary",{path:a.dump_path,offset:n,length:z()});s&&s.length>0&&Y(new Uint8Array(s))}catch(s){P(s instanceof Error?s.message:"Failed to load data")}finally{H(!1)}};return r(pe,{title:"Memory Analysis",icon:"Memory",className:"memory-viewer-panel",get actions(){return(()=>{var l=ut();return e(l,r(m,{get when(){return R()},get children(){var a=dt();return a.$$click=ge,e(a,()=>F()?"Analyzing...":"Analyze with Volatility"),T(()=>a.disabled=F()),a}})),l})()},get children(){var l=ct(),a=l.firstChild,n=a.firstChild,s=n.firstChild,S=s.nextSibling;S.nextSibling;var w=n.nextSibling,_=a.nextSibling;return e(n,()=>E.memoryDumps.length,S),e(w,r(D,{get each(){return E.memoryDumps},children:f=>(()=>{var p=gt(),u=p.firstChild,v=u.firstChild;v.firstChild;var x=v.nextSibling,o=u.nextSibling,t=o.firstChild,d=t.nextSibling,c=d.nextSibling;return p.$$click=()=>W(f),e(v,()=>f.pid,null),e(x,()=>f.process_name),e(t,()=>f.trigger),e(d,()=>V(f.size_bytes)),e(c,()=>se(f.timestamp)),T($=>{var L;var y=`dump-item ${((L=R())==null?void 0:L.dump_path)===f.dump_path?"selected":""}`,k=`dump-trigger ${f.trigger.toLowerCase()}`;return y!==$.e&&M(p,$.e=y),k!==$.t&&M(t,$.t=k),$},{e:void 0,t:void 0}),p})()}),null),e(w,r(m,{get when(){return E.memoryDumps.length===0},get children(){return Ke()}}),null),e(_,r(m,{get when(){return R()},get children(){var f=We(),p=f.firstChild,u=p.nextSibling,v=u.firstChild,x=v.nextSibling;x.nextSibling;var o=u.nextSibling,t=o.firstChild,d=t.nextSibling;return d.nextSibling,p.$$click=()=>N("hex"),u.$$click=()=>N("strings"),e(u,()=>le().length,x),o.$$click=()=>N("regions"),e(o,()=>G().length,d),e(f,r(m,{get when(){return A()},get children(){var c=Qe();return c.$$click=()=>N("volatility"),T(()=>M(c,`tab-btn ${U()==="volatility"?"active":""}`)),c}}),null),T(c=>{var $=`tab-btn ${U()==="hex"?"active":""}`,y=`tab-btn ${U()==="strings"?"active":""}`,k=`tab-btn ${U()==="regions"?"active":""}`;return $!==c.e&&M(p,c.e=$),y!==c.t&&M(u,c.t=y),k!==c.a&&M(o,c.a=k),c},{e:void 0,t:void 0,a:void 0}),f}}),null),e(_,r(m,{get when(){return I()},get children(){var f=qe(),p=f.firstChild;p.firstChild;var u=p.nextSibling;return e(p,I,null),u.$$click=()=>P(null),f}}),null),e(_,r(m,{get when(){return B()},get children(){return Ge()}}),null),e(_,r(m,{get when(){return K(()=>!R())()&&!B()},get children(){return Xe()}}),null),e(_,r(m,{get when(){return K(()=>!!(U()==="hex"&&X()&&R()))()&&!B()},get children(){var f=Ye(),p=f.firstChild,u=p.firstChild,v=u.nextSibling,x=v.firstChild,o=x.nextSibling,t=o.nextSibling,d=t.nextSibling,c=d.nextSibling,$=c.nextSibling;$.nextSibling;var y=v.nextSibling,k=p.nextSibling;return u.$$click=()=>h("prev"),e(v,()=>C().toString(16).toUpperCase(),o),e(v,()=>(C()+z()).toString(16).toUpperCase(),d),e(v,()=>V(R().size_bytes),$),y.$$click=()=>h("next"),e(k,r(Ae,{get data(){return X()},readOnly:!0})),T(L=>{var ie=C()===0,oe=C()+z()>=R().size_bytes;return ie!==L.e&&(u.disabled=L.e=ie),oe!==L.t&&(y.disabled=L.t=oe),L},{e:void 0,t:void 0}),f}}),null),e(_,r(m,{get when(){return K(()=>!!(U()==="strings"&&R()))()&&!B()},get children(){var f=et(),p=f.firstChild,u=p.firstChild,v=u.nextSibling,x=v.firstChild,o=p.nextSibling;return u.$$input=t=>ee(t.currentTarget.value),x.addEventListener("change",t=>ne(t.currentTarget.checked)),e(o,r(D,{get each(){return le().slice(0,500)},children:t=>(()=>{var d=mt(),c=d.firstChild;c.firstChild;var $=c.nextSibling,y=$.nextSibling;return d.$$click=()=>g(t.offset),e(c,()=>t.offset.toString(16).padStart(8,"0"),null),e($,()=>t.encoding),e(y,()=>t.value),e(d,r(m,{get when(){return t.suspicious},get children(){return ht()}}),null),T(()=>M(d,`string-item ${t.suspicious?"suspicious":""}`)),d})()}),null),e(o,r(m,{get when(){return le().length===0},get children(){return Je()}}),null),e(o,r(m,{get when(){return le().length>500},get children(){var t=Ze(),d=t.firstChild,c=d.nextSibling;return c.nextSibling,e(t,()=>le().length,c),t}}),null),T(()=>u.value=Z()),T(()=>x.checked=te()),f}}),null),e(_,r(m,{get when(){return K(()=>!!(U()==="regions"&&R()))()&&!B()},get children(){var f=nt(),p=f.firstChild;return p.firstChild,e(p,r(D,{get each(){return G()},children:u=>(()=>{var v=pt(),x=v.firstChild,o=x.nextSibling,t=o.nextSibling,d=t.nextSibling;return v.$$click=()=>g(u.address),e(x,()=>O(u.address)),e(o,()=>V(u.size)),e(t,()=>u.protection),e(d,()=>u.mapped_file||"-"),T(c=>{var $=`region-item ${u.is_executable?"executable":""}`,y=`region-protection ${u.is_executable?"exec":""} ${u.is_writable?"write":""}`;return $!==c.e&&M(v,c.e=$),y!==c.t&&M(t,c.t=y),c},{e:void 0,t:void 0}),v})()}),null),e(p,r(m,{get when(){return G().length===0},get children(){return tt()}}),null),f}}),null),e(_,r(m,{get when(){return K(()=>!!(U()==="volatility"&&A()))()&&!B()},get children(){var f=ot();return e(f,r(m,{get when(){return A().malfind_results.length>0},get children(){var p=st(),u=p.firstChild,v=u.firstChild,x=v.nextSibling;x.nextSibling;var o=u.nextSibling;return e(u,()=>A().malfind_results.length,x),e(o,r(D,{get each(){return A().malfind_results},children:t=>(()=>{var d=vt(),c=d.firstChild,$=c.firstChild;$.firstChild;var y=$.nextSibling,k=y.nextSibling,L=k.nextSibling,ie=c.nextSibling;return e($,()=>t.pid,null),e(y,()=>t.process_name),e(k,()=>O(t.address)),e(L,()=>V(t.size)),e(c,r(m,{get when(){return t.likely_shellcode},get children(){return $t()}}),null),e(ie,()=>t.protection),e(d,r(m,{get when(){return t.disassembly.length>0},get children(){var oe=_t();return e(oe,r(D,{get each(){return t.disassembly.slice(0,5)},children:$e=>(()=>{var he=ft();return e(he,$e),he})()})),oe}}),null),T(()=>M(d,`malfind-item ${t.likely_shellcode?"shellcode":""}`)),d})()})),p}}),null),e(f,r(m,{get when(){return A().processes.length>0},get children(){var p=lt(),u=p.firstChild,v=u.firstChild,x=v.nextSibling;x.nextSibling;var o=u.nextSibling;return e(u,()=>A().processes.length,x),e(o,r(D,{get each(){return A().processes},children:t=>(()=>{var d=bt(),c=d.firstChild;c.firstChild;var $=c.nextSibling;$.firstChild;var y=$.nextSibling,k=y.nextSibling;return e(c,()=>t.pid,null),e($,()=>t.ppid,null),e(y,()=>t.name),e(k,()=>t.path||""),d})()})),p}}),null),e(f,r(m,{get when(){return A().network_connections.length>0},get children(){var p=it(),u=p.firstChild,v=u.firstChild,x=v.nextSibling;x.nextSibling;var o=u.nextSibling;return e(u,()=>A().network_connections.length,x),e(o,r(D,{get each(){return A().network_connections},children:t=>(()=>{var d=yt(),c=d.firstChild,$=c.nextSibling,y=$.nextSibling,k=y.nextSibling,L=k.nextSibling,ie=L.nextSibling;return ie.firstChild,e(c,()=>t.protocol),e($,()=>t.local_address),e(k,()=>t.remote_address),e(L,()=>t.state),e(ie,()=>t.pid,null),d})()})),p}}),null),e(f,r(m,{get when(){return A().api_hooks.length>0},get children(){var p=rt(),u=p.firstChild,v=u.firstChild,x=v.nextSibling;x.nextSibling;var o=u.nextSibling;return e(u,()=>A().api_hooks.length,x),e(o,r(D,{get each(){return A().api_hooks},children:t=>(()=>{var d=St(),c=d.firstChild,$=c.nextSibling,y=$.nextSibling,k=y.firstChild;return e(c,()=>t.function_name),e($,()=>t.module),e(y,()=>O(t.hook_address),k),e(y,()=>O(t.target_address),null),d})()})),p}}),null),e(f,r(m,{get when(){return K(()=>A().malfind_results.length===0&&A().processes.length===0&&A().network_connections.length===0)()&&A().api_hooks.length===0},get children(){return at()}}),null),f}}),null),l}})};ve(["click","input"]);var wt=i("<span>Docker sandbox ready. Linux sandbox: "),kt=i("<div>"),Ct=i("<div class=error-banner><button class=dismiss-btn>Dismiss"),At=i('<div class="console-line info">[*] Select a file and click "Start Analysis" to begin sandbox execution.'),Tt=i('<div class="console-line info analyzing">[*] Analysis in progress...'),Rt=i("<div class=behavioral-console>"),Et=i("<span class=no-data>No DNS queries captured"),Lt=i("<span class=no-data>No network connections detected"),Pt=i("<div class=code-editor><div class=code-content><strong>DNS Queries:</strong><br><br><strong>Network Connections:</strong><br><br><strong>Summary:</strong><br>Outbound: <br>Inbound: "),Mt=i("<div class=no-attacks>No ATT&CK techniques detected yet. Run analysis to identify threats."),Dt=i("<div>Run analysis to generate recommendations."),Nt=i('<h3 style="color:var(--barbie-pink);margin:20px 0 15px">Syscall Summary'),Vt=i("<div class=syscall-summary>"),zt=i('<h3 style="color:var(--barbie-pink);margin:20px 0 15px">Advanced Analysis'),Ut=i("<button>Video Recording "),Ft=i("<button>Memory Dumps (<!>) "),Ot=i("<div class=no-advanced>No video or memory captures available for this analysis."),It=i("<div class=advanced-analysis-toggles>"),Bt=i('<div class=content-panel><h2 style=color:var(--barbie-pink);margin-bottom:20px>Dynamic Analysis - Docker Sandbox</h2><div class=analysis-grid><div class=analysis-main></div><div class=ensemble-results><h3 style=color:var(--barbie-pink);margin-bottom:15px>MITRE ATT&CK Mapping</h3><div class=mitre-attack-cards></div><h3 style="color:var(--barbie-pink);margin:20px 0 15px">Recommendations</h3><div class=ensemble-consensus><div style=color:var(--text-primary)>'),Ht=i("<span>Docker not available. Please install and start Docker to use dynamic analysis."),jt=i('<div class=action-buttons><button class="btn btn-primary"></button><button class="btn btn-secondary">'),Kt=i("<span class=mitre-tag>"),Qt=i("<div> "),be=i("<br>"),Wt=i("<span class=confidence>%"),qt=i("<div class=attack-card><div class=attack-header><span class=attack-id></span><span class=attack-name></span></div><div class=attack-description>"),Gt=i("<div>* "),Xt=i("<div class=syscall-item><span class=syscall-name></span><span class=syscall-count>");const en=()=>{const[E,R]=b([]),[W,X]=b({dnsQueries:[],connections:[],dataTransfer:{outbound:"N/A",inbound:"N/A"}}),[Y,re]=b([]),[q,G]=b([]),[J,A]=b(!1),[ae,U]=b(!1),[N,B]=b(null),[H,I]=b(null),[P,Z]=b(null),[ee,te]=b(null),[ne,F]=b([]),[j,C]=b([]),[ue,z]=b(null),[V,se]=b(!1),[O,ce]=b(!1);ye(async()=>{try{const n=await Q("get_sandbox_status");B(n)}catch(n){console.error("Failed to get sandbox status:",n),B({docker_available:!1,linux_sandbox_available:!1,windows_sandbox_available:!1,max_concurrent_sandboxes:0,default_timeout_secs:120,default_memory_limit_mb:512})}});const de=n=>{switch(n.toLowerCase()){case"critical":case"high":return"danger";case"medium":return"warning";case"low":return"info";default:return"success"}},le=n=>{switch(n.toLowerCase()){case"filecreated":case"filemodified":return"[FILE]";case"networkconnection":return"[NET]";case"processinjection":case"codeinjection":return"[!!!!]";case"execve":case"processcreated":return"[EXEC]";case"connect":case"socket":return"[SOCK]";default:return"[+]"}},ge=n=>{const s=[];for(const S of n)switch(S.id){case"T1055":s.push("Monitor for process injection using endpoint detection");break;case"T1059":s.push("Restrict command interpreter execution");break;case"T1071":s.push("Block suspicious outbound connections");break;case"T1003":s.push("Protect credential storage and implement MFA");break;case"T1547":s.push("Monitor boot/logon autostart locations");break;case"T1070":s.push("Preserve evidence and logs in centralized SIEM");break;case"T1548":s.push("Review and restrict privilege escalation paths");break}return s.length===0&&s.push("No specific threats detected - continue monitoring"),[...new Set(s)]},h=async()=>{const n=Ce.currentFile;if(!(n!=null&&n.path)){I("No file selected for analysis. Please upload a file first.");return}A(!0),I(null),R([]),re([]),G([]),te(null),F([]),C([]),z(null);try{R([{type:"info",symbol:"[+]",description:`Starting sandbox analysis of ${n.name}...`}]);const s=await Q("execute_sample_in_sandbox",{filePath:n.path,timeoutSecs:120,captureNetwork:!0});Z(s);const S=s.behavioral_events.map(_=>({type:de(_.severity),symbol:le(_.event_type),description:_.description,timestamp:_.timestamp,mitre_attack_id:_.mitre_attack_id}));for(const _ of s.file_operations.slice(0,20))S.push({type:"info",symbol:"[FILE]",description:`${_.operation}: ${_.path}`});for(const _ of s.processes_created.slice(0,10))S.push({type:"warning",symbol:"[PROC]",description:`Process created: ${_.name} (PID: ${_.pid})`});S.push({type:s.exit_code===0?"success":"warning",symbol:"[+]",description:`Analysis complete (exit code: ${s.exit_code}, duration: ${s.execution_time_ms}ms)`}),R(S),re(s.mitre_attacks);const w=s.network_connections||[];X({dnsQueries:w.filter(_=>_.connection_type==="DNS").map(_=>`${_.destination} -> ${_.source}`),connections:w.filter(_=>_.connection_type!=="DNS").map(_=>`${_.protocol} ${_.destination}:${_.port}`),dataTransfer:{outbound:`${w.length} connections`,inbound:"Analyzed"}}),G(ge(s.mitre_attacks)),s.video_recording&&(te(s.video_recording),se(!0)),s.screenshots&&s.screenshots.length>0&&F(s.screenshots),s.memory_dumps&&s.memory_dumps.length>0&&(C(s.memory_dumps),ce(!0))}catch(s){const S=s instanceof Error?s.message:String(s);I(S),R([{type:"danger",symbol:"[!]",description:`Analysis failed: ${S}`}])}finally{A(!1)}},g=async()=>{if(!P()){I("Run dynamic analysis first to capture screenshots.");return}ee()||ne().length>0?se(!V()):I("No video or screenshots available for this analysis.")},l=async n=>{try{const s=await Q("analyze_memory_with_volatility",{dump_path:n,plugins:["pslist","malfind","netscan"]});z(s)}catch(s){console.error("Volatility analysis failed:",s),I(s instanceof Error?s.message:"Volatility analysis failed")}},a=()=>E().map(n=>({type:n.type,symbol:n.symbol,description:n.description,timestamp:n.timestamp,mitre_attack_id:n.mitre_attack_id}));return(()=>{var n=Bt(),s=n.firstChild,S=s.nextSibling,w=S.firstChild,_=w.nextSibling,f=_.firstChild,p=f.nextSibling,u=p.nextSibling,v=u.nextSibling,x=v.firstChild;return e(n,r(m,{get when(){return N()},get children(){var o=kt();return e(o,r(m,{get when(){var t;return(t=N())==null?void 0:t.docker_available},get fallback(){return Ht()},get children(){var t=wt();return t.firstChild,e(t,()=>{var d;return(d=N())!=null&&d.linux_sandbox_available?"Yes":"Building..."},null),t}})),T(()=>{var t;return M(o,`sandbox-status-banner ${(t=N())!=null&&t.docker_available?"available":"unavailable"}`)}),o}}),S),e(n,r(m,{get when(){return H()},get children(){var o=Ct(),t=o.firstChild;return e(o,H,t),t.$$click=()=>I(null),o}}),S),e(w,r(pe,{title:"Behavioral Analysis",icon:"Running dynamic analysis",get actions(){return(()=>{var o=jt(),t=o.firstChild,d=t.nextSibling;return t.$$click=h,e(t,()=>J()?"Analyzing...":"Start Analysis"),d.$$click=g,e(d,()=>ae()?"Loading...":"View Screenshots"),T(c=>{var k;var $=J()||!((k=N())!=null&&k.docker_available),y=ae()||!P();return $!==c.e&&(t.disabled=c.e=$),y!==c.t&&(d.disabled=c.t=y),c},{e:void 0,t:void 0}),o})()},className:"scrollable-panel",get children(){var o=Rt();return e(o,r(m,{get when(){return E().length===0},get children(){return At()}}),null),e(o,r(D,{get each(){return E()},children:t=>(()=>{var d=Qt(),c=d.firstChild;return e(d,()=>t.symbol,c),e(d,()=>t.description,null),e(d,r(m,{get when(){return t.mitre_attack_id},get children(){var $=Kt();return e($,()=>t.mitre_attack_id),$}}),null),T(()=>M(d,`console-line ${t.type}`)),d})()}),null),e(o,r(m,{get when(){return J()},get children(){return Tt()}}),null),o}}),null),e(w,r(pe,{title:"Network Activity",icon:"Network monitoring",className:"scrollable-panel",get children(){var o=Pt(),t=o.firstChild,d=t.firstChild,c=d.nextSibling,$=c.nextSibling,y=$.nextSibling,k=y.nextSibling,L=k.nextSibling,ie=L.nextSibling,oe=ie.nextSibling,$e=oe.nextSibling,he=$e.nextSibling;return he.nextSibling,e(t,r(m,{get when(){return W().dnsQueries.length===0},get children(){return Et()}}),$),e(t,r(D,{get each(){return W().dnsQueries},children:_e=>[_e,be()]}),$),e(t,r(m,{get when(){return W().connections.length===0},get children(){return Lt()}}),L),e(t,r(D,{get each(){return W().connections},children:_e=>[_e,be()]}),L),e(t,()=>W().dataTransfer.outbound,he),e(t,()=>W().dataTransfer.inbound,null),o}}),null),e(w,r(m,{get when(){return K(()=>!!V())()&&(ee()||ne().length>0)},get children(){return r(je,{get videoPath(){var o;return((o=ee())==null?void 0:o.video_path)||""},get sessionId(){var o;return((o=P())==null?void 0:o.session_id)||""},get screenshots(){return ne()},get events(){return a()},onSeekToEvent:o=>console.log("Seek to event:",o)})}}),null),e(w,r(m,{get when(){return K(()=>!!O())()&&j().length>0},get children(){return r(xt,{get memoryDumps(){return j()},onAnalyzeWithVolatility:l})}}),null),e(p,r(m,{get when(){return Y().length===0},get children(){return Mt()}}),null),e(p,r(D,{get each(){return Y()},children:o=>(()=>{var t=qt(),d=t.firstChild,c=d.firstChild,$=c.nextSibling,y=d.nextSibling;return e(c,()=>o.id),e($,()=>o.name),e(d,r(m,{get when(){return o.confidence},get children(){var k=Wt(),L=k.firstChild;return e(k,()=>Math.round((o.confidence||0)*100),L),k}}),null),e(y,()=>o.description),t})()}),null),e(x,r(m,{get when(){return q().length===0},get children(){return Dt()}}),null),e(x,r(D,{get each(){return q()},children:o=>(()=>{var t=Gt();return t.firstChild,e(t,o,null),t})()}),null),e(_,r(m,{get when(){var o;return K(()=>{var t;return!!((t=P())!=null&&t.syscall_summary)})()&&Object.keys(((o=P())==null?void 0:o.syscall_summary)||{}).length>0},get children(){return[Nt(),(()=>{var o=Vt();return e(o,r(D,{get each(){var t;return Object.entries(((t=P())==null?void 0:t.syscall_summary)||{}).slice(0,10)},children:([t,d])=>(()=>{var c=Xt(),$=c.firstChild,y=$.nextSibling;return e($,t),e(y,d),c})()})),o})()]}}),null),e(_,r(m,{get when(){return P()},get children(){return[zt(),(()=>{var o=It();return e(o,r(m,{get when(){return ee()||ne().length>0},get children(){var t=Ut();return t.firstChild,t.$$click=()=>se(!V()),e(t,()=>V()?"(Hide)":"(Show)",null),T(()=>M(t,`toggle-btn ${V()?"active":""}`)),t}}),null),e(o,r(m,{get when(){return j().length>0},get children(){var t=Ft(),d=t.firstChild,c=d.nextSibling;return c.nextSibling,t.$$click=()=>ce(!O()),e(t,()=>j().length,c),e(t,()=>O()?"(Hide)":"(Show)",null),T(()=>M(t,`toggle-btn ${O()?"active":""}`)),t}}),null),e(o,r(m,{get when(){return K(()=>!ee()&&ne().length===0)()&&j().length===0},get children(){return Ot()}}),null),o})()]}}),null),n})()};ve(["click"]);export{en as default};
