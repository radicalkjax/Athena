import { MalwareFile } from '@/types';
import { MalwareSliceCreator } from '../types';

export const createMalwareSlice: MalwareSliceCreator = (set) => ({
  malwareFiles: [],
  selectedMalwareId: null,
  
  addMalwareFile: (file: MalwareFile) => 
    set((state) => ({ 
      malwareFiles: [...state.malwareFiles, file] 
    })),
  
  removeMalwareFile: (id: string) => 
    set((state) => ({
      malwareFiles: state.malwareFiles.filter(file => file.id !== id)
    })),
  
  selectMalwareFile: (id: string | null) => 
    set({ selectedMalwareId: id }),
  
  clearMalwareFiles: () => 
    set({ malwareFiles: [], selectedMalwareId: null }),
});